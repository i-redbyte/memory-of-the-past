<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>New Page 1</title>
<meta name="Microsoft Theme" content="zero 011">
</head>

<body background="zertxtr.gif" bgcolor="#000000" text="#FFFFFF" link="#6699CC" vlink="#669966" alink="#999999">

<!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font>
<h3 align="center"><!--mstheme--><font face="Arial, Arial, Helvetica" color="#CCCCCC"><font color="#00FF00" size="5">&#1042;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1077;
&#1074;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1086;&#1074;&#1099;&#1093;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1086;&#1074;:
&#1063;&#1072;&#1089;&#1090;&#1100; 1</font><!--mstheme--></font></h3>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p><strong>&#1055;&#1088;&#1077;&#1076;&#1080;&#1089;&#1083;&#1086;&#1074;&#1080;&#1077;</strong>
<p>&#1042; &#1101;&#1090;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077; (&#1072;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086; &#1080;
&#1094;&#1080;&#1082;&#1083;&#1077; &#1089;&#1090;&#1072;&#1090;&#1077;&#1081;)
&#1103; &#1087;&#1086;&#1087;&#1099;&#1090;&#1072;&#1102;&#1089;&#1100;
&#1088;&#1072;&#1089;&#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100; &#1086;
&#1090;&#1086;&#1084;, &#1082;&#1072;&#1082;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1091;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1086;&#1074;&#1099;&#1093;
&#1103;&#1079;&#1099;&#1082;&#1086;&#1074; &#1074;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091;,
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1091;&#1102;
&#1085;&#1072;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;.
&#1053;&#1072;&#1074;&#1077;&#1088;&#1085;&#1086;&#1077;, &#1101;&#1090;&#1086;
&#1089;&#1072;&#1084;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; &#1087;&#1091;&#1090;&#1100;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1091;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1086;&#1074; &#1074;
&#1089;&#1074;&#1086;&#1077;&#1081;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1077; &#1080;,
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;,
&#1082;&#1086;&#1084;&#1091;-&#1090;&#1086; &#1101;&#1090;&#1086; &#1080;
&#1087;&#1088;&#1080;&#1075;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; ;).
<p><strong>&#1055;&#1072;&#1088;&#1072; &#1089;&#1083;&#1086;&#1074; &#1086;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1077;</strong>
<p>&nbsp;
<p>&#1071; &#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1079;&#1076;&#1077;&#1089;&#1100;
&#1087;&#1086;&#1076;&#1085;&#1080;&#1084;&#1072;&#1090;&#1100;
&#1073;&#1077;&#1089;&#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1099;&#1081;
&#1074;&#1086;&#1087;&#1088;&#1086;&#1089; &#1086; &#1090;&#1086;&#1084;
&#1082;&#1072;&#1082;&#1086;&#1081;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;
&#1089;&#1072;&#1084;&#1099;&#1081; &#1083;&#1091;&#1095;&#1096;&#1077; &#1080;
&#1090;.&#1087;. - &#1074; &#1082;&#1086;&#1085;&#1094;&#1077;
&#1082;&#1086;&#1085;&#1094;&#1086;&#1074; &#1101;&#1090;&#1086;
&#1076;&#1077;&#1083;&#1086; &#1074;&#1082;&#1091;&#1089;&#1072;.
&#1057;&#1082;&#1072;&#1078;&#1091; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;,
&#1095;&#1090;&#1086; &#1103; &#1073;&#1091;&#1076;&#1091;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
fasm (http://flatassembler.net) &#1080;,
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1087;&#1086;&#1083;&#1072;&#1075;&#1072;&#1102;, &#1095;&#1090;&#1086;
&#1076;&#1083;&#1103; &#1095;&#1080;&#1090;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090;
&#1089;&#1102;&#1088;&#1087;&#1088;&#1080;&#1079;&#1086;&#1084;
&#1091;&#1074;&#1080;&#1076;&#1077;&#1090;&#1100;
<p><code><!--mstheme--></font>
<pre>add eax, dword [ecx]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1074;&#1084;&#1077;&#1089;&#1090;&#1086;
<p><code><!--mstheme--></font>
<pre>add eax, dword ptr [ecx]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1086; &#1074;&#1086;&#1086;&#1073;&#1097;&#1077;-&#1090;&#1086;
&#1101;&#1090;&#1086;, &#1085;&#1072;&#1074;&#1077;&#1088;&#1085;&#1086;&#1077;,
&#1085;&#1077; &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1072; ;)
<p><strong>Colib</strong>
<p>&#1043;&#1086;&#1074;&#1086;&#1088;&#1103; &#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1080;
COM &#1074;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;
&#1085;&#1077;&#1083;&#1100;&#1079;&#1103; &#1085;&#1077;
&#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100; &#1086;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1093; Ernest Murphy, &#1074;
&#1090;&#1086;&#1084; &#1095;&#1080;&#1089;&#1083;&#1077; &#1086;
&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1077; Colib,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1085;&#1072;&#1084; &#1085;&#1072;&#1073;&#1086;&#1088;
&#1091;&#1076;&#1086;&#1073;&#1085;&#1099;&#1093;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; &#1076;&#1083;&#1103;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099; &#1089; COM-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1084;&#1080;.
&#1053;&#1086; &#1091; &#1085;&#1077;&#1077; &#1077;&#1089;&#1090;&#1100;
&#1086;&#1076;&#1080;&#1085; &#1084;&#1080;&#1085;&#1091;&#1089; -
&#1086;&#1085;&#1072;
&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1072;
&#1085;&#1072; MASM. &#1061;&#1086;&#1090;&#1103;
&#1084;&#1080;&#1085;&#1091;&#1089; &#1101;&#1090;&#1086; &#1080;&#1083;&#1080;
&#1087;&#1083;&#1102;&#1089; &#1088;&#1077;&#1096;&#1072;&#1090;&#1100;
&#1085;&#1077; &#1084;&#1085;&#1077; &#1080; &#1077;&#1089;&#1083;&#1080;
&#1074;&#1072;&#1096; &#1083;&#1102;&#1073;&#1080;&#1084;&#1099;&#1081;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088; - MASM32 (&#1089;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084;,
&#1082;&#1089;&#1090;&#1072;&#1090;&#1080;, &#1080;
&#1087;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1074;&#1099;&#1096;&#1077;&#1086;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1072;),
&#1090;&#1086; &#1074;&#1099; &#1074;&#1087;&#1086;&#1083;&#1085;&#1077;
&#1084;&#1086;&#1078;&#1077;&#1090;&#1077;
&#1088;&#1072;&#1076;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;, &#1090;.&#1082;.
&#1095;&#1072;&#1089;&#1090;&#1100; &#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1091;&#1078;&#1077; &#1089;&#1076;&#1077;&#1083;&#1072;&#1085;&#1072;
&#1079;&#1072; &#1074;&#1072;&#1089;. &#1053;&#1086;
&#1080;&#1079;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1087;&#1088;&#1080;&#1083;&#1072;&#1075;&#1072;&#1102;&#1097;&#1080;&#1077;&#1089;&#1103;
&#1082; &#1085;&#1077;&#1081; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099;
&#1085;&#1077; &#1087;&#1086;&#1084;&#1077;&#1096;&#1072;&#1077;&#1090; &#1074;
&#1083;&#1102;&#1073;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;.
&#1045;&#1097;&#1077; &#1089;&#1086;&#1074;&#1077;&#1090;&#1091;&#1102;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1102; &quot;Using COM in Assembly Language&quot;
by Bill Tyler.
<p><strong>&#1054;&#1089;&#1085;&#1086;&#1074;&#1099; Component Object Model</strong>
<p>&#1042; &#1101;&#1090;&#1086;&#1084;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1077; &#1103;
&#1087;&#1086;&#1089;&#1090;&#1072;&#1088;&#1072;&#1102;&#1089;&#1100;
&#1082;&#1088;&#1072;&#1090;&#1082;&#1086;
&#1086;&#1073;&#1098;&#1103;&#1089;&#1085;&#1080;&#1090;&#1100;
&#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1086;&#1089;&#1085;&#1086;&#1074;&#1099;
&#1090;&#1077;&#1093;&#1085;&#1086;&#1083;&#1086;&#1075;&#1080;&#1080; COM,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;
&#1076;&#1083;&#1103;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1103;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1072;&#1083;&#1072;,
&#1080;&#1079;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1086;&#1075;&#1086;
&#1074; &#1076;&#1072;&#1085;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;. &#1050;&#1072;&#1082;
&#1086;&#1073;&#1099;&#1095;&#1085;&#1086;, &#1090;&#1077; &#1082;&#1090;&#1086;
&#1091;&#1078;&#1077; &#1080;&#1084;&#1077;&#1077;&#1090;
&#1085;&#1091;&#1078;&#1085;&#1099;&#1077;
&#1079;&#1085;&#1072;&#1085;&#1080;&#1103; (&#1072;
&#1085;&#1091;&#1078;&#1085;&#1086; &#1085;&#1072;&#1084; &#1085;&#1077;
&#1090;&#1072;&#1082; &#1091;&#1078; &#1080; &#1084;&#1085;&#1086;&#1075;&#1086;)
&#1084;&#1086;&#1075;&#1091;&#1090;
&#1089;&#1087;&#1086;&#1082;&#1086;&#1081;&#1085;&#1086;
&#1087;&#1088;&#1086;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083; &#1080;
&#1087;&#1077;&#1088;&#1077;&#1081;&#1090;&#1080;
&#1089;&#1088;&#1072;&#1079;&#1091; &#1082;&#1086;
&#1074;&#1090;&#1086;&#1088;&#1086;&#1081; &#1095;&#1072;&#1089;&#1090;&#1080;.
&#1040; &#1076;&#1083;&#1103;
&#1086;&#1089;&#1090;&#1072;&#1074;&#1096;&#1080;&#1093;&#1089;&#1103;
&#1087;&#1088;&#1086;&#1076;&#1086;&#1083;&#1078;&#1072;&#1077;&#1084;.
<p><strong><u>&#1042;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1077;</u></strong>
<p>&#1058;&#1077;&#1093;&#1085;&#1086;&#1083;&#1086;&#1075;&#1080;&#1103; COM -
&#1101;&#1090;&#1086; &#1084;&#1086;&#1097;&#1085;&#1099;&#1081;
&#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1084;&#1077;&#1085;&#1090;,
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1088;&#1072;&#1079;&#1073;&#1080;&#1090;&#1100;
&#1084;&#1086;&#1085;&#1086;&#1083;&#1080;&#1090;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;
&#1085;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1089;&#1090;&#1086;&#1103;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1099;.
&#1058;&#1072;&#1082;&#1072;&#1103;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100;
&#1085;&#1077;&#1080;&#1079;&#1073;&#1077;&#1078;&#1085;&#1086;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1072; &#1073;&#1099;&#1083;&#1072;
&#1074;&#1086;&#1079;&#1085;&#1080;&#1082;&#1085;&#1091;&#1090;&#1100;,
&#1091;&#1095;&#1080;&#1090;&#1099;&#1074;&#1072;&#1103;
&#1090;&#1077;&#1084;&#1087;&#1099;
&#1088;&#1072;&#1079;&#1074;&#1080;&#1090;&#1080;&#1103;
&#1080;&#1085;&#1076;&#1091;&#1089;&#1090;&#1088;&#1080;&#1080;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;.
<p>&#1063;&#1090;&#1086; &#1078;&#1077; &#1090;&#1072;&#1082;&#1086;&#1077; COM?
&#1053;&#1077; &#1073;&#1086;&#1083;&#1077;&#1077;, &#1095;&#1077;&#1084;
&#1085;&#1072;&#1073;&#1086;&#1088; &#1087;&#1088;&#1072;&#1074;&#1080;&#1083;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1102;&#1097;&#1080;&#1093;
&#1082;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;
&#1084;&#1086;&#1075;&#1091;&#1090;
&#1074;&#1079;&#1072;&#1080;&#1084;&#1086;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1099;,
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1099;&#1077; &#1074;
&#1086;&#1073;&#1097;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1088;&#1072;&#1079;&#1085;&#1099;&#1084;&#1080;
&#1083;&#1102;&#1076;&#1100;&#1084;&#1080; &#1080; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1085;&#1099;&#1093;
&#1103;&#1079;&#1099;&#1082;&#1072;&#1093;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;,
&#1101;&#1090;&#1086; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;,
&#1087;&#1088;&#1080;&#1079;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1086;&#1073;&#1077;&#1089;&#1087;&#1077;&#1095;&#1080;&#1090;&#1100;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1080;&#1093;
&#1089;&#1086;&#1074;&#1084;&#1077;&#1089;&#1090;&#1085;&#1086;&#1081;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;. &#1048;&#1076;&#1077;&#1103;,
&#1083;&#1077;&#1078;&#1072;&#1097;&#1072;&#1103; &#1074;
&#1086;&#1089;&#1085;&#1086;&#1074;&#1077;,
&#1076;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1072; - &#1082;&#1086;&#1076;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1089;&#1090;&#1072;&#1090;&#1100;
&#1074;&#1089;&#1077;&#1086;&#1073;&#1097;&#1080;&#1084;
&#1076;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077;&#1084;
&#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1074;&#1080;&#1076;&#1077;
&#1089;&#1074;&#1086;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1085;&#1086;&#1075;&#1086;
&#1084;&#1080;&#1085;&#1080;-&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;,
&#1090;&#1072;&#1082;
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;&#1086;&#1075;&#1086;
COM-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;. &#1040;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1073;&#1099;&#1090;&#1100;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;
&#1080;&#1079;&#1074;&#1085;&#1077;
&#1075;&#1088;&#1091;&#1087;&#1087;&#1080;&#1088;&#1091;&#1102;&#1090;&#1089;&#1103;
&#1074; &#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;.
&#1063;&#1077;&#1088;&#1077;&#1079; &#1085;&#1080;&#1093; &#1080;
&#1086;&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1074;&#1079;&#1072;&#1080;&#1084;&#1086;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1077;
&#1089; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1072;&#1084;&#1080;.
&#1048;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1074;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1091;&#1075;&#1086;&#1076;&#1085;&#1086; -
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;
&#1079;&#1076;&#1077;&#1089;&#1100; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1086;&#1076;&#1085;&#1086; -
&#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1103;
COM &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1083;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089; IUnknown,
&#1072; &#1090;&#1072;&#1082;&#1078;&#1077; &#1095;&#1090;&#1086;&#1073;&#1099;
&#1083;&#1102;&#1073;&#1086;&#1081; &#1076;&#1088;&#1091;&#1075;&#1086;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1090;&#1072;&#1082; &#1080;&#1083;&#1080; &#1080;&#1085;&#1072;&#1095;&#1077;
&#1085;&#1072;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1083;&#1089;&#1103;
&#1086;&#1090; &#1085;&#1077;&#1075;&#1086;.
<p><strong><u>&#1048;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
IUnknown</u></strong>
<p>&#1069;&#1090;&#1086;&#1090;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090; &#1074; COM
&#1086;&#1089;&#1086;&#1073;&#1086;&#1077; &#1084;&#1077;&#1089;&#1090;&#1086;
&#1080; &#1101;&#1090;&#1086; &#1085;&#1077;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1081;&#1085;&#1086; - &#1089;
&#1077;&#1075;&#1086; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1074;&#1089;&#1077;&#1075;&#1076;&#1072;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099;,
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1102;&#1097;&#1080;&#1077;&#1089;&#1103;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1084;,
&#1082;&#1088;&#1086;&#1084;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1086;&#1085;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1085;&#1072;&#1084;
&#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1073;&#1072;&#1079;&#1086;&#1074;&#1099;&#1077;
&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1078;&#1080;&#1079;&#1085;&#1100;&#1102;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;. &#1042;&#1086;&#1090; 3
&#1077;&#1075;&#1086; &#1084;&#1077;&#1090;&#1086;&#1076;&#1072; (&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1074;
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072;&#1084;&#1080;):
<p><em><strong>HRESULT QueryInterface(REFIID iid, void **ppvObject)</strong> -
&#1076;&#1072;&#1085;&#1085;&#1099;&#1081; &#1084;&#1077;&#1090;&#1086;&#1076;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1076;&#1083;&#1103;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1103; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; &#1087;&#1086;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1091;.
&#1045;&#1089;&#1083;&#1080;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1096;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1084;, &#1090;&#1086;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1077;&#1085;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; S_OK &#1080;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1077;&#1085; &#1074; ppvObject. &#1042;
&#1087;&#1088;&#1086;&#1090;&#1080;&#1074;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
E_NOINTERFACE.</em>
<p><em><strong>ULONG AddRef(void)</strong> -
&#1080;&#1085;&#1082;&#1088;&#1077;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; &#1080;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1074;&#1089;&#1103;&#1082;&#1080;&#1081; &#1088;&#1072;&#1079;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1077;&#1082;&#1090;&#1086;
&#1089;&#1086;&#1073;&#1080;&#1088;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1086;&#1085; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074;&#1089;&#1103;&#1082;&#1080;&#1081; &#1088;&#1072;&#1079;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1084;&#1077;&#1090;&#1086;&#1076;
QueryInterface
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1077;&#1090;&#1077;&#1083;&#1100;
&#1085;&#1072; &#1082;&#1072;&#1082;&#1086;&#1081;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;).
&#1042;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; -
&#1085;&#1086;&#1074;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082;.</em>
<p><em><strong>ULONG Release(void)</strong> - &#1101;&#1090;&#1086;&#1090;
&#1084;&#1077;&#1090;&#1086;&#1076;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1085;&#1099;&#1077;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103; &#1080;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;
&#1079;&#1072;&#1082;&#1086;&#1085;&#1095;&#1080;&#1083;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1091; &#1089;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1084;.</em>
<p>&#1050;&#1072;&#1082; &#1073;&#1099;&#1083;&#1086;
&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1086; &#1074;&#1099;&#1096;&#1077;,
&#1101;&#1090;&#1080; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1073;&#1099;&#1090;&#1100;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1084;&#1080;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072;&#1084;&#1080;
&#1083;&#1102;&#1073;&#1086;&#1075;&#1086;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072; &#1080;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086; &#1074;
&#1090;&#1072;&#1082;&#1086;&#1084;
&#1087;&#1086;&#1088;&#1103;&#1076;&#1082;&#1077; (&#1087;&#1086;&#1088;&#1103;&#1076;&#1086;&#1082;
&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1086;&#1095;&#1077;&#1085;&#1100; &#1074;&#1072;&#1078;&#1077;&#1085; -
&#1101;&#1090;&#1086; &#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1080;&#1079; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;,
&#1087;&#1088;&#1080;&#1085;&#1103;&#1090;&#1086;&#1081; &#1074; COM).
<p><strong><em>&#1057;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074; &#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1074;</em></strong>
<p>&#1058;&#1072;&#1082; &#1082;&#1072;&#1082;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1103;
COM &#1085;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1091;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1085;&#1080;&#1082;&#1072;&#1082;&#1080;&#1093;
&#1086;&#1089;&#1086;&#1073;&#1099;&#1093;
&#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1086;&#1074; &#1074;
&#1086;&#1090;&#1085;&#1086;&#1096;&#1077;&#1085;&#1080;&#1080;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;, &#1090;&#1086;
&#1084;&#1099; &#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1084;
&#1079;&#1072;&#1086;&#1089;&#1090;&#1088;&#1103;&#1090;&#1100; &#1085;&#1072;
&#1101;&#1090;&#1086;&#1084;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1103;,
&#1089;&#1082;&#1072;&#1078;&#1091; &#1083;&#1080;&#1096;&#1100;,
&#1095;&#1090;&#1086; &#1083;&#1102;&#1073;&#1086;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1091;&#1089;&#1083;&#1086;&#1074;&#1085;&#1086;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1085;&#1072;
&#1076;&#1074;&#1077; &#1095;&#1072;&#1089;&#1090;&#1080; -
&#1087;&#1077;&#1088;&#1074;&#1072;&#1103;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1080; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1089;&#1099;, &#1072;
&#1074;&#1090;&#1086;&#1088;&#1072;&#1103; -
&#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1085;&#1099;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; (&#1074; &#1090;&#1086;&#1084;
&#1095;&#1080;&#1089;&#1083;&#1077; &#1080;
&#1074;&#1099;&#1096;&#1077;&#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1090;&#1099;&#1081;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082;).
<p>&#1040; &#1074;&#1086;&#1090;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099; &#1074;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1080;&#1080; &#1086;&#1090;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1080;&#1084;&#1077;&#1090;&#1100;
&#1095;&#1077;&#1090;&#1082;&#1086;
&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;.
<p>&#1054;&#1089;&#1085;&#1086;&#1074;&#1086;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; (&#1095;&#1072;&#1089;&#1090;&#1086;
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &quot;vtable&quot;). &#1042;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1072;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1080;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;,
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1097;&#1080;&#1081; &#1080;&#1079;
&#1095;&#1077;&#1090;&#1099;&#1088;&#1077;&#1093;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1086;&#1074; (&#1090;&#1088;&#1080;
&#1080;&#1079; &#1085;&#1080;&#1093; -
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099; IUnknown).
<p><code><!--mstheme--></font>
<pre>...
proc Addref, pi
enter
...
return
...

proc Method1, pi
enter
...
return
...

IsomeInterface		dd 	IsomeInterface_vtable

IsomeInterface_vtable	dd 	QueryInterface
				dd 	Addref
				dd 	Release
				dd 	Method1</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;, &#1085;&#1077; &#1090;&#1072;&#1082;
&#1083;&#1080;? &#1063;&#1090;&#1086;&#1073;&#1099;
&#1074;&#1099;&#1079;&#1074;&#1072;&#1090;&#1100;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1084;&#1077;&#1090;&#1086;&#1076; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1079;&#1085;&#1072;&#1090;&#1100; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1077;&#1075;&#1086;
&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077; &#1074; vtable,
&#1087;&#1088;&#1072;&#1074;&#1076;&#1072; &#1090;&#1091;&#1090;
&#1077;&#1089;&#1090;&#1100; &#1086;&#1076;&#1085;&#1072;
&#1090;&#1086;&#1085;&#1082;&#1086;&#1089;&#1090;&#1100; -
&#1087;&#1077;&#1088;&#1074;&#1099;&#1084;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1091;
&#1074;&#1089;&#1077;&#1075;&#1076;&#1072;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089; -
&#1076;&#1072;&#1078;&#1077; &#1077;&#1089;&#1083;&#1080; &#1074;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1080;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;&#1089;&#1103; void &#1090;.&#1077;.
&#1074;&#1099;&#1079;&#1086;&#1074; Release &#1073;&#1091;&#1076;&#1077;&#1090;
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1077;&#1090;&#1100; &#1085;&#1077;
&#1090;&#1072;&#1082;:
<p><code><!--mstheme--></font>
<pre>mov eax, [IsomeInterface]
			call dword [eax + 8]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1072; &#1074;&#1086;&#1090; &#1090;&#1072;&#1082;:
<p><code><!--mstheme--></font>
<pre>			mov eax, [IsomeInterface]
			push Isome_interface
			call dword [eax + 8]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1077;&#1083;&#1086; &#1074; &#1090;&#1086;&#1084;,
&#1095;&#1090;&#1086; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1103;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1086;&#1074;
&#1076;&#1072;&#1102;&#1090;&#1089;&#1103;, &#1082;&#1072;&#1082;
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;, &#1076;&#1083;&#1103;
&#1103;&#1079;&#1099;&#1082;&#1086;&#1074;
&#1074;&#1099;&#1089;&#1086;&#1082;&#1086;&#1075;&#1086;
&#1091;&#1088;&#1086;&#1074;&#1085;&#1103;, &#1072; &#1090;&#1072;&#1084;
&#1101;&#1090;&#1091; &#1088;&#1072;&#1073;&#1086;&#1090;&#1091; &#1079;&#1072;
&#1085;&#1072;&#1089;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088; &#1080;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1085;&#1072; C
&#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1099;&#1081;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1073;&#1091;&#1076;&#1077;&#1090; &#1090;&#1072;&#1082;&#1080;&#1084;:
<p><code><!--mstheme--></font>
<pre>			pIUnknown-&gt;Release();</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><strong>Script Engines.</strong>
<p>&#1055;&#1088;&#1077;&#1076;&#1087;&#1086;&#1083;&#1086;&#1078;&#1080;&#1084;,
&#1095;&#1090;&#1086; &#1091; &#1085;&#1072;&#1089; &#1074;
&#1085;&#1072;&#1083;&#1080;&#1095;&#1080;&#1080; &#1077;&#1089;&#1090;&#1100;
&#1090;&#1072;&#1082;&#1072;&#1103;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1082;&#1072;:
<p>(&#1051;&#1077;&#1075;&#1082;&#1086;
&#1079;&#1072;&#1084;&#1077;&#1090;&#1080;&#1090;&#1100;, &#1095;&#1090;&#1086;
&#1086;&#1085;&#1072; &#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1076;&#1077;&#1083;&#1072;&#1077;&#1090; &#1082;&#1088;&#1086;&#1084;&#1077;
&#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086;
&#1087;&#1086;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1086;&#1082;&#1085;&#1086;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1080;&#1103;
&#1092;&#1072;&#1081;&#1083;&#1072; &#1087;&#1086;
&#1085;&#1072;&#1078;&#1072;&#1090;&#1080;&#1102; &#1085;&#1072;
&#1082;&#1085;&#1086;&#1087;&#1082;&#1091;)
<p><code><!--mstheme--></font>
<pre><font size="2"><b>format PE GUI 4.0
entry start
include 'include\win32ax.inc'
section '.scrpt' code readable executable

start:      invoke GetModuleHandleA, 0
		mov [hInst], eax
		invoke DialogBoxParamA, eax, 1000, HWND_DESKTOP, DlgProc, 0
		invoke ExitProcess, 0

proc DlgProc, hwnd, msg, wparam, lparam
		enter
		cmp [msg], WM_INITDIALOG
		jz wminitdialog
		cmp [msg], WM_COMMAND
		jz wmcommand
		cmp [msg], WM_CLOSE
		jz wmclose
		sub eax, eax
		jmp finish
				
wminitdialog:
mov eax, [hwnd]
		mov [hWnd], eax
		invoke VirtualAlloc, 0, MAX_PATH, MEM_COMMIT, PAGE_READWRITE
		mov [szFileName], eax
		
		jmp processed
				
wmcommand:	cmp [wparam], BN_CLICKED shl 16 + 1001
		jnz processed

		mov eax, [szFileName]
		mov ecx, MAX_PATH
@@:		mov byte [eax], 0 
		inc eax
		dec ecx
		jnz @B
				
		push szFilter
		push szTitle
		push dword [hwnd]
		call GetFileName
				
		jmp processed

wmclose:	invoke VirtualFree, [szFileName], MAX_PATH, MEM_DECOMMIT
            invoke EndDialog, [hwnd], 0
				
processed:	sub eax, eax
		inc eax
		
finish:	return
      
proc GetFileName, hParent, lpTitle, lpFilter

		enter
		mov eax, [hParent]
    		mov [ofn.hwndOwner], eax
   		mov eax, [hInst]
   		mov [ofn.hInstance], eax
   		mov eax, [lpFilter]
    		mov [ofn.lpstrFilter], eax 
    		mov eax, [szFileName]
    		mov [ofn.lpstrFile], eax
    		mov [ofn.nMaxFile], MAX_PATH
mov eax, [lpTitle]
    		mov [ofn.lpstrTitle], eax
    		mov [ofn.Flags], OFN_EXPLORER or OFN_FILEMUSTEXIST or OFN_LONGNAMES
		
		invoke GetOpenFileName, ofn
		return

section '.data' data readable writeable

ofn OPENFILENAMEA

szFilter db 'VBScripts', 0, '*.vbs', 0, \ 
	    'All files (heh... you can try...)', 0, '*.*',	0, 0
		 
szTitle db 'Just open file...', 0
szFileName dd 0
hInst dd 0
hWnd dd 0
section '.idata' import data readable writeable
library kernel32, 'kernel32.dll', \
	user32, 'user32.dll', \
       comdlg32, 'comdlg32.dll'
        
import kernel32, ExitProcess, 'ExitProcess', \
		 VirtualAlloc, 'VirtualAlloc', \
	         VirtualFree, 'VirtualFree', \
		GetModuleHandleA, 'GetModuleHandleA'
	   
import user32, DialogBoxParamA, 'DialogBoxParamA', \
	       EndDialog, 'EndDialog', \
	       MessageBoxA, 'MessageBoxA'
	   
import comdlg32, GetOpenFileName, 'GetOpenFileNameA'	   

section '.rsrc' resource data readable

directory RT_DIALOG, dialogs

resource dialogs, 1000, LANG_ENGLISH+SUBLANG_DEFAULT, main_dlg

dialog main_dlg, 'RunScript', 70, 70, 70, 50, WS_CAPTION+WS_POPUP+WS_SYSMENU+DS_MODALFRAME
  dialogitem 'BUTTON', 'Execute Script!', 1001, 8, 15, 55, 15, WS_VISIBLE+WS_TABSTOP+BS_PUSHBUTTON
enddialog</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1040; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b>Dim a, b
a = InputBox(&quot;A:&quot;)
b = MsgBox(&quot;A^2=&quot; &amp; a^2, 64, &quot;--&quot;)</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>(&#1044;&#1072; &#1087;&#1088;&#1086;&#1089;&#1090;&#1103;&#1090;
&#1084;&#1077;&#1085;&#1103; &#1041;&#1086;&#1075;&#1080; &#1079;&#1072;
&#1087;&#1086;&#1103;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1079;&#1076;&#1077;&#1089;&#1100; &#1101;&#1090;&#1080;&#1093;
&#1082;&#1088;&#1072;&#1084;&#1086;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1089;&#1090;&#1088;&#1086;&#1082; ;)
<p>&#1048; &#1082;&#1088;&#1086;&#1084;&#1077;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1077;&#1089;&#1090;&#1100;
&#1077;&#1097;&#1077; &#1078;&#1077;&#1083;&#1072;&#1085;&#1080;&#1077;
&#1079;&#1072;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1089;&#1103;.
&#1053;&#1091; &#1095;&#1090;&#1086; &#1078;&#1077;
&#1087;&#1088;&#1080;&#1089;&#1090;&#1091;&#1087;&#1080;&#1084;...
<p>&#1053;&#1072;
&#1089;&#1077;&#1075;&#1086;&#1076;&#1085;&#1103;&#1096;&#1085;&#1080;&#1081;
&#1076;&#1077;&#1085;&#1100; &#1074;&#1089;&#1077;&#1084;&#1080;
&#1085;&#1072;&#1084;&#1080; &#1083;&#1102;&#1073;&#1080;&#1084;&#1072;&#1103;
&#1082;&#1086;&#1088;&#1087;&#1086;&#1088;&#1072;&#1094;&#1080;&#1103; Microsoft
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1082;&#1080;&#1087;&#1090;&#1086;&#1074;&#1099;&#1077;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1080; JavaScript &#1080; VBScript
&#1089;&#1086;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1086;
&#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1086; -
&#1077;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1077;,
&#1095;&#1077;&#1075;&#1086; &#1086;&#1085;&#1080;
&#1093;&#1086;&#1090;&#1103;&#1090;, &#1090;&#1072;&#1082; &#1101;&#1090;&#1086;
&#1091;&#1087;&#1086;&#1084;&#1080;&#1085;&#1072;&#1085;&#1080;&#1077; &#1086;
&#1085;&#1080;&#1093; &#1074; AboutBox'e
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;,
&#1095;&#1090;&#1086;,
&#1089;&#1086;&#1075;&#1083;&#1072;&#1089;&#1080;&#1090;&#1077;&#1089;&#1100;,
&#1076;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1085;&#1077;&#1090;&#1080;&#1087;&#1080;&#1095;&#1085;&#1086;.
<p>&#1060;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1101;&#1090;&#1080; &#1076;&#1074;&#1080;&#1078;&#1082;&#1080;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1090;&#1089;&#1103; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1072;&#1093; jscript.dll &#1080; vbscript.dll,
&#1085;&#1086; &#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1077;&#1085;&#1099;
&#1074; &#1074;&#1080;&#1076;&#1077; COM-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;,
&#1072; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090; &#1085;&#1072;&#1096;&#1072;
&#1094;&#1077;&#1083;&#1100; -
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1089; COM,
&#1095;&#1077;&#1084; &#1084;&#1099; &#1089;&#1077;&#1081;&#1095;&#1072;&#1089;
&#1080; &#1079;&#1072;&#1081;&#1084;&#1077;&#1084;&#1089;&#1103;.
<p>&#1057;&#1072;&#1084;&#1086;&#1077;
&#1087;&#1077;&#1088;&#1074;&#1086;&#1077;, &#1095;&#1090;&#1086;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; - &#1101;&#1090;&#1086;
&#1087;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; <strong>CoInitialize</strong>
&#1075;&#1076;&#1077;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100; &#1074;
&#1085;&#1072;&#1095;&#1072;&#1083;&#1077;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1087;&#1088;&#1080;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1080;
&#1086;&#1082;&#1085;&#1072;:
<p><code><!--mstheme--></font>
<pre>wminitdialog:	mov eax, [hwnd]
			mov [hWnd], eax
			invoke CoInitialize, 0</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1072;&#1085;&#1085;&#1072;&#1103;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1091; COM
&#1080; &#1076;&#1086;&#1083;&#1078;&#1085;&#1072; &#1073;&#1099;&#1090;&#1100;
&#1074;&#1099;&#1079;&#1074;&#1072;&#1085;&#1072;
&#1087;&#1077;&#1088;&#1077;&#1076;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;&#1084;
&#1083;&#1102;&#1073;&#1099;&#1093; CoXXX-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;.
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; API <strong>CoCreateInstance</strong>
&#1087;&#1086;&#1087;&#1088;&#1086;&#1089;&#1080;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1091;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1076;&#1083;&#1103;
&#1085;&#1072;&#1089; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099;
&#1076;&#1083;&#1103;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1086;&#1084; VBScript.
<p><code><!--mstheme--></font>
<pre>	invoke CoCreateInstance, CLSID_VBScript, 0, CLSCTX_INPROC_SERVER, \
	       IID_IActiveScript, pIActiveScript</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1077;&#1088;&#1074;&#1099;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1086;&#1073;&#1086;&#1081;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
&#1082;&#1083;&#1072;&#1089;&#1089;&#1072;, &#1082;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084;&#1091;
&#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1080;&#1090;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1074;&#1072;&#1077;&#1084;&#1099;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;.
&#1053;&#1091;&#1078;&#1085;&#1099;&#1081; &#1085;&#1072;&#1084;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
&#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1080;&#1090;
&#1082; &#1082;&#1083;&#1072;&#1089;&#1089;&#1091; &quot;VB Script Language&quot;,
&#1080;&#1084;&#1077;&#1102;&#1097;&#1077;&#1084;&#1091; ID <strong>0b54f3741h-5b07h-11cfh-0a4b0h-00aa004a55e8h</strong>
<p>&#1042;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1075;&#1076;&#1077; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1073;&#1099;&#1090;&#1100; &#1079;&#1072;&#1087;&#1091;&#1097;&#1077;&#1085;
&#1082;&#1086;&#1076;,
&#1089;&#1086;&#1079;&#1076;&#1072;&#1102;&#1097;&#1080;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;.
&#1047;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; <strong>CLSCTX_INPROC_SERVER</strong>
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1090;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1101;&#1090;&#1086;
&#1073;&#1099;&#1083;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1085;&#1086;
&#1074; &#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1085;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.
<p>&#1058;&#1088;&#1077;&#1090;&#1080;&#1081;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1086;&#1073;&#1086;&#1081;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
&#1079;&#1072;&#1087;&#1088;&#1072;&#1096;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1075;&#1086;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;. &#1042;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1086;&#1085; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1073;&#1099;&#1090;&#1100; &#1090;&#1072;&#1082;&#1080;&#1084;: <strong>0bb1a2ae1h-0a4f9h-11cfh-8fh20h-0805f2c0d064</strong>
<p>&#1050;&#1072;&#1082; &#1074;&#1099; &#1091;&#1078;&#1077;
&#1079;&#1085;&#1072;&#1077;&#1090;&#1077;, COM-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1095;&#1077;&#1088;&#1077;&#1079;
&#1089;&#1074;&#1086;&#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099; &#1080;
&#1085;&#1091;&#1078;&#1085;&#1099;&#1081; &#1085;&#1072;&#1084; VBScript
&#1079;&#1076;&#1077;&#1089;&#1100; &#1085;&#1077;
&#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077; -
&#1076;&#1083;&#1103;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1086;&#1084; &#1085;&#1072;&#1084;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103;
&#1076;&#1074;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072; (&#1093;&#1086;&#1090;&#1103;,
&#1077;&#1089;&#1083;&#1080; &#1073;&#1099;&#1090;&#1100;
&#1090;&#1086;&#1095;&#1085;&#1099;&#1084;, &#1090;&#1086; &#1080;&#1093;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077;, &#1085;&#1086;
&#1079;&#1076;&#1077;&#1089;&#1100; &#1084;&#1099;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1074;&#1072;):
<p><strong>IActiveScript</strong> -
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099; &#1076;&#1083;&#1103;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1072; &#1080;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1077;&#1075;&#1086;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077;&#1084;. &#1040;
&#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; <strong>IActiveScriptParse</strong>
&#1084;&#1099; &#1084;&#1086;&#1078;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;.
<p>&#1042; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1075;&#1086;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1072; <strong>CoCreateInstance</strong>
&#1074; pIActiveScript &#1073;&#1091;&#1076;&#1077;&#1090;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1077;&#1085;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089; <strong>IActiveScript</strong>,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1084;&#1099;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1080;&#1083;&#1080;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1074; GUID <strong>0bb1a2ae1h-0a4f9h-11cfh-8fh20h-0805f2c0d064</strong>.
<p>&#1053;&#1086; &#1085;&#1072;&#1084; &#1085;&#1091;&#1078;&#1077;&#1085;
&#1077;&#1097;&#1077; &#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089; <strong>IActiveScriptParse</strong>,
&#1076;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077; &#1077;&#1075;&#1086;
&#1089;&#1077;&#1081;&#1095;&#1072;&#1089;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084;. &#1058;&#1072;&#1082;
&#1082;&#1072;&#1082; &#1086;&#1085;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1089;&#1086;&#1084;
&#1090;&#1086;&#1075;&#1086; &#1078;&#1077;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;, &#1095;&#1090;&#1086; &#1080;
<strong>IActiveScript</strong> &#1084;&#1099;
&#1084;&#1086;&#1078;&#1077;&#1084;
&#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1086;&#1084; QueryInterface
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1075;&#1086;.
<p><code><!--mstheme--></font>
<pre>		mov edx, [pIActiveScript]
		mov edx, [edx]
		push pIActiveScriptParse
		push IID_IActiveScriptParse
		push [pIActiveScript]
		call dword [edx]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1069;&#1090;&#1086;&#1090; &#1082;&#1086;&#1076;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072; <strong>IActiveScriptParse</strong>
&#1074; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1091;&#1102;
pIActiveScriptParse.
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1091; &#1085;&#1072;&#1089;
&#1077;&#1089;&#1090;&#1100; &#1074;&#1089;&#1077;,
&#1095;&#1090;&#1086;&#1073;&#1099;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1086;&#1074;&#1099;&#1084;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1086;&#1084;.
&#1044;&#1091;&#1084;&#1072;&#1077;&#1090;&#1077; &#1101;&#1090;&#1086;
&#1074;&#1089;&#1077;? &#1057;&#1072;&#1084;&#1086;&#1077;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1077;&#1089;&#1085;&#1086;&#1077;
&#1077;&#1097;&#1077; &#1074;&#1087;&#1077;&#1088;&#1077;&#1076;&#1080; ;)
<p><strong>IActiveScriptSite &#1080; IActiveScriptSiteWindow.</strong>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1091; &#1085;&#1072;&#1089;
&#1077;&#1089;&#1090;&#1100; &#1076;&#1074;&#1080;&#1078;&#1086;&#1082;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1085;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090; &#1080;
&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1080;&#1084;. &#1042; &#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1077;,
&#1084;&#1099; &#1084;&#1086;&#1078;&#1077;&#1084;
&#1087;&#1086;&#1087;&#1088;&#1086;&#1073;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1082;&#1086;&#1088;&#1084;&#1080;&#1090;&#1100; &#1077;&#1084;&#1091;
&#1095;&#1090;&#1086;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1091;&#1078;&#1077; &#1089;&#1077;&#1081;&#1095;&#1072;&#1089;, &#1085;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1072;&#1089;&#1100;
&#1086;&#1076;&#1085;&#1072;
&#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1072; -
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082; &#1078;&#1080;&#1074;&#1077;&#1090;
&#1089;&#1074;&#1086;&#1077;&#1081;
&#1074;&#1085;&#1091;&#1090;&#1088;&#1077;&#1085;&#1085;&#1077;&#1081;
&#1078;&#1080;&#1079;&#1085;&#1100;&#1102; &#1080; &#1084;&#1099;
&#1074;&#1089;&#1077; &#1088;&#1072;&#1074;&#1085;&#1086;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1091;&#1079;&#1085;&#1072;&#1077;&#1084; &#1086;
&#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1072;&#1093;.
&#1047;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1084;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1086;&#1073;&#1077;&#1089;&#1087;&#1077;&#1095;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086;
&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072;&#1084;&#1080;
&#1089;&#1074;&#1103;&#1079;&#1080; &#1089; &#1085;&#1072;&#1096;&#1080;&#1084;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;&#1084;.
<p>&#1053;&#1072;&#1076;&#1077;&#1102;&#1089;&#1100;, &#1085;&#1080;
&#1076;&#1083;&#1103; &#1082;&#1086;&#1075;&#1086; &#1085;&#1077;
&#1089;&#1090;&#1072;&#1085;&#1077;&#1090;
&#1089;&#1102;&#1088;&#1087;&#1088;&#1080;&#1079;&#1086;&#1084;,
&#1095;&#1090;&#1086; &#1101;&#1090;&#1086; &quot;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;
&#1089;&#1074;&#1103;&#1079;&#1080;&quot;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1085;&#1080;&#1095;&#1077;&#1084; &#1080;&#1085;&#1099;&#1084;,
&#1082;&#1072;&#1082; &#1077;&#1097;&#1077; &#1086;&#1076;&#1085;&#1080;&#1084;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1084; ;)
&#1057;&#1090;&#1072;&#1083;&#1086; &#1073;&#1099;&#1090;&#1100;,
&#1085;&#1072;&#1089;&#1090;&#1072;&#1083;&#1086;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100; &#1085;&#1072;
&#1087;&#1088;&#1072;&#1082;&#1090;&#1080;&#1082;&#1077; &#1074;&#1089;&#1077;
&#1090;&#1077;&#1086;&#1088;&#1080;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1077;
&#1079;&#1085;&#1072;&#1085;&#1080;&#1103; &#1086; COM,
&#1087;&#1086;&#1090;&#1086;&#1084;&#1091; &#1095;&#1090;&#1086;
&#1085;&#1072;&#1084;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1086;&#1080;&#1090;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1101;&#1090;&#1086;&#1090;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1080;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074;&#1089;&#1077; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099;
&#1077;&#1075;&#1086;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1074;.
&#1048;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1074;
&#1073;&#1091;&#1076;&#1077;&#1090; &#1076;&#1074;&#1072; - <strong>IActiveScriptSite</strong>
&#1080; <strong>IActiveScriptSiteWindow</strong>.
<p>IActiveScriptSite &#1076;&#1083;&#1103; &#1085;&#1072;&#1089;
&#1095;&#1088;&#1077;&#1079;&#1074;&#1099;&#1095;&#1072;&#1081;&#1085;&#1086;
&#1074;&#1072;&#1078;&#1077;&#1085; &#1090;.&#1082;.
&#1087;&#1086;&#1084;&#1080;&#1084;&#1086; &#1074;&#1089;&#1077;
&#1087;&#1088;&#1086;&#1095;&#1077;&#1075;&#1086; &#1089; &#1077;&#1075;&#1086;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077; &#1086;
&#1074;&#1089;&#1077;&#1093;
&#1089;&#1086;&#1073;&#1099;&#1090;&#1080;&#1103;&#1093;,
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1096;&#1077;&#1076;&#1096;&#1080;&#1093;
&#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1072;. &#1042;&#1086;&#1090;
&#1077;&#1075;&#1086; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099; &#1074;
&#1087;&#1086;&#1088;&#1103;&#1076;&#1082;&#1077;
&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1074;
vtable:<!--mstheme--></font>
<!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">QueryInterface<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">AddRef<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">Release<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetLCID<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetItemInfo<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetDocVersionString<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnScriptTerminate<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnStateChange<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnScriptError<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnEnterScript<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnLeaveScript<!--mstheme--></font><!--msthemelist--></td>
  </tr>
<!--msthemelist--></table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1040; &#1074;&#1086;&#1090;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
IActiveScriptSiteWindow
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1086;&#1075;&#1086;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1103;
&#1085;&#1077;&#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;,
&#1085;&#1086; &#1084;&#1099; &#1074;&#1089;&#1077; &#1078;&#1077;
&#1101;&#1090;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1077;&#1084;. &#1048;
&#1074;&#1086;&#1090; &#1087;&#1086;&#1095;&#1077;&#1084;&#1091; -
&#1082;&#1086;&#1075;&#1076;&#1072; &#1089;&#1082;&#1088;&#1080;&#1087;&#1090;
&#1079;&#1072;&#1093;&#1086;&#1095;&#1077;&#1090; &#1082;&#1072;&#1082;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1074;&#1079;&#1072;&#1080;&#1084;&#1086;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089; GUI (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1079;&#1080;&#1090;&#1100;
&#1086;&#1073;&#1099;&#1095;&#1085;&#1099;&#1081;
&#1084;&#1077;&#1089;&#1089;&#1072;&#1076;&#1078; &#1073;&#1086;&#1082;&#1089;)
&#1076;&#1074;&#1080;&#1078;&#1082;&#1091;
&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1093;&#1101;&#1085;&#1076;&#1083; &#1086;&#1082;&#1085;&#1072;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084;&#1091;
&#1101;&#1090;&#1086;&#1090; &#1084;&#1077;&#1089;&#1089;&#1077;&#1076;&#1078;
&#1073;&#1086;&#1082;&#1089;
&#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1080;&#1090;.
&#1063;&#1090;&#1086; &#1086;&#1085;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1077;&#1090;?
&#1047;&#1072;&#1087;&#1088;&#1086;&#1089;&#1080;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
IActiveScriptSiteWindow &#1080; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072; GetWindow
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;
&#1074;&#1086;&#1078;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;
hWnd. &#1045;&#1089;&#1083;&#1080;
&#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1080;&#1090;&#1089;&#1103;,
&#1095;&#1090;&#1086; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1085;&#1077;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
IActiveScriptSiteWindow &#1080;&#1083;&#1080; &#1095;&#1090;&#1086;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1074; &#1101;&#1090;&#1086;&#1084; &#1088;&#1086;&#1076;&#1077;,
&#1090;&#1086; &#1076;&#1074;&#1080;&#1078;&#1086;&#1082;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1080;&#1090; &#1086;&#1073;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1077; &#1080;
&#1087;&#1088;&#1077;&#1082;&#1088;&#1072;&#1090;&#1080;&#1090;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1072;. &#1042;&#1086;&#1090;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1085;&#1072;&#1084;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089; -
&#1095;&#1090;&#1086;&#1073;&#1099;
&#1091;&#1074;&#1080;&#1076;&#1077;&#1090;&#1100;
&#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1099;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;.
<p><strong>&#1056;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;.</strong>
<p>&#1050;&#1072;&#1082; &#1103; &#1091;&#1078;&#1077;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1103;
COM &#1085;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1091;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1085;&#1080;&#1082;&#1072;&#1082;&#1080;&#1093;
&#1086;&#1089;&#1086;&#1073;&#1099;&#1093;
&#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1086;&#1074;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;. &#1052;&#1099;
&#1074;&#1099;&#1073;&#1077;&#1088;&#1077;&#1084;
&#1089;&#1072;&#1084;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; &#1087;&#1091;&#1090;&#1100; -
&#1085;&#1072;&#1096; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090;&#1100;:
<p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1080;
&#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099; <strong>IActiveScriptSite</strong>
&#1080; <strong>IActiveScriptSiteWindow</strong>,<br>
- &#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082; (&#1083;&#1102;&#1073;&#1086;&#1081;
&#1093;&#1086;&#1088;&#1086;&#1096;&#1080;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090;&#1100;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082; &#1080;&#1083;&#1080;
&#1093;&#1086;&#1090;&#1103; &#1073;&#1099;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1074;&#1080;&#1076;,
&#1095;&#1090;&#1086; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
;)
<p>&#1055;&#1077;&#1088;&#1074;&#1086;-&#1085;&#1072;&#1087;&#1077;&#1088;&#1074;&#1086;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;,
&#1075;&#1076;&#1077; &#1101;&#1090;&#1086; &#1074;&#1089;&#1077;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;&#1089;&#1103;. &#1052;&#1099;
&#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1089;&#1103;
API LocalAlloc &#1080; &#1074;&#1099;&#1076;&#1077;&#1083;&#1080;&#1084;
&#1076;&#1083;&#1103; &#1085;&#1077;&#1075;&#1086;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;.
<p><code><!--mstheme--></font>
<pre>		invoke LocalAlloc, LMEM_FIXED, 12
		mov [ActiveScriptSiteObject], eax
		mov [eax + 8], 1	;&#1048;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1084; &#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082; &#1089;&#1089;&#1099;&#1083;&#1086;&#1082;</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1091; &#1085;&#1072;&#1089;
&#1077;&#1089;&#1090;&#1100; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; -
&#1076;&#1077;&#1083;&#1086; &#1079;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;&#1084;&#1080;.
&#1057;&#1087;&#1077;&#1088;&#1074;&#1072;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1091;&#1077;&#1084;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099; IUnknown:
<p><code><!--mstheme--></font>
<pre><font size="2"><b>proc IActiveScriptSite_QueryInterface, pi, iid, ppvObject 
		
		enter
               invoke IsEqualGUID, [iid], IID_IUnknown
		test eax, eax
		jnz .s_ok
                
		invoke IsEqualGUID, [iid], IID_IActiveScriptSite
		test eax, eax
		jnz .s_ok
                
		invoke IsEqualGUID, [iid], IID_IActiveScriptSiteWindow
		test eax, eax
		jnz .S_OK_W
                
.NoInterface:   mov eax, E_NOINTERFACE
                
                return

.s_ok:          mov eax, [ActiveScriptSiteObject]
                mov eax, [eax]
                mov edx, [ppvObject]
                mov [edx], eax
                mov eax, S_OK
                
                return       
                
.S_OK_W:	mov eax, [ActiveScriptSiteObject]
               	mov eax, [eax + 4]
               	mov edx, [ppvObject]
               	mov [edx], eax
               	mov eax, S_OK                          
		return</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1076;&#1077;&#1089;&#1100; &#1084;&#1099; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; API IsEqualGUID
&#1089;&#1074;&#1077;&#1088;&#1103;&#1077;&#1084;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1085;&#1072;&#1084; GUID &#1089;
&#1101;&#1090;&#1072;&#1083;&#1086;&#1085;&#1085;&#1099;&#1084; &#1080;
&#1077;&#1089;&#1083;&#1080; &#1086;&#1085;&#1080;
&#1089;&#1086;&#1074;&#1087;&#1072;&#1076;&#1072;&#1102;&#1090;, &#1090;&#1086;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;.
&#1055;&#1086;&#1103;&#1089;&#1085;&#1077;&#1085;&#1080;&#1077;
&#1079;&#1076;&#1077;&#1089;&#1100;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1086;&#1076;&#1085;&#1086; -
&#1090;&#1072;&#1082; &#1082;&#1072;&#1082; &#1085;&#1072;&#1096;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1085;&#1077;
&#1080;&#1084;&#1077;&#1077;&#1090;
&#1089;&#1072;&#1084;&#1086;&#1089;&#1090;&#1086;&#1103;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086;
<strong>IUnknown</strong>, &#1090;&#1086; &#1074;
&#1086;&#1090;&#1074;&#1077;&#1090; &#1085;&#1072;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
<strong>00000000-0000-0000-0c00000000000046h</strong> (GUID IUnknown)
&#1084;&#1099; &#1074;&#1077;&#1088;&#1085;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
IActiveScriptSite, &#1095;&#1090;&#1086; &#1074;
&#1076;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1086;&#1076;&#1085;&#1086; &#1080;
&#1090;&#1086;&#1078;&#1077;.
<p><code><!--mstheme--></font>
<pre>proc IActiveScriptSite_AddRef, pi
               enter      
               	mov ecx, [ActiveScriptSiteObject]
               	inc dword [ecx + 8]
               	mov eax, [ecx + 8]
               	return</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1091;&#1090; &#1074;&#1086;&#1086;&#1073;&#1097;&#1077;
&#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1077;&#1074;
&#1085;&#1077; &#1090;&#1088;&#1077;&#1073;&#1091;&#1102;&#1090;&#1089;&#1103;
;)
<p><code><!--mstheme--></font>
<pre>proc IActiveScriptSite_Release, pi
               enter     
               	mov ecx, [ActiveScriptSiteObject]
               dec dword [ecx + 8]
               mov eax, [ecx + 8]
               test eax, eax
               jnz .ret_
               invoke LocalFree, ecx
.ret_:        	return</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1072;&#1082;&#1086;&#1085;&#1077;&#1094;,
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081;
&#1084;&#1077;&#1090;&#1086;&#1076; - Release - &#1086;&#1085;
&#1091;&#1084;&#1077;&#1085;&#1100;&#1096;&#1072;&#1077;&#1090;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072; &#1076;&#1086;
&#1090;&#1077;&#1093; &#1087;&#1086;&#1088;, &#1087;&#1086;&#1082;&#1072;
&#1086;&#1085;&#1086; &#1085;&#1077; &#1089;&#1090;&#1072;&#1085;&#1077;&#1090;
&#1088;&#1072;&#1074;&#1085;&#1099;&#1084; 0,
&#1079;&#1072;&#1090;&#1077;&#1084; &#1087;&#1072;&#1084;&#1103;&#1090;&#1100;
&#1086;&#1089;&#1074;&#1086;&#1073;&#1086;&#1078;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; LocalFree.
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1086;&#1089;&#1090;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1084;&#1087;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1077;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099;:<!--mstheme--></font>
<!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetLCID<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetItemInfo<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetDocVersionString<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnScriptTerminate<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnStateChange<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnScriptError<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnEnterScript<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">OnLeaveScript<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">GetWindow<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">EnableModeless<!--mstheme--></font><!--msthemelist--></td>
  </tr>
<!--msthemelist--></table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1050;&#1072;&#1082; &#1074;&#1080;&#1076;&#1080;&#1090;&#1077;,
&#1080;&#1093; &#1076;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1084;&#1085;&#1086;&#1075;&#1086;, &#1086;&#1076;&#1085;&#1072;&#1082;&#1086;
&#1089;&#1087;&#1077;&#1096;&#1091; &#1074;&#1072;&#1089;
&#1086;&#1073;&#1088;&#1072;&#1076;&#1086;&#1074;&#1072;&#1090;&#1100; -
&#1085;&#1077; &#1074;&#1089;&#1077; &#1080;&#1079; &#1085;&#1080;&#1093;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1077;&#1089;&#1083;&#1080; &#1074;&#1099; &#1085;&#1077;
&#1087;&#1083;&#1072;&#1085;&#1080;&#1088;&#1091;&#1077;&#1090;&#1077;
&#1082;&#1072;&#1082;&#1086;&#1081;-&#1083;&#1080;&#1073;&#1086;
&#1086;&#1089;&#1086;&#1073;&#1086;&#1081;
&#1088;&#1077;&#1072;&#1082;&#1094;&#1080;&#1080;
&#1089;&#1074;&#1086;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;
&#1085;&#1072; &#1085;&#1072;&#1095;&#1072;&#1083;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1072;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1074;&#1087;&#1086;&#1083;&#1085;&#1077;
&#1086;&#1073;&#1086;&#1081;&#1090;&#1080;&#1089;&#1100;
&#1090;&#1072;&#1082;&#1086;&#1081;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081;
OnScriptEnter:
<p><code><!--mstheme--></font>
<pre>proc IActiveScriptSite_OnEnterScript, pi  
                enter
                mov eax, S_OK
                return</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1048;&#1083;&#1080;
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1077;&#1089;&#1083;&#1080; &#1074;&#1099;
&#1093;&#1086;&#1090;&#1080;&#1090;&#1077;
&#1076;&#1086;&#1074;&#1077;&#1088;&#1080;&#1090;&#1100;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1091;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1076;&#1083;&#1103; &#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1082;&#1072;&#1084;&#1080;
&#1087;&#1086; &#1091;&#1084;&#1086;&#1083;&#1095;&#1072;&#1085;&#1080;&#1102;,
&#1090;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; <strong>GetLCID</strong>
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1072;&#1082;:
<p><code><!--mstheme--></font>
<pre>proc IActiveScriptSite_GetLCID, pi, plcid        
                enter
                mov eax, E_NOTIMPL
                return</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1072; &#1090;&#1072;&#1082;&#1086;&#1081;
&#1084;&#1072;&#1085;&#1077;&#1088; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1074;&#1089;&#1077;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099; IActiveScriptSite,
&#1095;&#1090;&#1086; &#1084;&#1099; &#1080;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1077;&#1084;.
<p><code><!--mstheme--></font>
<pre><b><font size="2">proc IActiveScriptSite_GetItemInfo, pi, pstrName, dwReturnMask, ppunkItem, ppTypeInfo
               enter
               	mov eax, TYPE_E_ELEMENTNOTFOUND
		return 

proc IActiveScriptSite_GetDocVersionString, pi, pbstrVersionString
            	enter
               mov eax, E_NOTIMPL
            	return                

proc IActiveScriptSite_OnScriptTerminate, pi, pvarResult, pexcepinfo
              	enter
               mov eax, S_OK
               return

proc IActiveScriptSite_OnStateChange, pi, ssScriptState  
               enter
               	mov eax, S_OK
               return

proc IActiveScriptSite_OnEnterScript, pi  
               enter
        	mov eax, S_OK
              	return
                
proc IActiveScriptSite_OnLeaveScript, pi
              	enter
               	mov eax, S_OK
               return</font></b></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1086;&#1083;&#1100;&#1082;&#1086; &#1074;
&#1084;&#1077;&#1090;&#1086;&#1076; OnScriptError (&#1091;&#1075;&#1072;&#1076;&#1072;&#1081;&#1090;&#1077;
&#1074; &#1082;&#1072;&#1082;&#1086;&#1081;
&#1089;&#1080;&#1090;&#1091;&#1072;&#1094;&#1080;&#1080; &#1086;&#1085;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;;))
&#1084;&#1099; &#1082;&#1086;&#1077;-&#1095;&#1090;&#1086;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1084;:
<p><code><!--mstheme--></font>
<pre>proc IActiveScriptSite_OnScriptError, pi, pase
               enter
         	
		invoke MessageBoxA, 0, mess1, mess1_title, MB_OK + MB_ICONERROR
		mov eax, S_OK
            	return</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1087;&#1088;&#1080;
&#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1074;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1077;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1087;&#1086;&#1103;&#1074;&#1083;&#1103;&#1090;&#1100;&#1089;&#1103;
&#1086;&#1082;&#1085;&#1086; &#1089;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1077;&#1084;.
<p>OK, &#1089; IActiveScriptSite &#1074;&#1088;&#1086;&#1076;&#1077;
&#1088;&#1072;&#1079;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;&#1089;&#1100; -
&#1085;&#1072;&#1089;&#1090;&#1072;&#1083;&#1072;
&#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1100; IActiveScriptSiteWindow.
&#1058;&#1091;&#1090; &#1073;&#1091;&#1076;&#1077;&#1090;
&#1087;&#1088;&#1086;&#1097;&#1077; - &#1085;&#1091;&#1078;&#1085;&#1086;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1074;&#1089;&#1077;
&#1076;&#1074;&#1072; &#1084;&#1077;&#1090;&#1086;&#1076;&#1072;.
<p><code><!--mstheme--></font>
<pre><font size="2"><b>proc IActiveScriptSiteWindow_GetWindow, pi, phwnd
		enter
		mov ecx, [phwnd]  	;&#1042;&#1077;&#1088;&#1085;&#1077;&#1084; hWnd &#1085;&#1072;&#1096;&#1077;&#1075;&#1086; &#1086;&#1082;&#1085;&#1072;.
    		mov eax, [hWnd]
    		mov [ecx], eax
    		mov eax, S_OK       
    		return
    			
proc IActiveScriptSiteWindow_EnableModeless, pi, fEnable
    		enter
    		mov eax, S_OK
    		return</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1072;&#1082; &#1082;&#1072;&#1082; &#1086;&#1073;&#1072;
&#1101;&#1090;&#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;
&#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1072;&#1090;
&#1086;&#1076;&#1085;&#1086;&#1084;&#1091;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1091;, &#1090;&#1086;
&#1087;&#1091;&#1089;&#1090;&#1100;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090;
&#1086;&#1076;&#1085;&#1080; &#1080; &#1090;&#1077; &#1078;&#1077;
&#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1099;&#1077;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099;. &#1054;&#1073;&#1077; Vtable
&#1088;&#1072;&#1079;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084; &#1074;
&#1089;&#1077;&#1075;&#1084;&#1077;&#1085;&#1090;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;, &#1086;&#1085;&#1080;
&#1073;&#1091;&#1076;&#1091;&#1090; &#1090;&#1072;&#1082;&#1080;&#1084;&#1080;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b>pIActiveScriptSite_vtable 		dd IActiveScriptSite_vtable
pIActiveScriptSiteWindow_vtable 	dd IActiveScriptSiteWindow_vtable

IActiveScriptSite_vtable 	dd IActiveScriptSite_QueryInterface
                         	dd IActiveScriptSite_AddRef
                         	dd IActiveScriptSite_Release
                         	dd IActiveScriptSite_GetLCID
                         	dd IActiveScriptSite_GetItemInfo
                         	dd IActiveScriptSite_GetDocVersionString
                         	dd IActiveScriptSite_OnScriptTerminate
                         	dd IActiveScriptSite_OnStateChange
                         	dd IActiveScriptSite_OnScriptError
                         	dd IActiveScriptSite_OnEnterScript
                        	dd IActiveScriptSite_OnLeaveScript
                        
IActiveScriptSiteWindow_vtable	dd IActiveScriptSite_QueryInterface
                        	dd IActiveScriptSite_AddRef
                        	dd IActiveScriptSite_Release
				dd IActiveScriptSiteWindow_GetWindow
				dd IActiveScriptSiteWindow_EnableModeless</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1091; &#1080;
&#1085;&#1072;&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1082;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1080; &#1085;&#1072;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1099; &#1074;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1086;&#1081;
&#1076;&#1083;&#1103; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;:
<p><code><!--mstheme--></font>
<pre>		invoke LocalAlloc, LMEM_FIXED, 12
		mov [ActiveScriptSiteObject], eax
		mov [eax + 8], 1	;&#1048;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1084; &#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082; &#1089;&#1089;&#1099;&#1083;&#1086;&#1082;
               mov dword [eax], pIActiveScriptSite_vtable
            	mov dword [eax + 4], pIActiveScriptSiteWindow_vtable</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1089;&#1077;! &#1053;&#1072;&#1096;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1075;&#1086;&#1090;&#1086;&#1074;,
&#1084;&#1077;&#1090;&#1086;&#1076;&#1099;
&#1080;&#1084;&#1087;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1099;,
&#1086;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1087;&#1086;&#1076;&#1075;&#1086;&#1090;&#1086;&#1074;&#1080;&#1090;&#1100;
&#1080; &#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;.
<p><strong>&#1055;&#1086;&#1076;&#1075;&#1086;&#1090;&#1086;&#1074;&#1082;&#1072;.</strong>
<p>&#1063;&#1090;&#1086; &#1078;&#1077;
&#1089;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1079;&#1072; &#1089;&#1083;&#1086;&#1074;&#1086;&#1084; &quot;&#1087;&#1086;&#1076;&#1075;&#1086;&#1090;&#1086;&#1074;&#1080;&#1090;&#1100;&quot;?
&#1053;&#1091; &#1074;&#1086;-&#1087;&#1077;&#1088;&#1074;&#1099;&#1093;,
&#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086; &#1078;&#1077;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1100; &#1092;&#1072;&#1081;&#1083;
&#1089;&#1086; &#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1086;&#1084; (&#1077;&#1089;&#1083;&#1080;
&#1074;&#1099; &#1087;&#1086;&#1084;&#1085;&#1080;&#1090;&#1077;,
&#1077;&#1075;&#1086; &#1080;&#1084;&#1103; &#1084;&#1099;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1087;&#1088;&#1080;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1080; GetOpenFileName).
&#1054;&#1090;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1082;&#1072;&#1082; &#1086;&#1073;&#1099;&#1095;&#1085;&#1086;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103; API CreateFile:
<p><code><!--mstheme--></font>
<pre>		invoke CreateFileA, [szFileName], GENERIC_READ, FILE_SHARE_READ, \
		                    NULL, OPEN_EXISTING, FILE_ATTRIBUTE_ARCHIVE, NULL
		mov [hFile], eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050;&#1088;&#1086;&#1084;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1085;&#1072;&#1084; &#1085;&#1091;&#1078;&#1077;&#1085; &#1077;&#1075;&#1086;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;:
<p><code><!--mstheme--></font>
<pre>		invoke GetFileSize, eax, 0
		mov [FileSize], eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1095;&#1080;&#1089;&#1083;&#1080;&#1084;
&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; (&#1079;&#1072;&#1095;&#1077;&#1084;
&#1091;&#1084;&#1085;&#1086;&#1078;&#1072;&#1090;&#1100; &#1085;&#1072; 2
&#1086;&#1073;&#1098;&#1103;&#1089;&#1085;&#1102; &#1095;&#1091;&#1090;&#1100;
&#1087;&#1086;&#1079;&#1078;&#1077;):
<p><code><!--mstheme--></font>
<pre>		mov ecx, eax
		inc eax
		inc eax
		shl eax, 1
		push eax
		add eax, ecx
		mov [buffer_size], eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100; &#1087;&#1088;&#1080;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1080; VirtualAlloc:
<p><code><!--mstheme--></font>
<pre>		invoke VirtualAlloc, 0, eax, MEM_COMMIT, PAGE_READWRITE
		mov [pMemory], eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1077;&#1088;&#1074;&#1099;&#1077; FileSize
&#1073;&#1072;&#1081;&#1090; &#1073;&#1091;&#1076;&#1091;&#1090;
&#1079;&#1072;&#1085;&#1103;&#1090;&#1099;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1099;&#1084;
&#1092;&#1072;&#1081;&#1083;&#1072;,
&#1086;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1082;&#1072;
&#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1099;:
<p><code><!--mstheme--></font>
<pre>	
		add eax, dword [FileSize]
		inc eax
		mov [pScript], eax
		
		push eax
		lea ecx, [esp] 
		invoke ReadFile, [hFile], [pMemory], [FileSize], ecx, NULL
		pop ecx</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;
&#1085;&#1077;&#1085;&#1072;&#1076;&#1086;&#1073;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;
&#1079;&#1072;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1092;&#1072;&#1081;&#1083;.
<p><code><!--mstheme--></font>
<pre>		invoke CloseHandle, [hFile]
				
		pop eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1086;&#1090; &#1090;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1088;&#1072;&#1089;&#1082;&#1072;&#1078;&#1091;
&#1079;&#1072;&#1095;&#1077;&#1084; &#1073;&#1099;&#1083;&#1072;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1072;&#1103;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;. &#1044;&#1077;&#1083;&#1086; &#1074;
&#1090;&#1086;&#1084;, &#1095;&#1090;&#1086;
&#1089;&#1077;&#1081;&#1095;&#1072;&#1089; &#1085;&#1072;&#1096;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1086;&#1073;&#1086;&#1081;
&#1086;&#1073;&#1099;&#1095;&#1085;&#1091;&#1102; ASCII-&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100;,
&#1072; VBScript engine
&#1086;&#1087;&#1077;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090; &#1089;&#1086;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080; &#1074;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077; Wide-Character (&#1090;.&#1077;.
&#1082;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;
&#1089;&#1083;&#1086;&#1074;&#1086;, &#1072; &#1085;&#1077;
&#1073;&#1072;&#1081;&#1090;). &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;
&#1085;&#1072;&#1096; &#1089;&#1082;&#1088;&#1080;&#1087;&#1090;
&#1077;&#1097;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1086;&#1080;&#1090;
&#1082;&#1086;&#1085;&#1074;&#1077;&#1088;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;,
&#1095;&#1090;&#1086; &#1087;&#1088;&#1086;&#1097;&#1077;
&#1074;&#1089;&#1077;&#1075;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; MultiByteToWideChar:
<p><code><!--mstheme--></font>
<pre>	invoke MultiByteToWideChar, 0, 0, [pMemory], -1, [pScript], eax</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><strong>&#1047;&#1072;&#1087;&#1091;&#1089;&#1082;.</strong>
<p>&#1042; &#1101;&#1090;&#1086;&#1084;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1077; &#1084;&#1099;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1082;&#1072;&#1082;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082; &#1080;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1090;&#1100; &#1077;&#1084;&#1091;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;.
<p>&#1042;&#1086;-&#1087;&#1077;&#1088;&#1074;&#1099;&#1093;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1091;&#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1090;&#1100;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;
&#1085;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1086;&#1085; &#1085;&#1077;
&#1091;&#1085;&#1080;&#1095;&#1090;&#1086;&#1078;&#1080;&#1083;&#1089;&#1103;
&#1088;&#1072;&#1085;&#1100;&#1096;&#1077;
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080; ;)
<p><code><!--mstheme--></font>
<pre>		mov edx, [pIActiveScriptSite]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	call dword [edx + Addref]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1072;&#1083;&#1077;&#1077;
&#1089;&#1082;&#1072;&#1078;&#1077;&#1084; IActiveScript, &#1095;&#1090;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
IActiveScriptSite
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1085;&#1072;&#1084;&#1080;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;,
&#1076;&#1083;&#1103; &#1095;&#1077;&#1075;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;
&#1084;&#1077;&#1090;&#1086;&#1076; SetScriptSite,
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1074; &#1077;&#1084;&#1091;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;:
<p><code><!--mstheme--></font>
<pre>		mov edx, [pIActiveScript]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	push [pIActiveScript]
            	call dword [edx + 0ch]</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1084;
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1072; InitNew
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1072;
IActiveScriptParse:
<p><code><!--mstheme--></font>
<pre>            	<font size="2"><b>mov edx, [pIActiveScriptParse]
            	push edx
		mov edx, [edx]
            	call dword [edx + 0ch]</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1075;&#1088;&#1091;&#1078;&#1072;&#1077;&#1084;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1084;&#1077;&#1090;&#1086;&#1076; ParseScriptText. &#1059;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1084;&#1077;&#1090;&#1086;&#1076;&#1072;
&#1082;&#1091;&#1095;&#1072;
&#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;,
&#1085;&#1086; &#1074; &#1076;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1084;&#1099;
&#1084;&#1086;&#1078;&#1077;&#1084;
&#1079;&#1072;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100; &#1080;&#1093;
&#1085;&#1091;&#1083;&#1103;&#1084;&#1080;. &#1061;&#1086;&#1090;&#1103;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081;,
&#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;, &#1085;&#1077;
&#1078;&#1077;&#1083;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;,
&#1085;&#1086; &#1103;, &#1083;&#1077;&#1085;&#1090;&#1103;&#1081;
&#1101;&#1090;&#1072;&#1082;&#1080;&#1081;,
&#1087;&#1086;&#1083;&#1077;&#1085;&#1080;&#1083;&#1089;&#1103;
&#1085;&#1072;&#1081;&#1090;&#1080;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; EXCEPINFO
&#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086; &#1074;
&#1079;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;&#1086;&#1095;&#1085;&#1099;&#1081;
&#1092;&#1072;&#1081;&#1083; ;)))
<p><code><!--mstheme--></font>
<pre>		<font size="2"><b>mov edx, [pIActiveScriptParse]
            	mov edx, [edx] 
            	mov eax, [pScript]
            	sub ecx, ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push eax
		push [pIActiveScriptParse]
		call dword [edx + 14h]</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1086;&#1089;&#1083;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082;&#1091;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1078;&#1077;&#1085;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081; &#1082;&#1086;&#1076;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;&#1072;, &#1085;&#1086;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;&#1089;&#1103;
&#1086;&#1085; &#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090;,
&#1076;&#1086; &#1090;&#1077;&#1093; &#1087;&#1086;&#1088;,
&#1087;&#1086;&#1082;&#1072; &#1076;&#1074;&#1080;&#1078;&#1086;&#1082;
&#1085;&#1077; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090; &#1086;&#1090;
&#1085;&#1072;&#1089;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099;. &#1069;&#1090;&#1086;
&#1086;&#1073;&#1098;&#1103;&#1089;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1090;&#1077;&#1084;, &#1095;&#1090;&#1086;
&#1076;&#1074;&#1080;&#1078;&#1086;&#1082;
&#1089;&#1077;&#1081;&#1095;&#1072;&#1089;
&#1087;&#1088;&#1077;&#1073;&#1099;&#1074;&#1072;&#1077;&#1090; &#1085;&#1077;
&#1074; &#1090;&#1086;&#1084;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1080;.
&#1042;&#1089;&#1077;&#1075;&#1086;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1081; 6,
&#1074;&#1086;&#1090; &#1086;&#1085;&#1080;:
<p><code><!--mstheme--></font>
<pre>    		SCRIPTSTATE_UNINITIALIZED
    		SCRIPTSTATE_INITIALIZED
    		SCRIPTSTATE_STARTED
   	 	SCRIPTSTATE_CONNECTED
    		SCRIPTSTATE_DISCONNECTED
    		SCRIPTSTATE_CLOSED</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1057;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1085;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1103;&#1090; &#1089;&#1072;&#1084;&#1080;
&#1079;&#1072; &#1089;&#1077;&#1073;&#1103;,
&#1086;&#1090;&#1084;&#1077;&#1095;&#1091; &#1083;&#1080;&#1096;&#1100;,
&#1095;&#1090;&#1086; &#1076;&#1083;&#1103; &#1085;&#1072;&#1089;
&#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1077;&#1077;
&#1074;&#1072;&#1078;&#1085;&#1086;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077;
SCRIPTSTATE_CONNECTED - &#1080;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1086;&#1085;&#1086; &#1079;&#1072;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;&#1089;&#1103;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1078;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;&#1089;&#1100;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1086;&#1084; SetScriptState,
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1084;
&#1076;&#1074;&#1080;&#1078;&#1082;&#1091;, &#1095;&#1090;&#1086;
&#1087;&#1086;&#1088;&#1072; &#1073;&#1099; &#1091;&#1078;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
&#1095;&#1077;&#1088;&#1090;&#1086;&#1074;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b>		mov edx, [pIActiveScript]
            	mov edx, [edx] 
		push SCRIPTSTATE_CONNECTED
		push [pIActiveScript]
	       	call dword [edx + 14h]

		mov edx, [pIActiveScriptSite]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	call dword [edx + Addref]
	        
	       	invoke VirtualFree, [pMemory], [buffer_size], MEM_DECOMMIT</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="2"><b>&#1053;&#1091; &#1074;&#1086;&#1090; &#1084;&#1099;
&#1079;&#1072;&#1089;&#1090;&#1072;&#1074;&#1080;&#1083;&#1080;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;&#1089;&#1103;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;,
&#1090;&#1077;&#1087;&#1077;&#1088;&#1100; &#1076;&#1077;&#1083;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100; &#1079;&#1072;
&#1084;&#1072;&#1083;&#1099;&#1084; -
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1072;
&#1093;&#1086;&#1088;&#1086;&#1096;&#1077;&#1075;&#1086;
&#1090;&#1086;&#1085;&#1072; &#1090;&#1088;&#1077;&#1073;&#1091;&#1102;&#1090;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1084;&#1099; &#1087;&#1086;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1087;&#1088;&#1080;&#1073;&#1088;&#1072;&#1083;&#1080; &#1079;&#1072;
&#1089;&#1086;&#1073;&#1086;&#1081; &#1074;&#1077;&#1089;&#1100;
&#1084;&#1091;&#1089;&#1086;&#1088;.
&#1044;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1077;&#1084; &#1101;&#1090;&#1086; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1075;&#1086;
&#1086;&#1082;&#1085;&#1072;.</b></font>
<p><code><!--mstheme--></font>
<pre><font size="2"><b>wmclose:		mov edx, [pIActiveScript]
            	push edx
			mov edx, [edx]
            	call dword [edx + 1Ch]	;&#1052;&#1077;&#1090;&#1086;&#1076; Close
              	
              	mov edx, [pIActiveScriptParse]
            	push edx
			mov edx, [edx]
            	call dword [edx + Release]
  				
  			mov edx, [pIActiveScript]
            	push edx
			mov edx, [edx]
			push [pIActiveScript]
            	call dword [edx + Release]
            	
  			mov edx, [pIActiveScriptSite]
            	push edx
			mov edx, [edx]
            	call dword [edx + Release]</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1072;&#1076;&#1077;&#1102;&#1089;&#1100;,
&#1082;&#1086;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080;&#1080;
&#1080;&#1079;&#1083;&#1080;&#1096;&#1085;&#1080; ;)))?
<p><strong>&#1050;&#1086;&#1076;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;</strong>
<p><code><!--mstheme--></font>
<pre><font size="2"><b>;---------------------------------------------------------------------
; RunScript.asm
;---------------------------------------------------------------------

format PE GUI 4.0
entry start

include 'RunScript.inc'

section '.scrpt' code readable executable

start:      	invoke	GetModuleHandleA, 0
		mov [hInst], eax
		
		invoke	DialogBoxParamA, eax, 1000, HWND_DESKTOP, DlgProc, 0
		
		invoke	ExitProcess, 0

            	
proc DlgProc, hwnd, msg, wparam, lparam
		enter
		cmp [msg], WM_INITDIALOG
		jz wminitdialog
		cmp [msg], WM_COMMAND
		jz wmcommand
		cmp [msg], WM_CLOSE
		jz wmclose
		sub eax, eax
		jmp finish
				
wminitdialog:	mov eax, [hwnd]
		mov [hWnd], eax
				
		invoke VirtualAlloc, 0, MAX_PATH, MEM_COMMIT, PAGE_READWRITE
		mov [szFileName], eax

		call Create_Script_Engine

		jmp processed
				
wmcommand:	cmp [wparam], BN_CLICKED shl 16 + 1001
		jnz processed
				 
		mov eax, [szFileName]
		mov ecx, 257
@@:		mov byte [eax], 0 
		inc eax
		dec ecx
		jnz @B
				
		push szFilter
		push szTitle
		push dword [hwnd]
		call GetFileName
				
		mov ecx, [szFileName]
		mov ecx, [ecx]
		jecxz processed
				
		call Get_Script
		test eax, eax
		jz processed
				
		push eax
		call Run_Script
				
		jmp processed

wmclose:	invoke VirtualFree, [szFileName], MAX_PATH, MEM_DECOMMIT
			
		mov edx, [pIActiveScript]
            	push edx
		mov edx, [edx]
            	call dword [edx + Close]
              	
              	mov edx, [pIActiveScriptParse]
            	push edx
		mov edx, [edx]
            	call dword [edx + Release]
  				
  		mov edx, [pIActiveScript]
            	push edx
		mov edx, [edx]
		push [pIActiveScript]
            	call dword [edx + Release]
            	
  		mov edx, [pIActiveScriptSite]
            	push edx
		mov edx, [edx]
            	call dword [edx + Release]
            	
            	invoke	EndDialog, [hwnd], 0
				
processed:	sub eax, eax
		inc eax
		
finish:		return
      
proc Create_Script_Engine
		enter            
            
            	invoke CoInitialize, 0
            	
            	invoke CoCreateInstance, CLSID_VBScript, 0, \
				       CLSCTX_INPROC_SERVER, IID_IActiveScript, pIActiveScript
            	test eax, eax
            	js error.create_instance
            
            	invoke LocalAlloc, LMEM_FIXED, 12
            	test eax, eax
            	jz error.alloc
            	
            	mov [ActiveScriptSiteObject], eax
            
            	mov dword [eax], pIActiveScriptSite_vtable
            	mov dword [eax + 4], pIActiveScriptSiteWindow_vtable
		mov dword [eax + 8], 1

            	mov edx, [pIActiveScript]
            	mov edx, [edx]
            	push pIActiveScriptParse
            	push IID_IActiveScriptParse
            	push [pIActiveScript]
            	call dword [edx + QueryInterface]
            	test eax, eax
            	js .ok 
            
            	mov edx, pIActiveScriptSite_vtable
		mov [pIActiveScriptSite], edx
		
.ok:        	sub eax, eax
            	return

error:


.alloc:		mov eax, E_OUTOFMEMORY
		return

.create_instance:
            
            	sub eax, eax
            	dec eax
            	return


proc Get_Script
		enter
				
		invoke CreateFileA, [szFileName], GENERIC_READ, FILE_SHARE_READ, \
		                    NULL, OPEN_EXISTING, FILE_ATTRIBUTE_ARCHIVE, NULL
		test eax, eax
		jz LoadScript.finish
				
		mov [hFile], eax
				
		invoke GetFileSize, eax, 0
		
		mov [FileSize], eax

		mov ecx, eax
		inc eax
		inc eax
		shl eax, 1
		push eax
		add eax, ecx
		mov [buffer_size], eax
		
		invoke VirtualAlloc, 0, eax, MEM_COMMIT, PAGE_READWRITE
		mov [pMemory], eax
		
		add eax, dword [FileSize]
		inc eax
		mov [pScript], eax
		
		push eax
		lea ecx, [esp] 
		invoke ReadFile, [hFile], [pMemory], [FileSize], ecx, NULL
		pop ecx
				
		invoke CloseHandle, [hFile]
				
		pop eax

		invoke MultiByteToWideChar, 0, 0, [pMemory], -1, [pScript], eax
    		
    		mov eax, [pScript]

.finish:	return
				


proc Run_Script, lpScript
				
		enter
			
		mov edx, [pIActiveScriptSite]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	call dword [edx + Addref]
            	
            	mov edx, [pIActiveScript]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	push [pIActiveScript]
            	call dword [edx + SetScriptSite]
            	
            	mov edx, [pIActiveScriptParse]
            	mov edx, [edx]
            	push [pIActiveScriptParse]
            	call dword [edx + InitNew]
            	            	
            	mov edx, [pIActiveScriptParse]
            	mov edx, [edx] 
            	mov eax, [lpScript]
            	sub ecx, ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push ecx
            	push ecx
		push eax
		push [pIActiveScriptParse]
		call dword [edx + ParseScriptText]
				
		mov edx, [pIActiveScript]
            	mov edx, [edx] 
		push SCRIPTSTATE_CONNECTED
		push [pIActiveScript]
	        call dword [edx + SetScriptState]
	        
	        mov edx, [pIActiveScriptSite]
            	mov edx, [edx]
            	push [pIActiveScriptSite]
            	call dword [edx + Addref]
	        
	       	invoke VirtualFree, [pMemory], [buffer_size], MEM_DECOMMIT

		return

proc IActiveScriptSite_GetLCID, pi, plcid        
                enter
                mov eax, E_NOTIMPL
                return


proc IActiveScriptSite_GetItemInfo, pi, pstrName, dwReturnMask, ppunkItem, ppTypeInfo
                enter
               	mov eax, TYPE_E_ELEMENTNOTFOUND
		return 


proc IActiveScriptSite_GetDocVersionString, pi, pbstrVersionString
                enter
                mov eax, E_NOTIMPL
                return                


proc IActiveScriptSite_OnScriptTerminate, pi, pvarResult, pexcepinfo
               enter
               mov eax, S_OK
               return


proc IActiveScriptSite_OnStateChange, pi, ssScriptState  
               enter
               	mov eax, S_OK
           	return


proc IActiveScriptSite_OnScriptError, pi, pase
          	enter
          
              	invoke MessageBoxA, 0, mess1, mess1_title, MB_OK + MB_ICONERROR
		mov eax, S_OK
               return
                
                
proc IActiveScriptSite_OnEnterScript, pi  
               enter
               mov eax, S_OK
             	return
                
                
proc IActiveScriptSite_OnLeaveScript, pi
               enter
               	mov eax, S_OK
           	return
                
                
proc IActiveScriptSite_AddRef, pi
               enter      
               mov ecx, [ActiveScriptSiteObject]
              	inc dword [ecx + 8]
               mov eax, [ecx + 8]
               return
                
                
proc IActiveScriptSite_Release, pi
              	enter     
               	mov ecx, [ActiveScriptSiteObject]
               dec dword [ecx + 8]
              	mov eax, [ecx + 8]
             	test eax, eax
              	jnz .ret_
               	invoke LocalFree, ecx
.ret_:        	return			


proc IActiveScriptSite_QueryInterface, pi, iid, ppvObject 
                
                enter
                
                invoke IsEqualGUID, [iid], IID_IUnknown
                test eax, eax
                jnz .s_ok
                
                invoke IsEqualGUID, [iid], IID_IActiveScriptSite
                test eax, eax
                jnz .s_ok
                
                invoke IsEqualGUID, [iid], IID_IActiveScriptSiteWindow
                test eax, eax
                jnz .S_OK_W
                
.NoInterface:   mov eax, E_NOINTERFACE
                
                return

.s_ok:          mov eax, [ActiveScriptSiteObject]
                mov eax, [eax]
                mov edx, [ppvObject]
                mov [edx], eax
                mov eax, S_OK
                
                return       
                
.S_OK_W:	mov eax, [ActiveScriptSiteObject]
               	mov eax, [eax + 4]
               mov edx, [ppvObject]
               mov [edx], eax
               mov eax, S_OK                          
		return


proc IActiveScriptSiteWindow_GetWindow, pi, phwnd
		enter
		mov ecx, [phwnd]
    		mov eax, [hWnd]
    		mov [ecx], eax
    		mov eax, S_OK       
    		return
    			
  
proc IActiveScriptSiteWindow_EnableModeless, pi, fEnable
    		enter
    		mov eax, S_OK
    		return
    			

proc GetFileName, hParent, lpTitle, lpFilter

		enter
		mov eax, [hParent]
    		mov [ofn.hwndOwner], eax
   		mov eax, [hInst]
   		mov [ofn.hInstance], eax
   		mov eax, [lpFilter]
    		mov [ofn.lpstrFilter], eax 
    		mov eax, [szFileName]
    		mov [ofn.lpstrFile], eax
    		mov [ofn.nMaxFile], MAX_PATH
    		mov eax, [lpTitle]
    		mov [ofn.lpstrTitle], eax
    		mov [ofn.Flags], OFN_EXPLORER or OFN_FILEMUSTEXIST or OFN_LONGNAMES
		
		invoke GetOpenFileName, ofn
		
		return


section '.data' data readable writeable

ofn OPENFILENAMEA

mess1 db &quot;Cant't parse it!&quot;, 0
mess1_title db 'script engine', 0

szFilter db 'VBScripts', 0, '*.vbs', 0, \ 
	    'All files (heh... you can try...)', 0, '*.*',	0, 0
		 
szTitle db 'Just open fucking file...', 0
szFileName dd 0

hInst dd 0

ActiveScriptSiteObject dd 0

hWnd dd 0
hFile dd 0
FileSize dd 0
buffer_size	dd 0
pMemory	dd 0
pScript dd 0

pIActiveScript dd 0       
pIActiveScriptParse dd 0       
pIActiveScriptSite dd 0       
    
CLSID_VBScript GUID 0b54f3741h, 5b07h, 11cfh, 0a4h, 0b0h, 0, 0aah, 0, 4ah, 55h, 0e8h                         
IID_IActiveScript GUID 0bb1a2ae1h, 0a4f9h, 11cfh, 8fh, 20h, 0, 80h, 5fh, 2ch, 0d0h, 64h  
IID_IActiveScriptParse GUID 0bb1a2ae2h, 0a4f9h, 11cfh, 8fh, 20h, 0, 80h, 5fh, 2ch, 0d0h, 64h 
IID_IActiveScriptSite GUID 0d57d7817h, 0e9b7h, 04a82h, 85h, 74h, 01h, 0d0h, 0f9h, 3dh, 61h, 70h  
IID_IActiveScriptSiteWindow GUID 0d10f6761h, 083e9h, 011cfh, 8fh, 20h, 0, 80h, 5fh, 2ch, 0d0h, 64h
IID_IUnknown GUID 0, 0, 0, 0ch, 0, 0, 0, 0, 0, 0, 46h                        

pIActiveScriptSite_vtable dd IActiveScriptSite_vtable
pIActiveScriptSiteWindow_vtable	dd IActiveScriptSiteWindow_vtable                          


IActiveScriptSite_vtable dd IActiveScriptSite_QueryInterface
                         dd IActiveScriptSite_AddRef
                         dd IActiveScriptSite_Release
                         dd IActiveScriptSite_GetLCID
                         dd IActiveScriptSite_GetItemInfo
                         dd IActiveScriptSite_GetDocVersionString
                         dd IActiveScriptSite_OnScriptTerminate
                         dd IActiveScriptSite_OnStateChange
                         dd IActiveScriptSite_OnScriptError
                         dd IActiveScriptSite_OnEnterScript
                         dd IActiveScriptSite_OnLeaveScript
                        
IActiveScriptSiteWindow_vtable	dd IActiveScriptSite_QueryInterface
                        	dd IActiveScriptSite_AddRef
                        	dd IActiveScriptSite_Release
				dd IActiveScriptSiteWindow_GetWindow
				dd IActiveScriptSiteWindow_EnableModeless                        
                           

QueryInterface 		= 	0
Addref         		= 	4
Release        		= 	8                 
Close 			= 	1ch
SetScriptSite 		= 	0ch
InitNew 		=	0ch
ParseScriptText  	= 	14h
SetScriptState 		= 	14h

section '.idata' import data readable writeable
library kernel32, 'kernel32.dll', \
	user32, 'user32.dll', \
        ole32, 'ole32.dll', \
        comdlg32, 'comdlg32.dll'
        
import kernel32, ExitProcess, 'ExitProcess', \
	  	 LocalAlloc, 'LocalAlloc', \
	         LocalFree, 'LocalFree', \
	         GetModuleHandleA, 'GetModuleHandleA', \
	         CreateFileA, 'CreateFileA', \
	         CloseHandle, 'CloseHandle', \
	         ReadFile, 'ReadFile', \
	         GetFileSize, 'GetFileSize', \
	         MultiByteToWideChar, 'MultiByteToWideChar', \
	         VirtualAlloc, 'VirtualAlloc', \
	         VirtualFree, 'VirtualFree'
	   
import ole32, CoInitialize, 'CoInitialize', \
       	      CoCreateInstance, 'CoCreateInstance', \
              CoUninitialize, 'CoUninitialize', \
              IsEqualGUID, 'IsEqualGUID'

import user32, DialogBoxParamA, 'DialogBoxParamA', \
	       EndDialog, 'EndDialog', \
	       MessageBoxA, 'MessageBoxA'
	   
import comdlg32, GetOpenFileName, 'GetOpenFileNameA'	   


section '.rsrc' resource data readable

directory RT_DIALOG, dialogs

resource dialogs, 1000, LANG_ENGLISH+SUBLANG_DEFAULT, main_dlg

  dialog main_dlg, 'RunScript', 70, 70, 70, 50, WS_CAPTION+WS_POPUP+WS_SYSMENU+DS_MODALFRAME
  dialogitem 'BUTTON', 'Execute Script!', 1001, 8, 15, 55, 15, WS_VISIBLE+WS_TABSTOP+BS_PUSHBUTTON
  
enddialog


;---------------------------------------------------------------------
; RunScript.inc
;---------------------------------------------------------------------

include 'include\win32ax.inc'

CLSCTX_INPROC_SERVER			equ 1
CLSCTX_INPROC_HANDLER			equ 2
CLSCTX_LOCAL_SERVER		    	equ 4
CLSCTX_INPROC_SERVER16			equ 8
CLSCTX_REMOTE_SERVER			equ 10h
CLSCTX_INPROC_HANDLER16		equ 20h
CLSCTX_INPROC_SERVERX86		equ 40h
CLSCTX_INPROC_HANDLERX86		equ 80h
CLSCTX_ESERVER_HANDLER			equ 100h

E_NOTIMPL				equ 80004001h
E_NOINTERFACE               		equ 80004002h

TYPE_E_ELEMENTNOTFOUND     		equ 8002802Bh


S_OK                        		equ 0

LMEM_FIXED                  		equ 0h

E_OUTOFMEMORY               		equ 8007000Eh

SCRIPTSTATE_UNINITIALIZED 		equ 0h
SCRIPTSTATE_STARTED       		equ 1h
SCRIPTSTATE_CONNECTED       		equ 2h
SCRIPTSTATE_DISCONNECTED  		equ 3h
SCRIPTSTATE_CLOSED        		equ 4h
SCRIPTSTATE_INITIALIZED   		equ 5h


struc GUID dd1, dw1, dw2, db1, db2, db3, db4, db5, db6, db7, db8
{
.dd1 dd dd1
.dw1 dw dw1
.dw2 dw dw2
.db1 db db1
.db2 db db2
.db3 db db3
.db4 db db4
.db5 db db5
.db6 db db6
.db7 db db7
.db8 db db8
}

MAX_PATH equ 260

struc OPENFILENAMEA
{
.lStructSize 		dd 4ch
.hwndOwner         	dd 0
.hInstance         	dd 0
.lpstrFilter       	dd 0
.lpstrCustomFilter 	dd 0
.nMaxCustFilter    	dd 0
.nFilterIndex      	dd 0
.lpstrFile         	dd 0
.nMaxFile          	dd 0
.lpstrFileTitle    	dd 0
.nMaxFileTitle     	dd 0
.lpstrInitialDir   	dd 0
.lpstrTitle        	dd 0
.Flags             	dd 0
.nFileOffset       	dw 0
.nFileExtension    	dw 0
.lpstrDefExt       	dd 0
.lCustData         	dd 0
.lpfnHook          	dd 0
.lpTemplateName    	dd 0
}
struct OPENFILENAMEA</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1072; &#1089;&#1077;&#1075;&#1086;&#1076;&#1085;&#1103;
&#1074;&#1089;&#1077; :).
<p><a href="http://www.wasm.ru/pub/15/files/runscript.zip">&#1060;&#1072;&#1081;&#1083;</a>
&#1082; &#1089;&#1090;&#1072;&#1090;&#1100;&#1077;.
<p>&nbsp; [C] Hangatyr</p>
<!--mstheme--></font>

</body>

</html>
