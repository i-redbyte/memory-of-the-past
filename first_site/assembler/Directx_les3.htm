<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>New Page 1</title>
<meta name="Microsoft Theme" content="zero 011">
</head>

<body background="../zertxtr.gif" bgcolor="#000000" text="#FFFFFF" link="#6699CC" vlink="#669966" alink="#999999">

<!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font>
<h3 align="center"><!--mstheme--><font face="Arial, Arial, Helvetica" color="#CCCCCC"><font size="5" color="#00FF00">DirectX
8.1 &#1074; MASM32: &#1059;&#1088;&#1086;&#1082; 3</font><!--mstheme--></font></h3>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p><strong><font size="3">&#1059;&#1088;&#1086;&#1082; 3.
&#1057;&#1086;&#1079;&#1076;&#1072;&#1077;&#1084;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086; &#1076;&#1083;&#1103;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1089;&#1077;&#1093;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;.</font></strong>
<p><font size="3">&#1050;&#1072;&#1082;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;
&#1074;&#1089;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099; &#1080; &#1087;&#1088;&#1080;
&#1101;&#1090;&#1086;&#1084; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;
&#1090;&#1072;&#1082;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1089;&#1084;&#1086;&#1075;
&#1074;&#1099;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100; &#1074;
&#1082;&#1072;&#1082;&#1086;&#1084; &#1088;&#1077;&#1078;&#1080;&#1084;&#1077;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1102; ? &#1042;
&#1101;&#1090;&#1086;&#1084; &#1085;&#1072;&#1084;
&#1087;&#1086;&#1084;&#1086;&#1078;&#1077;&#1090;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086;.</font>
<p><font size="3">&#1045;&#1089;&#1083;&#1080; &#1074;&#1099;
&#1091;&#1078;&#1077; &#1079;&#1085;&#1072;&#1077;&#1090;&#1077;,
&#1095;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086; &#1080;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;&#1077;,
&#1082;&#1072;&#1082; &#1086;&#1085;&#1086;
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1080;&#1090;, &#1082;&#1072;&#1082;
&#1077;&#1075;&#1086; &#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1080;
&#1082;&#1072;&#1082; &#1089; &#1085;&#1080;&#1084;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100;, &#1090;&#1086;
&#1074;&#1089;&#1077; &#1088;&#1072;&#1074;&#1085;&#1086;
&#1089;&#1086;&#1074;&#1077;&#1090;&#1091;&#1102; &#1074;&#1072;&#1084;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1101;&#1090;&#1091;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1102;. &#1058;&#1077;&#1084; &#1078;&#1077;,
&#1082;&#1090;&#1086; &#1087;&#1083;&#1086;&#1093;&#1086;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;, &#1095;&#1090;&#1086;
&#1101;&#1090;&#1086; &#1079;&#1072; &#1079;&#1074;&#1077;&#1088;&#1100;
&#1090;&#1072;&#1082;&#1086;&#1081;,
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1080; &#1085;&#1072; &#1101;&#1090;&#1091;
&#1090;&#1077;&#1084;&#1091;.</font>
<p><font size="3">&#1043;&#1086;&#1090;&#1086;&#1074;&#1099; ?
&#1058;&#1086;&#1075;&#1076;&#1072; &#1074;&#1087;&#1077;&#1088;&#1077;&#1076; !</font>
<p><font size="3">&#1044;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086; &#1074; &#1085;&#1072;&#1096;&#1077;&#1084;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1080;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1076;&#1074;&#1091;&#1084;&#1103; &#1087;&#1091;&#1090;&#1103;&#1084;&#1080;.
&#1055;&#1077;&#1088;&#1074;&#1099;&#1081; &#1087;&#1091;&#1090;&#1100; -
&#1101;&#1090;&#1086; &#1074;&#1089;&#1090;&#1088;&#1086;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086; &#1074; &#1089;&#1072;&#1084;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;.
&#1042;&#1090;&#1086;&#1088;&#1086;&#1081; &#1087;&#1091;&#1090;&#1100; -
&#1101;&#1090;&#1086;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1077;&#1075;&#1086; &#1082;&#1072;&#1082;
&#1089;&#1072;&#1084;&#1086;&#1089;&#1090;&#1086;&#1103;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;.
&#1063;&#1090;&#1086; &#1074;&#1099;&#1073;&#1088;&#1072;&#1090;&#1100; ?
&#1054;&#1073;&#1072; &#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1072;
&#1080;&#1084;&#1077;&#1102;&#1090; &#1089;&#1074;&#1086;&#1080;
&#1087;&#1083;&#1102;&#1089;&#1099; &#1080;
&#1084;&#1080;&#1085;&#1091;&#1089;&#1099;.</font>
<p><font size="3">&#1057;&#1088;&#1077;&#1076;&#1080;
&#1087;&#1083;&#1102;&#1089;&#1086;&#1074;
&#1087;&#1077;&#1088;&#1074;&#1086;&#1075;&#1086;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1072; &#1090;&#1086;,
&#1095;&#1090;&#1086; &#1086;&#1085;&#1086;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103;
&#1074;&#1085;&#1091;&#1090;&#1088;&#1080;
&#1085;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;.
&#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084; &#1085;&#1072;&#1084;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1090;&#1072;&#1082;&#1086;&#1081; &#1091;&#1078;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1081;
&#1086;&#1073;&#1100;&#1077;&#1084; &#1082;&#1086;&#1076;&#1072;.
&#1058;&#1072;&#1082;&#1078;&#1077; &#1074;&#1089;&#1077;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080;,
&#1074;&#1099;&#1073;&#1088;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1084;,
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;
&#1085;&#1077;&#1084;&#1077;&#1076;&#1083;&#1077;&#1085;&#1085;&#1086;.
&#1057;&#1088;&#1077;&#1076;&#1080;
&#1084;&#1080;&#1085;&#1091;&#1089;&#1086;&#1074; &#1090;&#1086;,
&#1095;&#1090;&#1086; &#1087;&#1088;&#1080;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1084;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1102;
&#1087;&#1088;&#1080;&#1093;&#1086;&#1076;&#1080;&#1090;&#1100;&#1089;&#1103;
&#1074;&#1099;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080;.</font>
<p><font size="3">&#1056;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1074;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1072;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1089;&#1083;&#1086;&#1078;&#1085;&#1077;&#1077;.
&#1053;&#1091;&#1078;&#1085;&#1086;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1074;&#1072;&#1090;&#1100;
&#1076;&#1074;&#1072;
&#1101;&#1082;&#1079;&#1077;&#1096;&#1085;&#1080;&#1082;&#1072;.
&#1054;&#1076;&#1080;&#1085; &#1076;&#1083;&#1103;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1075;&#1086;
&#1086;&#1082;&#1085;&#1072;, &#1076;&#1088;&#1091;&#1075;&#1086;&#1081; -
&#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;
&#1076;&#1083;&#1103;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;.
&#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084; &#1074;&#1089;&#1077;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080;,
&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1084;,
&#1087;&#1088;&#1080;&#1076;&#1077;&#1090;&#1089;&#1103;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1090;&#1100; &#1074;
&#1092;&#1072;&#1081;&#1083;. &#1053;&#1086; &#1079;&#1072;&#1090;&#1086;
&#1087;&#1086;&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1077;&#1083;&#1099;&#1074;&#1072;&#1090;&#1100;
Setup &#1089;&#1085;&#1086;&#1074;&#1072; &#1080;
&#1089;&#1085;&#1086;&#1074;&#1072;, &#1085;&#1077;
&#1090;&#1088;&#1086;&#1075;&#1072;&#1103; &#1087;&#1088;&#1080;
&#1101;&#1090;&#1086;&#1084;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;,
&#1074;&#1077;&#1076;&#1100; &#1074;&#1089;&#1105;
&#1088;&#1072;&#1074;&#1085;&#1086; &#1074;&#1089;&#1077;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080;
&#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1102;&#1090;&#1089;&#1103;
&#1074; &#1092;&#1072;&#1081;&#1083;&#1077;.</font>
<p><font size="3">&#1042; &#1080;&#1090;&#1086;&#1075;&#1077;
&#1082;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;
&#1087;&#1086;&#1076;&#1093;&#1086;&#1076;&#1080;&#1090; &#1076;&#1083;&#1103;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1093;
&#1079;&#1072;&#1076;&#1072;&#1095;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1076;&#1083;&#1103;
&#1082;&#1072;&#1082;&#1086;&#1081; - &#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1076;&#1077;&#1084;&#1082;&#1080;
&#1074;&#1089;&#1090;&#1088;&#1086;&#1077;&#1085;&#1085;&#1086;&#1077;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086; &#1089;&#1072;&#1084;&#1086;&#1077; &#1090;&#1086;.
&#1040; &#1074;&#1086;&#1090; &#1076;&#1083;&#1103;
&#1080;&#1075;&#1088;&#1091;&#1096;&#1082;&#1080; -
&#1085;&#1072;&#1086;&#1073;&#1086;&#1088;&#1086;&#1090;.
&#1052;&#1086;&#1078;&#1085;&#1086; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1087;&#1088;&#1080;&#1076;&#1091;&#1084;&#1072;&#1090;&#1100;
&#1082;&#1072;&#1082;&#1086;&#1081; &#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1075;&#1080;&#1073;&#1088;&#1080;&#1076;. &#1071;
&#1076;&#1086;&#1083;&#1075;&#1086;
&#1088;&#1072;&#1079;&#1084;&#1099;&#1096;&#1083;&#1103;&#1083;
&#1082;&#1072;&#1082;&#1086;&#1081;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1076;&#1083;&#1103; &#1091;&#1088;&#1086;&#1082;&#1072; &#1080; &#1074;
&#1082;&#1086;&#1085;&#1094;&#1077; &#1082;&#1086;&#1085;&#1094;&#1086;&#1074;
&#1088;&#1077;&#1096;&#1080;&#1083;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1086;&#1073;&#1072;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1091; &#1074;&#1072;&#1089;
&#1073;&#1099;&#1083;&#1072;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1080;&#1090;&#1100;. &#1069;&#1090;&#1086;
&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1086;&#1074;&#1072;&#1083;&#1086;
&#1076;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1084;&#1085;&#1086;&#1075;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080;, &#1080; &#1082;&#1072;&#1082;
&#1089;&#1083;&#1077;&#1076;&#1089;&#1090;&#1074;&#1080;&#1077;,
&#1091;&#1088;&#1086;&#1082; &#1073;&#1099;&#1083;
&#1075;&#1086;&#1090;&#1086;&#1074;
&#1075;&#1086;&#1088;&#1072;&#1079;&#1076;&#1086;
&#1087;&#1086;&#1079;&#1078;&#1077;, &#1095;&#1077;&#1084;
&#1073;&#1099;&#1083;&#1086;
&#1079;&#1072;&#1087;&#1083;&#1072;&#1085;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1086;.
&#1052;&#1099; &#1089; &#1074;&#1072;&#1084;&#1080;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1074;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;, &#1090;&#1072;&#1082;
&#1082;&#1072;&#1082; &#1086;&#1085;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1089;&#1083;&#1086;&#1078;&#1085;&#1077;&#1077;.</font>
<p><font size="3">&#1055;&#1086; &#1087;&#1083;&#1072;&#1085;&#1091;
&#1085;&#1072;&#1084;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;:
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;
&#1074;&#1089;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1077;
&#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;
&#1074;&#1089;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1083;&#1086;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099;,
&#1079;&#1072;&#1087;&#1080;&#1093;&#1072;&#1090;&#1100; &#1074;&#1089;&#1102;
&#1101;&#1090;&#1091;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1074;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1077;
&#1086;&#1082;&#1085;&#1086;, &#1074;&#1099;&#1074;&#1077;&#1089;&#1090;&#1080;
&#1077;&#1075;&#1086; &#1085;&#1072; &#1101;&#1082;&#1088;&#1072;&#1085;,
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100;
&#1074;&#1089;&#1077; &#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1080; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1077; &#1080; &#1087;&#1088;&#1080;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1077; &#1080;&#1079; Setup
&#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1089;&#1072;&#1084;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1077;&#1089;&#1083;&#1080;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;.
&#1042;&#1088;&#1086;&#1076;&#1077; &#1073;&#1099;
&#1094;&#1077;&#1083;&#1072;&#1103; &#1082;&#1091;&#1095;&#1072;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;, &#1085;&#1086; &#1085;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1084; &#1076;&#1077;&#1083;&#1077;
&#1074;&#1089;&#1077; &#1075;&#1086;&#1088;&#1072;&#1079;&#1076;&#1086;
&#1087;&#1088;&#1086;&#1097;&#1077;.</font>
<p><font size="3">&#1053;&#1072;&#1095;&#1085;&#1077;&#1084; &#1089;
&#1092;&#1072;&#1081;&#1083;&#1072;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1086;&#1074;.
&#1041;&#1077;&#1088;&#1077;&#1084; &#1083;&#1102;&#1073;&#1086;&#1081;
&#1088;&#1077;&#1076;&#1072;&#1082;&#1090;&#1086;&#1088;,
&#1087;&#1072;&#1088;&#1072; &#1084;&#1080;&#1085;&#1091;&#1090; &#1080;
&#1074;&#1089;&#1077; &#1075;&#1086;&#1090;&#1086;&#1074;&#1086;.
&#1050;&#1088;&#1072;&#1090;&#1082;&#1086;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1087;&#1086; &#1095;&#1072;&#1089;&#1090;&#1103;&#1084;, &#1082;&#1072;&#1082;
&#1086;&#1085; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1077;&#1090;&#1100;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">#define DS_CENTER            0x00000800L
#define DS_MODALFRAME        0x00000080L
#define WS_EX_TOOLWINDOW     0x00000080L
#define WS_GROUP             0x00020000L
#define WS_EX_STATICEDGE     0x00020000L
#define BS_AUTORADIOBUTTON   0x00000009L
#define BS_FLAT              0x00008000L
#define CBS_DROPDOWNLIST     0x00000003L
#define WS_VSCROLL           0x00200000L
#define WS_TABSTOP           0x00010000L
#define WS_DISABLED          0x08000000L

#define ID_OK                10
#define ID_CANCEL            11
#define ID_SAVE              12

#define IDC_STATIC           -1

#define IDC_WINDOWED         20
#define IDC_FULLSCREEN       21
#define IDC_SCREENMODESFS    22
#define IDC_SCREENMODESW     23
#define IDC_HERZ             24</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1047;&#1076;&#1077;&#1089;&#1100; &#1091;
&#1085;&#1072;&#1089;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1099;, &#1074;
&#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1089;&#1090;&#1080;,
&#1085;&#1086;&#1084;&#1077;&#1088;&#1072; &#1086;&#1090; 10 &#1076;&#1086; 24 -
&#1101;&#1090;&#1086;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1099;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;
&#1085;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1075;&#1086;
&#1086;&#1082;&#1085;&#1072;. &#1054;&#1085;&#1080;
&#1073;&#1091;&#1076;&#1091;&#1090; &#1085;&#1072;&#1084;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1074; &#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103;&#1093;
&#1086;&#1090; Windows, &#1090;&#1072;&#1082; &#1084;&#1099;
&#1089;&#1084;&#1086;&#1078;&#1077;&#1084;
&#1091;&#1079;&#1085;&#1072;&#1090;&#1100; &#1089;
&#1082;&#1072;&#1082;&#1080;&#1084;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1084; &#1074;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">SetupDialog  DIALOG LOADONCALL MOVEABLE DISCARDABLE 0, 0, 175, 91
             STYLE DS_MODALFRAME | DS_CENTER
             EXSTYLE WS_EX_TOOLWINDOW
             CAPTION &quot; &#1053;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1072; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1074; &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&quot;
             FONT 8, &quot;Verdana&quot;</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1047;&#1076;&#1077;&#1089;&#1100; &#1080;&#1084;&#1103;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1072;, &#1077;&#1075;&#1086;
&#1074;&#1080;&#1076; &#1080; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;,
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
&#1074;&#1099;&#1074;&#1086;&#1076;&#1072; &#1085;&#1072;
&#1101;&#1082;&#1088;&#1072;&#1085;, &#1090;&#1077;&#1082;&#1089;&#1090;
&#1079;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;&#1082;&#1072; &#1080;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1099;&#1081;
&#1096;&#1088;&#1080;&#1092;&#1090;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">BEGIN
CONTROL &quot;&#1042; &#1086;&#1082;&#1086;&#1096;&#1082;&#1077;&quot;,IDC_WINDOWED,&quot;Button&quot;,BS_AUTORADIOBUTTON | BS_FLAT | WS_TABSTOP ,12,14,80,14

COMBOBOX IDC_SCREENMODESW,92,14,71,50,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP

CONTROL &quot;&#1055;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1086;&#1077;&quot;,IDC_FULLSCREEN,&quot;Button&quot;,BS_AUTORADIOBUTTON | BS_FLAT | WS_TABSTOP,12,30,80,12

COMBOBOX IDC_SCREENMODESFS,12,43,71,120,CBS_DROPDOWNLIST | WS_VSCROLL | WS_DISABLED | WS_TABSTOP

LTEXT &quot;&#1063;&#1072;&#1089;&#1090;&#1086;&#1090;&#1072; &#1074; &#1075;&#1077;&#1088;&#1094;&#1072;&#1093;&quot;,IDC_STATIC,94,33,65,10

COMBOBOX  IDC_HERZ, 92, 43, 71, 80, CBS_DROPDOWNLIST | WS_VSCROLL | WS_DISABLED | WS_TABSTOP

GROUPBOX  &quot;&quot;,  IDC_STATIC, 6,3,163,61

DEFPUSHBUTTON &quot;&#1047;&#1072;&#1087;&#1091;&#1089;&#1082;&quot;, ID_OK,118,69,51,17,0,WS_EX_STATICEDGE
PUSHBUTTON  &quot;&#1042;&#1099;&#1093;&#1086;&#1076;&quot;, ID_CANCEL,62,69,51,17,0,WS_EX_STATICEDGE
PUSHBUTTON  &quot;&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;&quot;, ID_SAVE,6,69,51,17,0,WS_EX_STATICEDGE

END</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1052;&#1077;&#1078;&#1076;&#1091;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080; BEGIN &#1080; END
&#1088;&#1072;&#1089;&#1087;&#1086;&#1083;&#1072;&#1075;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;,
&#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1102;&#1097;&#1080;&#1077;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1099;
&#1088;&#1072;&#1089;&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1085;&#1072;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1086;&#1074;&#1086;&#1084;
&#1086;&#1082;&#1085;&#1077;. &#1047;&#1076;&#1077;&#1089;&#1100;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099;
&#1076;&#1074;&#1072; RadioButton, &#1090;&#1088;&#1080; ComboBox,
&#1086;&#1076;&#1085;&#1086;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074;&#1086;&#1077;
&#1087;&#1086;&#1083;&#1077;, &#1086;&#1076;&#1085;&#1072;
&#1088;&#1072;&#1084;&#1082;&#1072; &#1080; &#1090;&#1088;&#1080;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1099;&#1093;
&#1082;&#1085;&#1086;&#1087;&#1082;&#1080;.</font>
<p><font size="3">&#1040; &#1074;&#1086;&#1090; &#1080;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081;
&#1090;&#1077;&#1082;&#1089;&#1090; Setup.exe:</font>
<p><code><!--mstheme--></font>
<pre><font size="3"> .686
 .MMX
 .XMM	
 .MODEL FLAT, STDCALL 	
  OPTION CASEMAP:none	
					
 INCLUDE  \masm32\include\windows.inc		 
 INCLUDE  \masm32\include\kernel32.inc   	
 INCLUDE  \masm32\include\user32.inc	
 INCLUDE  \masm32\include\gdi32.inc		
 INCLUDE  \masm32\include\shell32.inc		
 INCLUDE  \masm32\DirectX81\d3d8.inc		

 INCLUDELIB  \masm32\lib\kernel32.lib
 INCLUDELIB  \masm32\lib\user32.lib
 INCLUDELIB  \masm32\lib\gdi32.lib
 INCLUDELIB  \masm32\lib\shell32.lib    
 INCLUDELIB  \masm32\directx81\d3d8.lib	  	

 SetupDialog  PROTO :DWORD,:DWORD,:DWORD,:DWORD
 DW2A         PROTO :DWORD, :DWORD
        
 .DATA ;------------------------------------------

  szDialogName  db  &quot;SetupDialog&quot;,0
  szAppName     db  &quot;Tutorial03.exe&quot;,0
  szFileName    db  &quot;Settings.ini&quot;,0
  szOperation   db  &quot;open&quot;,0
    
  WinModeTable    dw  320,240, 640,480, 800,600, 1024,768, 1280,1024, 1600,1200 	
  WinModeStrTable	dd  OFFSET szMode1 , OFFSET szMode2
                  dd  OFFSET szMode3 , OFFSET szMode4
			dd  OFFSET szMode5 , OFFSET szMode6

  szMode1         db  &quot;320x240&quot;,0
  szMode2         db  &quot;640x480&quot;,0   
  szMode3         db  &quot;800x600&quot;,0
  szMode4         db  &quot;1024x768&quot;,0
  szMode5         db  &quot;1280x1024&quot;,0
  szMode6         db  &quot;1600x1200&quot;,0  			
   
 .DATA? ;-----------------------------------------
    
  pd3d     dd  ?                      ; &#1059;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072; Direct3D			    
  d3ddm    D3DDISPLAYMODE &lt;?&gt;         ; &#1044;&#1083;&#1103; &#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080; &#1086; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;&#1093;
  d3dpp    D3DPRESENT_PARAMETERS &lt;?&gt;  ; &#1057;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072; &#1076;&#1083;&#1103; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1103; Direct3DDevice8
  WinStyle dd  ?				

  CmbWindow      dd  ?                ; ID ComboBox &#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
  cmbFullScreen  dd  ?                ; ID ComboBox &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
  cmbHerz        dd  ?                ; ID ComboBox &#1075;&#1077;&#1088;&#1094;
        
  FullModeTable     dd	50 dup (?)    ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
  FullModeBPPTable  db	50 dup (?)	  ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1086;&#1074; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;. 
  FullModeHerzTable db	50 dup (?)    ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1099; &#1074; &#1043;&#1077;&#1088;&#1094;&#1072;&#1093;.
  FullModeStrBuffer db	16 dup (?)    ; &#1041;&#1091;&#1092;&#1077;&#1088; &#1076;&#1083;&#1103; &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; 

  AppPath   db  260 dup (?)           ; &#1041;&#1091;&#1092;&#1077;&#1088; &#1076;&#1083;&#1103; &#1087;&#1091;&#1090;&#1080; &#1082; Setup.exe
  hfile     dd  ?
  brr       dd  ?
        
 .CODE ;------------------------------------------

 Start:  											
    
  Invoke  DialogBoxParam,400000h,ADDR szDialogName,NULL,OFFSET SetupDialog,NULL
  Invoke  ExitProcess,0

  Ret

 SetupDialog proc hDlg:HWND , iMsg:DWORD , wParam:WPARAM , lParam:LPARAM
 ;----------------------------------------------------------------------
  mov  eax, iMsg   

  cmp  eax, WM_INITDIALOG  ; &#1054;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1103; &#1101;&#1090;&#1086; &#1089;&#1086;&#1086;&#1073;&#1097;. &#1085;&#1072;&#1076;&#1086; &#1054;&#1041;&#1071;&#1047;&#1040;&#1058;&#1045;&#1051;&#1068;&#1053;&#1054; &#1074;&#1077;&#1088;&#1085;&#1091;&#1090;&#1100; EAX=1 
  je   wmInitDialog        

  cmp  eax, WM_COMMAND
  je   wmCommandDialog 
          
  xor  eax, eax
  ret
    
 wmInitDialog:
 ;--------------

  pushad

  invoke  CheckRadioButton, hDlg , 20 , 21 , 20  
  invoke  GetDlgItem, hDlg , 23 				
  mov     cmbWindow,  eax
  invoke  GetDlgItem, hDlg , 22
  mov     cmbFullScreen,  eax
  invoke  GetDlgItem, hDlg , 24
  mov     cmbHerz,  eax  
   
  invoke  Direct3DCreate8, D3D_SDK_VERSION	
  mov     pd3d, eax
  
  d3d8    GetAdapterDisplayMode, pd3d, D3DADAPTER_DEFAULT, ADDR d3dpp
   
  lea     esi, d3dpp.BackBufferWidth
  mov     eax, [esi]			
  add     eax, [esi+4]				
  mov     ebx, [esi+12] 
  mov     [esi+8], ebx
  mov     DWORD PTR [esi+12], 3
  xor     ebx, ebx   

 ; &#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1082;&#1072; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072;

  getNextMode:
  push    ebx
  push    eax
  invoke  SendMessage,cmbWindow,CB_ADDSTRING,0,[WinModeStrTable + ebx*4]
  pop     eax
  pop     ebx
  movzx   ecx, [WinModeTable+ebx*4]
  movzx   edx, [WinModeTable+ebx*4+2]
  add     ecx, edx   
  inc     ebx
  cmp     eax, ecx
  ja      getNextMode				
   
 ; &#1042; &#1080;&#1090;&#1086;&#1075;&#1077; &#1074; ComboBox &#1079;&#1072;&#1085;&#1077;&#1089;&#1077;&#1085;&#1099; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1085;&#1072;&#1084; &#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
 ; &#1086;&#1090; &#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1076;&#1086; &#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1093; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1074; &#1101;&#1082;&#1088;&#1072;&#1085;&#1072; &#1074;&#1082;&#1083;&#1102;&#1095;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
   
 ; &#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1082;&#1072; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072; 				   	
  d3d8    GetAdapterModeCount, pd3d, D3DADAPTER_DEFAULT
  dec     eax

  lea     esi, FullModeTable
  xor	    ebx, ebx   
  mov	    edx, ebx
  mov	    ecx, eax         
   
  getMode:		
  push    ecx
   
  push    esi
  push    ebx
  push    edx
   
  d3d8    EnumAdapterModes, pd3d, D3DADAPTER_DEFAULT, ecx, ADDR d3ddm
  mov     eax, d3ddm.Width1							
  mov     ecx, d3ddm.Height
  mov     edi, eax
  add     edi, ecx
  add     edi, d3ddm.Format
   
  pop     edx
  pop     ebx
  pop     esi   
   
  cmp     edx, edi
  je      noAdd   
  mov     edx, d3ddm.RefreshRate
  mov     BYTE PTR [FullModeHerzTable+ebx], dl
  mov     edx, d3ddm.Format
  mov     [FullModeBPPTable+ebx], dl 
  push    edx
  push    edi
  pop	    edx
  pop	    edi
   
  mov	    [esi+ebx*4], eax
  mov	    [esi+ebx*4+2], ecx
  inc	    ebx   
   
  push    ebx       
  push    esi
  push    edx
   
 ; &#1060;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077; &#1077;&#1077; &#1074; Combobox

  invoke  DW2A, eax, ADDR FullModeStrBuffer
  mov     BYTE PTR [ebx], 'x'
  inc	    ebx
  invoke  DW2A, ecx, ebx
  mov     BYTE PTR [ebx], 'x'
  inc     ebx
  mov     ecx, 16

  cmp     edi, D3DFMT_X8R8G8B8
  jne     nextFormat
  mov     ecx, 32

  nextFormat:   
  cmp     edi, D3DFMT_A8R8G8B8
  jne     nextFormat2
  mov     ecx, 32

  nextFormat2:
  cmp     edi, D3DFMT_R8G8B8
  jne     exitCompare		
  mov     ecx, 24

  exitCompare:
  invoke  DW2A, ecx , ebx
  mov     BYTE PTR [ebx], 0       	
  invoke  SendMessage, cmbFullScreen , CB_ADDSTRING , 0 , ADDR FullModeStrBuffer	
   	   
  pop     edx
  pop     esi
  pop     ebx  	
     
  noAdd:   	
  pop     ecx
  dec     ecx
  test    ecx, ecx
  jne     getMode
   
 ; &#1042; &#1080;&#1090;&#1086;&#1075;&#1077; &#1074; ComboBox &#1079;&#1072;&#1085;&#1077;&#1089;&#1077;&#1085;&#1099; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1085;&#1072;&#1084; &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
 ; &#1089; &#1088;&#1072;&#1079;&#1085;&#1099;&#1084;&#1080; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072;&#1084;&#1080; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080; &#1080; &#1089;&#1072;&#1084;&#1099;&#1084; &#1074;&#1099;&#1089;&#1086;&#1082;&#1080;&#1084; &#1095;&#1080;&#1089;&#1083;&#1086;&#1084; &#1043;&#1077;&#1088;&#1094; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
                  
  invoke  SendMessage, cmbWindow , CB_SETCURSEL , 0 , 0
  invoke  SendMessage, cmbFullScreen , CB_SETCURSEL , 0 , 0
  invoke  SendMessage, hDlg, WM_COMMAND , 22 + CBN_SELCHANGE shl 16, 0
  popad
  
  xor     eax, eax
  inc     eax
  ret     

  wmCommandDialog:
 ;----------------
  movzx  eax, WORD PTR wParam ; &#1047;&#1076;&#1077;&#1089;&#1100; &#1085;&#1072;&#1084; &#1085;&#1091;&#1078;&#1085;&#1086; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100; HIWORD &#1080; LOWORD &#1080;&#1079; wParam
  mov    ecx, wParam          ; HIWORD - &#1082;&#1086;&#1076; &#1091;&#1074;&#1077;&#1076;&#1086;&#1084;&#1083;&#1077;&#1085;&#1080;&#1103; &#1086;&#1090; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072; &#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1072;
                              ; LOWORD - ID &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072; &#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1072;
  xor    ebx, ebx
  
  cmp    eax, 10              ; &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1078;&#1072;&#1083;&#1080; &#1082;&#1085;&#1086;&#1087;&#1082;&#1091; &#1047;&#1072;&#1087;&#1091;&#1089;&#1082;
  je   cmStartProgram
  
  cmp    eax, 12              ; &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1078;&#1072;&#1083;&#1080; &#1082;&#1085;&#1086;&#1087;&#1082;&#1091; &#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
  je   cmSaveData
   
  cmp    eax, 11              ; &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1078;&#1072;&#1083;&#1080; &#1082;&#1085;&#1086;&#1087;&#1082;&#1091; &#1047;&#1072;&#1082;&#1088;&#1099;&#1090;&#1100;
  je   cmCloseProgram
  
  cmp	   eax, 20              ; &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1078;&#1072;&#1083;&#1080; RadioButton &quot;&#1042; &#1086;&#1082;&#1086;&#1096;&#1082;&#1077;&quot;
  je   cmRadioWin
   
  cmp    eax, 21              ; &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1078;&#1072;&#1083;&#1080; RadioButton &quot;&#1055;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1086;&#1077;&quot;
  je   cmRadioFull
   
  cmp    ecx, 22 + CBN_SELCHANGE shl 16
  je   cmHerz				
  
  xor    eax, eax
  ret   
                    
    cmRadioFull:

    inc     ebx
   
    cmRadioWin:
 
    invoke  EnableWindow, cmbFullScreen , ebx		
    invoke  EnableWindow, cmbHerz , ebx     
    xor     ebx, 1
    invoke  EnableWindow, cmbWindow , ebx  

    xor     eax, eax
    ret       
           
    cmHerz:
 
    invoke  SendMessage, cmbHerz , CB_RESETCONTENT , 0 , 0           	
    invoke  SendMessage, cmbFullScreen , CB_GETCURSEL , 0 , 0
    movzx   ebx, BYTE PTR [FullModeHerzTable+eax]
    invoke  DW2A, ebx , ADDR FullModeStrBuffer
    invoke  SendMessage, cmbHerz , CB_ADDSTRING , 0 , ADDR FullModeStrBuffer
    invoke  SendMessage, cmbHerz , CB_SETCURSEL , 0 , 0

    xor     eax, eax
    ret 
           
    cmSaveData:

    invoke  IsDlgButtonChecked, hDlg , 20
    test    eax, eax			
    je      EnableFull                   
    
    invoke  SendMessage, cmbWindow , CB_GETCURSEL , 0 , 0
    lea     esi, WinModeTable
    shl     eax, 2
    add     esi, eax		
    xor     ecx, ecx
    mov     edx, ecx
    push    [esi]   		
    pop     cx							
    pop     dx 		
    mov     d3dpp.BackBufferWidth, ecx
    mov     d3dpp.BackBufferHeight, edx		
    mov     d3dpp.Windowed, 1 
    mov     WinStyle, WS_SYSMENU
    jmp     Create

    EnableFull:

    invoke  SendMessage, cmbFullScreen , CB_GETCURSEL , 0 , 0
    movzx   ebx, BYTE PTR [FullModeHerzTable+eax]
    mov     d3dpp.FullScreen_RefreshRateInHz, ebx
    movzx   ebx, BYTE PTR [FullModeBPPTable+eax]
    mov     d3dpp.BackBufferFormat, ebx

    lea     esi, FullModeTable
    shl     eax, 2
    add     esi, eax
    push    [esi] 		
    xor     ecx, ecx
    mov     edx, ecx
    mov     d3dpp.Windowed, ecx
    pop     cx
    pop     dx
    mov     d3dpp.BackBufferWidth, ecx
    mov     d3dpp.BackBufferHeight, edx
    mov     WinStyle, WS_POPUP
    
    Create:

    mov     d3dpp.SwapEffect, D3DSWAPEFFECT_FLIP

    invoke  CreateFile , ADDR szFileName , GENERIC_WRITE, NULL, \
            NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL
    mov     hfile, eax

    invoke  WriteFile , hfile , ADDR d3dpp , 56 , ADDR brr , NULL
    invoke  CloseHandle , hfile  

    xor     eax, eax
    ret
   		
    cmStartProgram:   

    invoke  EndDialog, hDlg , 0			
    d3d8    Release, pd3d

    invoke  GetModuleFileName , 0 , ADDR AppPath , 260

    lea     edi,AppPath
    lea     edi,[edi+eax-6]              
    @@:
    mov     al,[edi]                     
    dec     edi                          
    cmp     al,'\'                      
    jne     @B
    inc     edi
    inc     edi
    cld
    lea     esi, szAppName
    mov     ecx, SIZEOF szAppName
    shr     ecx, 2
    rep     movsd
    mov     ecx, [SIZEOF szAppName ]
    and     ecx, 3
    rep     movsb
 
    invoke 	ShellExecute , NULL , ADDR szOperation , ADDR AppPath , \
            NULL , NULL , SW_SHOWNORMAL
    xor     eax, eax
    ret
   		   		
    cmCloseProgram: 		

    invoke  EndDialog, hDlg , 0  
    d3d8    Release, pd3d

    xor     eax, eax
    ret
      
 SetupDialog endp</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1045;&#1097;&#1077; &#1087;&#1086;&#1089;&#1083;&#1077;
SetupDialog &#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103;
&#1090;&#1077;&#1082;&#1089;&#1090;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DW2A. &#1071; &#1085;&#1077;
&#1089;&#1090;&#1072;&#1083; &#1077;&#1077; &#1090;&#1091;&#1090;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1076;&#1080;&#1090;&#1100;, &#1090;.&#1082;.
&#1086;&#1085;&#1072; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1083;&#1077;&#1075;&#1082;&#1072;
&#1080;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1085;&#1086;&#1081; dw2a
&#1080;&#1079;
&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1080; masm32.
&#1048;&#1085;&#1090;&#1077;&#1088;&#1077;&#1089;&#1091;&#1102;&#1097;&#1080;&#1077;&#1089;&#1103;
&#1074;&#1089;&#1077;&#1075;&#1076;&#1072;
&#1089;&#1084;&#1086;&#1075;&#1091;&#1090;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1077;&#1077; &#1074;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1080;&#1082;&#1077;.</font>
<p><font size="3">&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1074;&#1089;&#1077; &#1088;&#1072;&#1079;&#1073;&#1077;&#1088;&#1077;&#1084;
&#1087;&#1086; &#1082;&#1086;&#1089;&#1090;&#1086;&#1095;&#1082;&#1072;&#1084;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">  WinModeTable    dw  320,240, 640,480, 800,600, 1024,768, 1280,1024, 1600,1200 	
  WinModeStrTable dd  OFFSET szMode1 , OFFSET szMode2
                  dd  OFFSET szMode3 , OFFSET szMode4
			dd  OFFSET szMode5 , OFFSET szMode6

  szMode1         db  &quot;320x240&quot;,0
  szMode2         db  &quot;640x480&quot;,0   
  szMode3         db  &quot;800x600&quot;,0
  szMode4         db  &quot;1024x768&quot;,0
  szMode5         db  &quot;1280x1024&quot;,0
  szMode6         db  &quot;1600x1200&quot;,0</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1052;&#1072;&#1089;&#1089;&#1080;&#1074; WinModeTable
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1099;
&#1096;&#1077;&#1089;&#1090;&#1080;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1093;
&#1085;&#1072;&#1084;&#1080; &#1086;&#1082;&#1086;&#1096;&#1077;&#1082;.
&#1054;&#1085; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1085;&#1091;&#1078;&#1077;&#1085; &#1085;&#1072;&#1084; &#1076;&#1083;&#1103;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1103; &#1089;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1084;&#1080;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1072;&#1084;&#1080;
&#1088;&#1072;&#1073;&#1086;&#1095;&#1077;&#1075;&#1086;
&#1089;&#1090;&#1086;&#1083;&#1072;. &#1052;&#1072;&#1089;&#1089;&#1080;&#1074;
WinModeStrTable &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1080; &#1085;&#1072;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;. &#1069;&#1090;&#1080;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;
&#1074;&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1089;&#1090;&#1074;&#1080;&#1080;
&#1073;&#1091;&#1076;&#1091;&#1090;
&#1079;&#1072;&#1085;&#1077;&#1089;&#1077;&#1085;&#1099; &#1074; ComboBox
&#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">  FullModeTable     dd	50 dup (?)    ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
  FullModeBPPTable  db	50 dup (?)	  ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1086;&#1074; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;. 
  FullModeHerzTable db	50 dup (?)    ; &#1044;&#1083;&#1103; &#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1103; &#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1099; &#1074; &#1043;&#1077;&#1088;&#1094;&#1072;&#1093;.
  FullModeStrBuffer db	16 dup (?)    ; &#1041;&#1091;&#1092;&#1077;&#1088; &#1076;&#1083;&#1103; &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080;</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1042; &#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1077;
FullModeTable &#1095;&#1080;&#1089;&#1083;&#1086; 50
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;&#1084;
&#1074;&#1089;&#1077;&#1093;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1099;
&#1084;&#1086;&#1078;&#1077;&#1084;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100;. &#1071;,
&#1085;&#1072; &#1074;&#1089;&#1103;&#1082;&#1080;&#1081;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1081;,
&#1089;&#1076;&#1077;&#1083;&#1072;&#1083; &#1077;&#1075;&#1086; &#1089;
&#1079;&#1072;&#1087;&#1072;&#1089;&#1086;&#1084;.
&#1042;&#1086;&#1086;&#1073;&#1097;&#1077;, &#1082;&#1086;&#1075;&#1076;&#1072;
&#1084;&#1099;
&#1089;&#1087;&#1088;&#1072;&#1096;&#1080;&#1074;&#1072;&#1077;&#1084; Direct3D
&#1086; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1086;&#1085;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1085;&#1072;&#1084; &#1086;&#1075;&#1088;&#1086;&#1084;&#1085;&#1086;&#1077;
&#1080;&#1093; &#1095;&#1080;&#1089;&#1083;&#1086;, &#1082;&#1091;&#1076;&#1072;
&#1074;&#1093;&#1086;&#1076;&#1103;&#1090;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099; &#1089;
&#1086;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1099;&#1084;
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077;&#1084;,
&#1085;&#1086; &#1089; &#1088;&#1072;&#1079;&#1085;&#1099;&#1084;
&#1095;&#1080;&#1089;&#1083;&#1086;&#1084; &#1075;&#1077;&#1088;&#1094; &#1080;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1086;&#1084;
&#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1085;&#1072;
&#1084;&#1086;&#1077;&#1081; &#1074;&#1080;&#1076;&#1102;&#1093;&#1077;
&#1086;&#1085; &#1074;&#1099;&#1076;&#1072;&#1077;&#1090; 90
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;.
&#1063;&#1090;&#1086;&#1073;&#1099; &#1085;&#1077;
&#1074;&#1086;&#1079;&#1080;&#1090;&#1100;&#1089;&#1103; &#1089;
&#1088;&#1072;&#1079;&#1085;&#1086;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1086;&#1081; &#1103;
&#1088;&#1077;&#1096;&#1080;&#1083;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1090;&#1100;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1090;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099;, &#1074;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1095;&#1080;&#1089;&#1083;&#1086; &#1043;&#1077;&#1088;&#1094;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;.
&#1042; &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1077;
&#1084;&#1099; &#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1090;&#1077;&#1088;&#1103;&#1077;&#1084;, &#1090;.&#1082;.
&#1087;&#1088;&#1080; &#1074;&#1099;&#1073;&#1086;&#1088;&#1077;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1077;&#1082;
&#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1090;&#1100;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1091; &#1074; 60, 70 &#1080; &#1090;.&#1087;.
&#1043;&#1077;&#1088;&#1094; &#1074;&#1089;&#1077;
&#1088;&#1072;&#1074;&#1085;&#1086; &#1085;&#1080;&#1082;&#1090;&#1086;
&#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090;. &#1042;&#1079;&#1103;&#1074;
&#1085;&#1072;
&#1074;&#1086;&#1086;&#1088;&#1091;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1101;&#1090;&#1086;&#1090; &#1092;&#1072;&#1082;&#1090;, &#1084;&#1099;
&#1089;&#1086;&#1082;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;
&#1095;&#1080;&#1089;&#1083;&#1086;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1076;&#1086;
&#1076;&#1074;&#1091;&#1093; - &#1090;&#1088;&#1077;&#1093;
&#1076;&#1077;&#1089;&#1103;&#1090;&#1082;&#1086;&#1074; (&#1055;&#1088;&#1080;&#1084;&#1077;&#1095;&#1072;&#1085;&#1080;&#1077;:
&#1042; Win98 Direct3D &#1074;&#1099;&#1076;&#1072;&#1077;&#1090;
&#1074;&#1084;&#1077;&#1089;&#1090;&#1086; &#1095;&#1080;&#1089;&#1083;&#1072;
&#1043;&#1077;&#1088;&#1094; &#1085;&#1086;&#1083;&#1100;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1077;&#1089;&#1083;&#1080;
&#1079;&#1072;&#1085;&#1077;&#1089;&#1090;&#1080; &#1074;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
D3DPRESENT_PARAMETERS
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1091;, &#1072; &#1085;&#1077;
&#1085;&#1086;&#1083;&#1100;, &#1090;&#1086;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;
&#1085;&#1077; &#1091;&#1076;&#1072;&#1089;&#1090;&#1089;&#1103;). &#1042;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1077; FullModeStrBuffer
&#1084;&#1099; &#1073;&#1091;&#1076;&#1077;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1074;&#1080;&#1076;&#1072;: 1024&#1093;768&#1093;32
&#1080; &#1079;&#1072;&#1090;&#1077;&#1084;
&#1079;&#1072;&#1085;&#1086;&#1089;&#1080;&#1090;&#1100; &#1077;&#1077; &#1074;
ComboBox.</font>
<p><font size="3">Invoke DialogBoxParam,400000h,ADDR szDialogName,NULL,OFFSET
SetupDialog,NULL</font>
<p><font size="3">&#1053;&#1072;&#1096;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075; &#1080;&#1079;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1086;&#1074;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084; &#1074;&#1086;&#1090;
&#1090;&#1072;&#1082;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1086;&#1081; &#1075;&#1076;&#1077; 400000h
- &#1101;&#1090;&#1086; hInstance.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">wmInitDialog:
 ;--------------

  pushad
  invoke  CheckRadioButton, hDlg , 20 , 21 , 20  
  invoke  GetDlgItem, hDlg , 23 				
  mov     cmbWindow,  eax
  invoke  GetDlgItem, hDlg , 22
  mov     cmbFullScreen,  eax
  invoke  GetDlgItem, hDlg , 24
  mov     cmbHerz,  eax</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1053;&#1091; &#1074;&#1086;&#1090;
&#1076;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;&#1089;&#1100; &#1076;&#1086;
&#1089;&#1072;&#1084;&#1086;&#1075;&#1086;
&#1075;&#1083;&#1072;&#1074;&#1085;&#1086;&#1075;&#1086;:
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;.
&#1042;&#1085;&#1072;&#1095;&#1072;&#1083;&#1077;,
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1086;&#1090;&#1084;&#1077;&#1090;&#1082;&#1091; &#1085;&#1072; RadioButton
&quot;&#1042; &#1086;&#1082;&#1086;&#1096;&#1082;&#1077;&quot; &#1080;
&#1089;&#1085;&#1080;&#1084;&#1072;&#1077;&#1084; &#1089; &quot;&#1055;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1086;&#1077;&quot;.
&#1047;&#1072;&#1090;&#1077;&#1084;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; ID
&#1074;&#1089;&#1077;&#1093; &#1085;&#1072;&#1096;&#1080;&#1093; ComboBox'&#1086;&#1074;.
( &#1055;&#1088;&#1080;&#1084;&#1077;&#1095;&#1072;&#1085;&#1080;&#1077;:
&#1055;&#1088;&#1080; &#1074;&#1099;&#1093;&#1086;&#1076;&#1077; &#1080;&#1079;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103; INIT_DIALOG,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1084;&#1099; &#1091;&#1078;&#1077;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084; EAX=1
&#1080; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1084;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;, &#1074; Win98
&#1087;&#1088;&#1086;&#1080;&#1089;&#1093;&#1086;&#1076;&#1080;&#1083;&#1072;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;. &#1053;&#1072; &#1084;&#1086;&#1081;
&#1074;&#1079;&#1075;&#1083;&#1103;&#1076;,
&#1087;&#1088;&#1080;&#1095;&#1080;&#1085;&#1072;
&#1082;&#1088;&#1086;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1082;&#1072;&#1082;&#1080;&#1093; - &#1090;&#1086;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1072;&#1093;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1099;
&#1080;&#1079;&#1084;&#1077;&#1085;&#1080;&#1083;&#1080; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1077;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;.
&#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103; PUSHAD
&#1087;&#1088;&#1080; &#1074;&#1093;&#1086;&#1076;&#1077; &#1080; POPAD
&#1087;&#1088;&#1080; &#1074;&#1099;&#1093;&#1086;&#1076;&#1077;,
&#1101;&#1090;&#1086;&#1090; &#1073;&#1072;&#1075;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1083;&#1080;&#1082;&#1074;&#1080;&#1076;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;.
&#1063;&#1090;&#1086; &#1082;&#1072;&#1089;&#1072;&#1077;&#1090;&#1089;&#1103;
XP, &#1090;&#1086; &#1077;&#1084;&#1091;,
&#1087;&#1086;&#1093;&#1086;&#1078;&#1077;, &#1076;&#1086;
&#1083;&#1072;&#1084;&#1087;&#1086;&#1095;&#1082;&#1080;
&#1077;&#1089;&#1090;&#1100; PUSHAD, POPAD &#1080;&#1083;&#1080;
&#1085;&#1077;&#1090;. )</font>
<p><code><!--mstheme--></font>
<pre><font size="3">  invoke  Direct3DCreate8, D3D_SDK_VERSION	
  mov     pd3d, eax
  
  d3d8    GetAdapterDisplayMode, pd3d, D3DADAPTER_DEFAULT, ADDR d3dpp
   
  lea     esi, d3dpp.BackBufferWidth
  mov     eax, [esi]			
  add     eax, [esi+4]				
  mov     ebx, [esi+12] 
  mov     [esi+8], ebx
  mov     DWORD PTR [esi+12], 3
  xor     ebx, ebx   

; &#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1082;&#1072; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1086;&#1082;&#1086;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072;

  getNextMode:
  push    ebx
  push    eax
  invoke  SendMessage,cmbWindow,CB_ADDSTRING,0,[WinModeStrTable + ebx*4]
  pop     eax
  pop     ebx
  movzx   ecx, [WinModeTable+ebx*4]
  movzx   edx, [WinModeTable+ebx*4+2]
  add     ecx, edx   
  inc     ebx
  cmp     eax, ecx
  ja      getNextMode</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1057;&#1086;&#1079;&#1076;&#1072;&#1077;&#1084; Direct3D,
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
&#1088;&#1072;&#1073;&#1086;&#1095;&#1077;&#1075;&#1086;
&#1089;&#1090;&#1086;&#1083;&#1072;
&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084;
GetAdapterDisplayMode. &#1058;&#1072;&#1082; &#1082;&#1072;&#1082;
&#1084;&#1099; &#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1074; D3DPRESENT_PARAMETERS,
&#1085;&#1072;&#1084; &#1087;&#1088;&#1080;&#1076;&#1077;&#1090;&#1089;&#1103;
&#1087;&#1088;&#1086;&#1074;&#1077;&#1089;&#1090;&#1080;
&#1085;&#1077;&#1073;&#1086;&#1083;&#1100;&#1096;&#1091;&#1102;
&#1084;&#1072;&#1085;&#1080;&#1087;&#1091;&#1083;&#1103;&#1094;&#1080;&#1102;,
&#1079;&#1072;&#1085;&#1086;&#1089;&#1103;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;
&#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;
&#1089; &#1095;&#1077;&#1090;&#1074;&#1077;&#1088;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1083;&#1103;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; &#1085;&#1072;
&#1090;&#1088;&#1077;&#1090;&#1100;&#1077;. &#1042;
&#1095;&#1077;&#1090;&#1074;&#1077;&#1088;&#1090;&#1086;&#1077;
&#1087;&#1086;&#1083;&#1077; &#1079;&#1072;&#1085;&#1086;&#1089;&#1080;&#1084;
&#1095;&#1080;&#1089;&#1083;&#1086; BackBuffer
&#1088;&#1072;&#1074;&#1085;&#1086;&#1077; &#1090;&#1088;&#1077;&#1084;.
&#1057;&#1076;&#1077;&#1083;&#1072;&#1074; &#1101;&#1090;&#1086;,
&#1095;&#1072;&#1089;&#1090;&#1100; D3DPRESENT_PARAMETERS &#1084;&#1099;
&#1091;&#1078;&#1077;
&#1089;&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1083;&#1080;.
&#1044;&#1072;&#1083;&#1077;&#1077; &#1080;&#1076;&#1077;&#1090;
&#1094;&#1080;&#1082;&#1083; &#1085;&#1072;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1091;&#1084;&#1084;&#1099;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1093;
&#1096;&#1080;&#1088;&#1080;&#1085;&#1099; &#1080;
&#1074;&#1099;&#1089;&#1086;&#1090;&#1099; &#1089;
&#1089;&#1091;&#1084;&#1084;&#1086;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1074;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1085;&#1072;&#1084;&#1080; &#1074; WinModeTable.
&#1054;&#1076;&#1085;&#1086;&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1089; &#1101;&#1090;&#1080;&#1084;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1084; ComboBox.</font>
<p><strong><em><font size="3">&#1057;&#1087;&#1088;&#1072;&#1074;&#1082;&#1072;</font></em></strong>
<p><code><!--mstheme--></font>
<pre><font size="3"> GetAdapterDisplayMode &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1076;&#1074;&#1072; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;.

 1. &#1053;&#1086;&#1084;&#1077;&#1088; &#1072;&#1076;&#1072;&#1087;&#1090;&#1077;&#1088;&#1072;. D3DADAPTER_DEFAULT - &#1072;&#1076;&#1072;&#1087;&#1090;&#1077;&#1088; &#1087;&#1086; &#1091;&#1084;&#1086;&#1083;&#1095;&#1072;&#1085;&#1080;&#1102;.
 2. &#1040;&#1076;&#1088;&#1077;&#1089; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; D3DDISPLAYMODE. ( &#1057;&#1084;. &#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1080;&#1077; &#1091;&#1088;&#1086;&#1082;&#1080; )

 &#1052;&#1077;&#1090;&#1086;&#1076; &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; D3D_OK &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; &#1076;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080; &#1077;&#1089;&#1083;&#1080; &#1074;&#1089;&#1077; &#1087;&#1088;&#1086;&#1096;&#1083;&#1086; &#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;. 
 &#1045;&#1089;&#1083;&#1080; &#1085;&#1077;&#1090;, &#1090;&#1086; D3DERR_INVALIDCALL - &#1085;&#1077;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081; &#1074;&#1099;&#1079;&#1086;&#1074;.

  d3d8    GetAdapterModeCount, pd3d, D3DADAPTER_DEFAULT
  dec     eax</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1044;&#1072;&#1083;&#1077;&#1077;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1074;&#1089;&#1077;&#1093;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1080;
&#1091;&#1084;&#1077;&#1085;&#1100;&#1096;&#1072;&#1077;&#1084;
&#1077;&#1075;&#1086; &#1085;&#1072;
&#1077;&#1076;&#1080;&#1085;&#1080;&#1094;&#1091;, &#1090;.&#1082;.
&#1085;&#1091;&#1084;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103;
&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1077;&#1090;&#1089;&#1103; &#1089;
&#1085;&#1091;&#1083;&#1103;.</font>
<p><strong><em><font size="3">&#1057;&#1087;&#1088;&#1072;&#1074;&#1082;&#1072;</font></em></strong>
<p><code><!--mstheme--></font>
<pre><font size="3"> GetAdapterModeCount &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1085;&#1086;&#1084;&#1077;&#1088; &#1072;&#1076;&#1072;&#1087;&#1090;&#1077;&#1088;&#1072;.

 &#1052;&#1077;&#1090;&#1086;&#1076; &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; &#1082;&#1086;&#1083;-&#1074;&#1086; &#1074;&#1089;&#1077;&#1093; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1077;&#1089;&#1083;&#1080; &#1074;&#1089;&#1077; &#1087;&#1088;&#1086;&#1096;&#1083;&#1086; &#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;.  
 &#1045;&#1089;&#1083;&#1080; &#1085;&#1077;&#1090;, &#1090;&#1086; &#1085;&#1086;&#1083;&#1100;.

  lea     esi, FullModeTable
  xor	    ebx, ebx   
  mov	    edx, ebx
  mov	    ecx, eax         
   
  getMode:		
  push    ecx
   
  push    esi
  push    ebx
  push    edx
   
  d3d8    EnumAdapterModes, pd3d, D3DADAPTER_DEFAULT, ecx, ADDR d3ddm
  mov     eax, d3ddm.Width1							
  mov     ecx, d3ddm.Height
  mov     edi, eax
  add     edi, ecx
  add     edi, d3ddm.Format
   
  pop     edx
  pop     ebx
  pop     esi   
   
  cmp     edx, edi
  je      noAdd   
  mov     edx, d3ddm.RefreshRate
  mov     BYTE PTR [FullModeHerzTable+ebx], dl
  mov     edx, d3ddm.Format
  mov     [FullModeBPPTable+ebx], dl 
  push    edx
  push    edi
  pop	    edx
  pop	    edi
   
  mov	    [esi+ebx*4], eax
  mov	    [esi+ebx*4+2], ecx
  inc	    ebx</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1057;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;
&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1094;&#1080;&#1082;&#1083;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1103; &#1080;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1077;&#1075;&#1086;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1084;&#1080;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;&#1084;&#1080;.
&#1050;&#1072;&#1078;&#1076;&#1099;&#1081; &#1088;&#1072;&#1079;,
&#1091;&#1084;&#1077;&#1085;&#1100;&#1096;&#1072;&#1103;
&#1085;&#1086;&#1084;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1080; &#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1103; EnumAdapterModes,
&#1084;&#1099;
&#1089;&#1087;&#1088;&#1072;&#1096;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1091; Direct3D.
&#1047;&#1072;&#1090;&#1077;&#1084; &#1073;&#1077;&#1088;&#1077;&#1084;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1096;&#1080;&#1088;&#1080;&#1085;&#1091; &#1080;
&#1074;&#1099;&#1089;&#1086;&#1090;&#1091;,
&#1089;&#1082;&#1083;&#1072;&#1076;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1080;&#1093; &#1080;
&#1087;&#1088;&#1080;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084; &#1082;
&#1101;&#1090;&#1086;&#1081; &#1089;&#1091;&#1084;&#1084;&#1077;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;
&#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;.
&#1057;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1077;&#1084; &#1089;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1080;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;
&#1089;&#1091;&#1084;&#1084;&#1099; &#1080;, &#1077;&#1089;&#1083;&#1080;
&#1090;&#1072;&#1082;&#1086;&#1074;&#1086;&#1081; &#1091; &#1085;&#1072;&#1089;
&#1085;&#1077;&#1090; ( &#1101;&#1090;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090; &#1085;&#1086;&#1074;&#1099;&#1081;
&#1088;&#1077;&#1078;&#1080;&#1084; ),
&#1079;&#1072;&#1085;&#1086;&#1089;&#1080;&#1084; &#1074;&#1089;&#1102;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102;
&#1087;&#1086; &#1088;&#1072;&#1079;&#1085;&#1099;&#1084;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;&#1084;, &#1080;
&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1077;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1074;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1077;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1077;&#1077; &#1084;&#1086;&#1078;&#1085;&#1086; &#1073;&#1099;&#1083;&#1086;
&#1079;&#1072;&#1085;&#1077;&#1089;&#1090;&#1080; &#1074; Combobox.
&#1057;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1077;&#1089;&#1083;&#1080; &#1101;&#1090;&#1072;
&#1089;&#1091;&#1084;&#1084;&#1072; &#1077;&#1089;&#1090;&#1100;, &#1090;&#1086;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;
&#1085;&#1072;&#1084; &#1085;&#1077; &#1085;&#1091;&#1078;&#1085;&#1086;.</font>
<p><strong><em><font size="3">&#1057;&#1087;&#1088;&#1072;&#1074;&#1082;&#1072;</font></em></strong>
<p><code><!--mstheme--></font>
<pre><font size="3"> EnumAdapterModes &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1090;&#1088;&#1080; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;.

 1. &#1053;&#1086;&#1084;&#1077;&#1088; &#1072;&#1076;&#1072;&#1087;&#1090;&#1077;&#1088;&#1072;.
 2. &#1053;&#1086;&#1084;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;. &#1054;&#1090; 0 &#1080; &#1074;&#1099;&#1096;&#1077;.
 3. &#1040;&#1076;&#1088;&#1077;&#1089; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; D3DDISPLAYMODE

 &#1052;&#1077;&#1090;&#1086;&#1076; &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; D3D_OK &#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; &#1076;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080; &#1077;&#1089;&#1083;&#1080; &#1074;&#1089;&#1077; &#1087;&#1088;&#1086;&#1096;&#1083;&#1086; &#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;.
 &#1045;&#1089;&#1083;&#1080; &#1085;&#1077;&#1090;, &#1090;&#1086; D3DERR_INVALIDCALL - &#1085;&#1077;&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081; &#1074;&#1099;&#1079;&#1086;&#1074;.

  push    ebx       
  push    esi
  push    edx
     
 ; &#1060;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077; &#1077;&#1077; &#1074; Combobox

  invoke  DW2A, eax, ADDR FullModeStrBuffer
  mov     BYTE PTR [ebx], 'x'
  inc	    ebx
  invoke  DW2A, ecx, ebx
  mov     BYTE PTR [ebx], 'x'
  inc     ebx
  mov     ecx, 16

  cmp     edi, D3DFMT_X8R8G8B8
  jne     nextFormat
  mov     ecx, 32

  nextFormat:   
  cmp     edi, D3DFMT_A8R8G8B8
  jne     nextFormat2
  mov     ecx, 32

  nextFormat2:
  cmp     edi, D3DFMT_R8G8B8
  jne     exitCompare		
  mov     ecx, 24

  exitCompare:
  invoke  DW2A, ecx , ebx
  mov     BYTE PTR [ebx], 0       	
  invoke  SendMessage, cmbFullScreen , CB_ADDSTRING , 0 , ADDR FullModeStrBuffer	
   	   
  pop     edx
  pop     esi
  pop     ebx  	
     
  noAdd:   	
  pop     ecx
  dec     ecx
  test    ecx, ecx
  jne     getMode
   
 ; &#1042; &#1080;&#1090;&#1086;&#1075;&#1077; &#1074; ComboBox &#1079;&#1072;&#1085;&#1077;&#1089;&#1077;&#1085;&#1099; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1093; &#1085;&#1072;&#1084; &#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093; &#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074;
 ; &#1089; &#1088;&#1072;&#1079;&#1085;&#1099;&#1084;&#1080; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072;&#1084;&#1080; &#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080; &#1080; &#1089;&#1072;&#1084;&#1099;&#1084; &#1074;&#1099;&#1089;&#1086;&#1082;&#1080;&#1084; &#1095;&#1080;&#1089;&#1083;&#1086;&#1084; &#1043;&#1077;&#1088;&#1094; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1047;&#1076;&#1077;&#1089;&#1100; &#1091;
&#1085;&#1072;&#1089; &#1080;&#1076;&#1077;&#1090;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;.
&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1077;&#1081; DW2A
&#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1091;&#1077;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1074;
&#1090;&#1077;&#1082;&#1089;&#1090;,
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084;
&#1080;&#1082;&#1089;&#1099;.
&#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1077;&#1084; ID
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072; &#1080; &#1090;&#1086;
&#1095;&#1090;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1083;&#1086;&#1089;&#1100;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084; &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1086;&#1082;&#1086;&#1085;&#1095;&#1072;&#1085;&#1080;&#1103;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;.
&#1058;&#1077;&#1087;&#1077;&#1088;&#1100; &#1085;&#1072;&#1084;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100;
&#1079;&#1072;&#1085;&#1077;&#1089;&#1090;&#1080; &#1101;&#1090;&#1091;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1090;&#1091;&#1076;&#1072;
&#1082;&#1091;&#1076;&#1072; &#1085;&#1091;&#1078;&#1085;&#1086; &#1080;
&#1074;&#1089;&#1077;. &#1069;&#1090;&#1086; &#1084;&#1099; &#1080;
&#1076;&#1077;&#1083;&#1072;&#1077;&#1084;,
&#1087;&#1086;&#1089;&#1099;&#1083;&#1072;&#1103;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1077; &#1057;omboBox.
&#1040; &#1076;&#1072;&#1083;&#1077;&#1077; &#1089;&#1085;&#1086;&#1074;&#1072;
&#1085;&#1072; &#1085;&#1072;&#1095;&#1072;&#1083;&#1086;
&#1094;&#1080;&#1082;&#1083;&#1072;. &#1053;&#1072;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1081;
&#1074;&#1079;&#1075;&#1083;&#1103;&#1076; &#1074;&#1089;&#1077;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1085;&#1086;, &#1085;&#1086;
&#1077;&#1089;&#1090;&#1100; &#1079;&#1076;&#1077;&#1089;&#1100;
&#1086;&#1076;&#1085;&#1086;
&#1084;&#1072;&#1083;&#1077;&#1085;&#1100;&#1082;&#1086;&#1077; &#1085;&#1086; -
&#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1082;&#1072; &#1085;&#1072;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;.
&#1054;&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1083;&#1103;&#1103;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089; 24
&#1080; 32 &#1073;&#1080;&#1090;&#1085;&#1099;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1086;&#1084; &#1084;&#1099;
&#1089;&#1095;&#1080;&#1090;&#1072;&#1077;&#1084; &#1074;&#1089;&#1077;
&#1076;&#1088;&#1091;&#1075;&#1080;&#1077;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1099; 16-&#1073;&#1080;&#1090;&#1085;&#1099;&#1084;&#1080;.
&#1050;&#1072;&#1082; &#1084;&#1085;&#1077;
&#1082;&#1072;&#1078;&#1077;&#1090;&#1089;&#1103;, &#1101;&#1090;&#1086;
&#1085;&#1077; &#1089;&#1090;&#1086;&#1083;&#1100;
&#1074;&#1072;&#1078;&#1085;&#1086;.
&#1057;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1103; &#1085;&#1080;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1083;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1085;&#1099;&#1093;
&#1074;&#1080;&#1076;&#1102;&#1093;&#1072;&#1093;, &#1073;&#1091;&#1076;&#1100;
&#1090;&#1086; ATI &#1080;&#1083;&#1080; NVIDIA &#1086;&#1085;&#1080;
&#1084;&#1085;&#1077; &#1074;&#1099;&#1076;&#1072;&#1074;&#1072;&#1083;&#1080;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; 2
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072;: D3DFMT_A8R8G8B8 &#1080;
D3DFMT_R5G6B5 ( &#1074;&#1088;&#1086;&#1076;&#1077; &#1101;&#1090;&#1080; :) ).
&#1043;&#1083;&#1091;&#1073;&#1078;&#1077; &#1083;&#1077;&#1079;&#1090;&#1100;
&#1080; &#1074;&#1099;&#1103;&#1089;&#1085;&#1103;&#1090;&#1100;,
&#1087;&#1086;&#1095;&#1077;&#1084;&#1091; &#1090;&#1072;&#1082;&#1086;&#1077;
&#1077;&#1089;&#1090;&#1100;, &#1084;&#1085;&#1077;
&#1085;&#1077;&#1086;&#1093;&#1086;&#1090;&#1072;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">  invoke  SendMessage, cmbWindow , CB_SETCURSEL , 0 , 0
  invoke  SendMessage, cmbFullScreen , CB_SETCURSEL , 0 , 0
  invoke  SendMessage, hDlg, WM_COMMAND , 22 + CBN_SELCHANGE shl 16, 0</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1084;&#1080;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1072;&#1084;&#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1074;&#1099;&#1073;&#1088;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1074;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1084; &#1080;&#1079; ComboBox &#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072; WM_INITDIALOG
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1072;. &#1053;&#1086;
&#1074;&#1087;&#1077;&#1088;&#1077;&#1076;&#1080; &#1085;&#1077;
&#1084;&#1077;&#1085;&#1077;&#1077;
&#1091;&#1074;&#1083;&#1077;&#1082;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1079;&#1072;&#1085;&#1103;&#1090;&#1080;&#1077;:
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1090;&#1072;&#1082;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1074;&#1089;&#1077;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1083;&#1086; &#1082;&#1072;&#1082;
&#1077;&#1076;&#1080;&#1085;&#1086;&#1077; &#1094;&#1077;&#1083;&#1086;&#1077;.
&#1055;&#1088;&#1080;&#1089;&#1090;&#1091;&#1087;&#1072;&#1077;&#1084; &#1082;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1080;&#1102;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1089;&#1086;&#1073;&#1099;&#1090;&#1080;&#1103; WM_COMMAND. &#1042;
&#1085;&#1077;&#1084; &#1084;&#1099;
&#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1077;&#1084; ID
&#1074;&#1089;&#1077;&#1093;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074; &#1080;, &#1074;
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;
&#1086;&#1090;
&#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1072;,
&#1087;&#1077;&#1088;&#1077;&#1093;&#1086;&#1076;&#1080;&#1084; &#1085;&#1072;
&#1085;&#1091;&#1078;&#1085;&#1091;&#1102; &#1084;&#1077;&#1090;&#1082;&#1091;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">    cmRadioFull:

    inc     ebx
   
    cmRadioWin:
 
    invoke  EnableWindow, cmbFullScreen , ebx		
    invoke  EnableWindow, cmbHerz , ebx     
    xor     ebx, 1
    invoke  EnableWindow, cmbWindow , ebx  

    xor     eax, eax
    ret</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1047;&#1076;&#1077;&#1089;&#1100; &#1091;
&#1085;&#1072;&#1089; &#1080;&#1076;&#1077;&#1090;
&#1074;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1086;&#1076;&#1085;&#1080;&#1093; ComboBox &#1080;
&#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1076;&#1088;&#1091;&#1075;&#1080;&#1093;.
&#1057;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1101;&#1090;&#1086; &#1076;&#1077;&#1083;&#1086;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;, &#1082;&#1086;&#1075;&#1076;&#1072;
&#1090;&#1099;&#1082;&#1085;&#1091;&#1090;&#1100;
&#1084;&#1099;&#1096;&#1082;&#1086;&#1081; &#1085;&#1072;
&#1086;&#1076;&#1085;&#1091; &#1080;&#1079; RadioButton.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">    cmHerz:
 
    invoke  SendMessage, cmbHerz , CB_RESETCONTENT , 0 , 0           	
    invoke  SendMessage, cmbFullScreen , CB_GETCURSEL , 0 , 0
    movzx   ebx, BYTE PTR [FullModeHerzTable+eax]
    invoke  DW2A, ebx , ADDR FullModeStrBuffer
    invoke  SendMessage, cmbHerz , CB_ADDSTRING , 0 , ADDR FullModeStrBuffer
    invoke  SendMessage, cmbHerz , CB_SETCURSEL , 0 , 0

    xor     eax, eax
    ret</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1040; &#1101;&#1090;&#1086;
&#1089;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1077;&#1090;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1072;&#1084;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1085;&#1086;&#1074;&#1080;&#1090;&#1100;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1077; ComboBox,
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1077;&#1075;&#1086;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102; &#1086;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1077;. &#1052;&#1099;
&#1074;&#1089;&#1077; &#1089;&#1090;&#1080;&#1088;&#1072;&#1077;&#1084;,
&#1073;&#1077;&#1088;&#1077;&#1084; &#1085;&#1086;&#1084;&#1077;&#1088;
&#1074;&#1099;&#1073;&#1088;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072; &#1074; ComboBox,
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1077;&#1075;&#1086;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1085;&#1099;&#1077;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1099;, &#1080; &#1087;&#1086;
&#1085;&#1077;&#1084;&#1091;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1080;&#1079;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1091;.
&#1055;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1091;&#1077;&#1084;
&#1077;&#1077; &#1082; &#1091;&#1076;&#1086;&#1073;&#1085;&#1086;&#1084;&#1091;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1091; &#1080;
&#1079;&#1072;&#1085;&#1086;&#1089;&#1080;&#1084; &#1074; ComboBox.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">    cmSaveData:

    invoke  IsDlgButtonChecked, hDlg , 20
    test    eax, eax			
    je      EnableFull                   
    
    invoke  SendMessage, cmbWindow , CB_GETCURSEL , 0 , 0
    lea     esi, WinModeTable
    shl     eax, 2
    add     esi, eax		
    xor     ecx, ecx
    mov     edx, ecx
    push    [esi]   		
    pop     cx							
    pop     dx 		
    mov     d3dpp.BackBufferWidth, ecx
    mov     d3dpp.BackBufferHeight, edx		
    mov     d3dpp.Windowed, 1 
    mov     WinStyle, WS_SYSMENU
    jmp     Create

    EnableFull:

    invoke  SendMessage, cmbFullScreen , CB_GETCURSEL , 0 , 0
    movzx   ebx, BYTE PTR [FullModeHerzTable+eax]
    mov     d3dpp.FullScreen_RefreshRateInHz, ebx
    movzx   ebx, BYTE PTR [FullModeBPPTable+eax]
    mov     d3dpp.BackBufferFormat, ebx

    lea     esi, FullModeTable
    shl     eax, 2
    add     esi, eax
    push    [esi] 		
    xor     ecx, ecx
    mov     edx, ecx
    mov     d3dpp.Windowed, ecx
    pop     cx
    pop     dx
    mov     d3dpp.BackBufferWidth, ecx
    mov     d3dpp.BackBufferHeight, edx
    mov     WinStyle, WS_POPUP

    Create:

    mov     d3dpp.SwapEffect, D3DSWAPEFFECT_FLIP

    invoke  CreateFile , ADDR szFileName , GENERIC_WRITE, NULL, \
            NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL
    mov     hfile, eax

    invoke  WriteFile , hfile , ADDR d3dpp , 56 , ADDR brr , NULL
    invoke  CloseHandle , hfile  

    xor     eax, eax
    ret</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1054;&#1082;&#1086;&#1085;&#1095;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
D3DPRESENT_PARAMETERS, &#1087;&#1083;&#1102;&#1089;
&#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1077;
&#1074;&#1089;&#1077;&#1093;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1077;&#1082; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1077;.
&#1055;&#1086;&#1079;&#1076;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102; 90%
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1087;&#1086;&#1079;&#1072;&#1076;&#1080;. &#1057;&#1102;&#1076;&#1072;
&#1084;&#1099; &#1087;&#1086;&#1087;&#1072;&#1076;&#1072;&#1077;&#1084;,
&#1077;&#1089;&#1083;&#1080;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1085;&#1072;&#1078;&#1072;&#1083; &#1082;&#1085;&#1086;&#1087;&#1082;&#1091;
&quot;&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;&quot;.
&#1053;&#1091; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090;
&#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1077;&#1084;
&#1082;&#1072;&#1082;&#1072;&#1103; RadioButton
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072; &#1080;
&#1080;&#1076;&#1077;&#1084; &#1087;&#1086;
&#1085;&#1091;&#1078;&#1085;&#1086;&#1084;&#1091; &#1087;&#1091;&#1090;&#1080;.
&#1045;&#1089;&#1083;&#1080; &quot;&#1042;
&#1086;&#1082;&#1086;&#1096;&#1082;&#1077;&quot;, &#1090;&#1086;
&#1087;&#1086;&#1083;&#1077; Windowed &#1088;&#1072;&#1074;&#1085;&#1086; 1
&#1080; &#1089;&#1090;&#1080;&#1083;&#1100; &#1086;&#1082;&#1085;&#1072;
WS_SYSMENU. &#1045;&#1089;&#1083;&#1080; &quot;&#1055;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1086;&#1077;&quot;,
&#1090;&#1086; &#1073;&#1077;&#1088;&#1077;&#1084;
&#1085;&#1086;&#1084;&#1077;&#1088;
&#1074;&#1099;&#1073;&#1088;&#1072;&#1085;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1074; ComboBox
&#1087;&#1086;&#1083;&#1085;&#1086;&#1101;&#1082;&#1088;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1086;&#1074; &#1080; &#1091;&#1078;&#1077;
&#1086;&#1090; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1083;&#1103;&#1096;&#1077;&#1084;.
&#1061;&#1074;&#1072;&#1090;&#1072;&#1077;&#1084; &#1080;&#1079;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1086;&#1074;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1099;,
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;
&#1087;&#1086;&#1074;&#1077;&#1088;&#1093;&#1085;&#1086;&#1089;&#1090;&#1080;,
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1091; &#1080; &#1074;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
&#1074;&#1089;&#1077;
&#1091;&#1082;&#1083;&#1072;&#1076;&#1099;&#1074;&#1072;&#1077;&#1084;.
&#1055;&#1086;&#1083;&#1077; Windowed &#1088;&#1072;&#1074;&#1085;&#1086;
&#1085;&#1091;&#1083;&#1102;, &#1072; &#1089;&#1090;&#1080;&#1083;&#1100;
&#1086;&#1082;&#1085;&#1072; &#1073;&#1091;&#1076;&#1077;&#1090; WS_POPUP.
&#1054;&#1082;&#1086;&#1085;&#1095;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1096;&#1090;&#1088;&#1080;&#1096;&#1086;&#1082; &#1074;
&#1074;&#1080;&#1076;&#1077; SwapEffect &#1080;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1074;&#1089;&#1077;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1090;&#1100; &#1074;
&#1092;&#1072;&#1081;&#1083;.</font>
<p><font size="3">&#1045;&#1089;&#1083;&#1080; &#1084;&#1099;
&#1093;&#1086;&#1090;&#1080;&#1084; &#1095;&#1090;&#1086;&#1073;&#1099;
&#1080;&#1079; &#1076;&#1080;&#1072;&#1083;&#1086;&#1075;&#1072;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1083;&#1072;&#1089;&#1100;
&#1077;&#1097;&#1077; &#1080;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1072;, &#1090;&#1086;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1077;.</font>
<p><code><!--mstheme--></font>
<pre><font size="3">    cmStartProgram:   

    invoke  EndDialog, hDlg , 0			
    d3d8    Release, pd3d

    invoke  GetModuleFileName , 0 , ADDR AppPath , 260

    lea     edi,AppPath
    lea     edi,[edi+eax-6]              
    @@:
    mov     al,[edi]                     
    dec     edi                          
    cmp     al,'\'                      
    jne     @B
    inc     edi
    inc     edi
    cld
    lea     esi, szAppName
    mov     ecx, SIZEOF szAppName
    shr     ecx, 2
    rep     movsd
    mov     ecx, [SIZEOF szAppName ]
    and     ecx, 3
    rep     movsb
 
    invoke 	ShellExecute , NULL , ADDR szOperation , ADDR AppPath , \
            NULL , NULL , SW_SHOWNORMAL
    xor     eax, eax
    ret</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p><font size="3">&#1047;&#1072;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1076;&#1080;&#1072;&#1083;&#1086;&#1075;.
&#1054;&#1089;&#1074;&#1086;&#1073;&#1086;&#1078;&#1076;&#1072;&#1077;&#1084;
&#1074;&#1089;&#1077;
&#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1086;&#1077; &#1089;
Direct3D. &#1047;&#1072;&#1090;&#1077;&#1084;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1087;&#1091;&#1090;&#1100; &#1087;&#1086;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084;&#1091;
&#1083;&#1077;&#1078;&#1080;&#1090; &#1085;&#1072;&#1096; Setup
&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084;
GetModuleFileName. &#1053;&#1072; &#1074;&#1089;&#1103;&#1082;&#1080;&#1081;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1087;&#1086;&#1076;
&#1087;&#1091;&#1090;&#1100; &#1088;&#1072;&#1074;&#1077;&#1085; 260
&#1073;&#1072;&#1081;&#1090; ( &#1077;&#1089;&#1083;&#1080; &#1085;&#1077;
&#1086;&#1096;&#1080;&#1073;&#1072;&#1102;&#1089;&#1100; &#1101;&#1090;&#1086;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; &#1087;&#1091;&#1090;&#1080; &#1074;
&#1086;&#1082;&#1086;&#1096;&#1082;&#1072;&#1093; ). &#1042;&#1086;&#1090;
&#1084;&#1099; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1083;&#1080;
&#1087;&#1091;&#1090;&#1100;, &#1085;&#1086; &#1074; &#1085;&#1077;&#1084;
&#1087;&#1088;&#1080;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1080; &#1080;&#1084;&#1103; &#1085;&#1072;&#1096;&#1077;&#1075;&#1086; Setup.
&#1050;&#1072;&#1082; &#1077;&#1075;&#1086;
&#1091;&#1073;&#1088;&#1072;&#1090;&#1100; ?
&#1044;&#1077;&#1083;&#1072;&#1077;&#1084; &#1094;&#1080;&#1082;&#1083;
&#1076;&#1083;&#1103; &#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1082;&#1080;
&#1085;&#1072; '\' ,&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1103;
&#1086;&#1090; &#1082;&#1086;&#1085;&#1094;&#1072; &#1087;&#1091;&#1090;&#1080;.
&#1053;&#1072;&#1081;&#1076;&#1103; &#1077;&#1075;&#1086;,
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1084; &#1085;&#1072;
&#1084;&#1077;&#1089;&#1090;&#1086;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1079;&#1072; &#1085;&#1080;&#1084; &#1080;&#1084;&#1103;
&#1092;&#1072;&#1081;&#1083;&#1072;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1093;&#1086;&#1090;&#1080;&#1084;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;. &#1040;
&#1076;&#1072;&#1083;&#1100;&#1096;&#1077; &#1074;&#1089;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;. ShellExecute &#1089;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1086;&#1081; open &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;, &#1080;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1079;&#1072;&#1087;&#1091;&#1097;&#1077;&#1085;&#1086; &#1087;&#1086;
&#1085;&#1072;&#1096;&#1077;&#1084;&#1091;
&#1087;&#1088;&#1080;&#1082;&#1072;&#1079;&#1091;, &#1072;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1075;&#1086; Setup
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1072;.</font>
<p><font size="3">&#1054;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100;
&#1090;&#1077;&#1082;&#1089;&#1090; &#1089;&#1072;&#1084;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;. &#1042;
&#1085;&#1077;&#1084;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1091;
&#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1085;&#1099;&#1093;
&#1085;&#1072;&#1089;&#1090;&#1088;&#1086;&#1077;&#1082; &#1080; &#1085;&#1072;
&#1080;&#1093; &#1086;&#1089;&#1085;&#1086;&#1074;&#1077;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1090;&#1100; Direct3D.
&#1054;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1079;&#1076;&#1077;&#1089;&#1100; &#1103; &#1101;&#1090;&#1086; &#1085;&#1077;
&#1073;&#1091;&#1076;&#1091;, &#1083;&#1091;&#1095;&#1096;&#1077;
&#1075;&#1083;&#1103;&#1085;&#1100;&#1090;&#1077;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1080;&#1082;.</font>
<p><font size="3">&#1053;&#1091; &#1074;&#1089;&#1077;,
&#1087;&#1086;&#1088;&#1072;
&#1079;&#1072;&#1082;&#1088;&#1091;&#1075;&#1083;&#1103;&#1090;&#1100;&#1089;&#1103;,
&#1072; &#1090;&#1086; &#1080; &#1090;&#1072;&#1082;
&#1084;&#1085;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083;, &#1076;&#1072;
&#1080; &#1095;&#1077;&#1075;&#1086; - &#1090;&#1086; &#1087;&#1086;&#1076;
&#1082;&#1086;&#1085;&#1077;&#1094; &#1089;&#1090;&#1072;&#1090;&#1100;&#1080;
&#1089;&#1086;&#1074;&#1089;&#1077;&#1084; &#1090;&#1091;&#1075;&#1086;
&#1089;&#1086;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1072;&#1083;.</font>
<p><font size="3">PS: &#1042;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077; &#1078;&#1076;&#1080;&#1090;&#1077;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1094;&#1077;&#1085;&#1085;&#1086;&#1077;
&#1090;&#1088;&#1077;&#1093;&#1084;&#1077;&#1088;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077; &#1089;
&#1084;&#1072;&#1090;&#1088;&#1080;&#1094;&#1072;&#1084;&#1080;,
&#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1072;&#1084;&#1080;,
&#1087;&#1086;&#1083;&#1080;&#1075;&#1086;&#1085;&#1072;&#1084;&#1080; &#1080;
&#1087;&#1088;&#1086;&#1095;&#1077;&#1081;
&#1084;&#1072;&#1090;&#1077;&#1084;&#1072;&#1090;&#1080;&#1082;&#1086;&#1081;.</font>
<p><font size="3">&#1044;&#1072; &#1080; &#1085;&#1077;
&#1079;&#1072;&#1073;&#1091;&#1076;&#1100;&#1090;&#1077;
&#1075;&#1083;&#1103;&#1085;&#1091;&#1090;&#1100; &#1074;
&#1087;&#1072;&#1087;&#1082;&#1091; Include &#1090;&#1072;&#1084;
&#1083;&#1077;&#1078;&#1072;&#1090; &#1092;&#1072;&#1081;&#1083;&#1099; d3d.inc
&#1080; d3dcaps.inc
&#1086;&#1082;&#1086;&#1085;&#1095;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1080;.</font>
<p><font size="3">&#1048;&#1089;&#1093;&#1086;&#1076;&#1085;&#1080;&#1082;
&#1086;&#1073;&#1086;&#1080;&#1093;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;&#1086;&#1074;
&#1087;&#1088;&#1080;&#1083;&#1072;&#1075;&#1072;&#1077;&#1090;&#1089;&#1103; (<a href="http://www.wasm.ru/pub/19/files/dx8masm03a.zip">1</a>,
<a href="http://www.wasm.ru/pub/19/files/dx8masm03b.zip">2</a>).</font>
<p><font size="3">&#1042;&#1089;&#1077;
&#1074;&#1086;&#1087;&#1088;&#1086;&#1089;&#1099;
&#1084;&#1099;&#1083;&#1100;&#1090;&#1077; &#1089;&#1102;&#1076;&#1072; <a href="mailto:mybox@aib.ru">mybox@aib.ru</a></font>
<p><font size="3">&nbsp; [C] keYMax</font></p>
<!--mstheme--></font>

</body>

</html>
