<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>New Page 1</title>
<meta name="Microsoft Theme" content="zero 011">
</head>

<body background="zertxtr.gif" bgcolor="#000000" text="#FFFFFF" link="#6699CC" vlink="#669966" alink="#999999">

<!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font>
<h3 align="center"><!--mstheme--><font face="Arial, Arial, Helvetica" color="#CCCCCC"><font size="5" color="#00FF00">&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1099;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;:
&#1063;&#1072;&#1089;&#1090;&#1100; 3:
&#1055;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1080;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1099;</font><!--mstheme--></font></h3>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1042;&#1086;&#1090; &#1084;&#1099; &#1080;
&#1076;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;&#1089;&#1100; &#1076;&#1086;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1080;&#1093;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;.
&#1055;&#1086;&#1083;&#1085;&#1086;&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1085;&#1072;&#1089; &#1078;&#1076;&#1091;&#1090;
&#1074;&#1087;&#1077;&#1088;&#1077;&#1076;&#1080;. &#1042;&#1089;&#1077;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1077;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1099;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074; &#1103;
&#1073;&#1091;&#1076;&#1091;
&#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1103;&#1090;&#1100; &#1074;
&#1074;&#1080;&#1076;&#1077; *.bat &#1092;&#1072;&#1081;&#1083;&#1072;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;, &#1085;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1084; &#1076;&#1077;&#1083;&#1077;,
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1073;&#1080;&#1085;&#1072;&#1094;&#1080;&#1077;&#1081; *.bat
&#1080; *.asm &#1092;&#1072;&#1081;&#1083;&#1086;&#1074;, &#1085;&#1086;
&#1080;&#1084;&#1077;&#1077;&#1090;
&#1088;&#1072;&#1089;&#1096;&#1080;&#1088;&#1077;&#1085;&#1080;&#1077; .bat.
<p><code><!--mstheme--></font>
<pre><b><font size="2"> ;@echo off
 ;goto make


 .386                      ; &#1085;&#1072;&#1095;&#1072;&#1083;&#1086; &#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;

   ; &#1086;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081; &#1082;&#1086;&#1076; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;

 end DriverEntry           ; &#1082;&#1086;&#1085;&#1077;&#1094; &#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;


 :make
 \masm32\bin\ml /nologo /c /coff driver.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:driver.sys /subsystem:native driver.obj

 del driver.obj

 echo.
 pause</font></b>

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; &#1090;&#1072;&#1082;&#1086;&#1081; &quot;&#1089;&#1072;&#1084;&#1086;&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1091;&#1102;&#1097;&#1080;&#1081;&#1089;&#1103;&quot;
&#1092;&#1072;&#1081;&#1083;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;, &#1090;&#1086;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1097;&#1077;&#1077;.
&#1055;&#1077;&#1088;&#1074;&#1099;&#1077; &#1076;&#1074;&#1077;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099;
&#1079;&#1072;&#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1077;&#1085;&#1099;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1086;&#1085;&#1080;
&#1080;&#1075;&#1085;&#1086;&#1088;&#1080;&#1088;&#1091;&#1102;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1086;&#1084;
masm, &#1085;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1085;&#1099;&#1084;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1086;&#1084;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;, &#1074;
&#1089;&#1074;&#1086;&#1102; &#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1100;,
&#1080;&#1075;&#1085;&#1086;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &quot;&#1090;&#1086;&#1095;&#1082;&#1072;
&#1089; &#1079;&#1072;&#1087;&#1103;&#1090;&#1086;&#1081;&quot;.
&#1059;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1085;&#1072; &#1084;&#1077;&#1090;&#1082;&#1091; <i>:make</i>, &#1079;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1090;&#1089;&#1103;
&#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1080;
&#1076;&#1083;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1072;
&#1080;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;&#1072;.
&#1042;&#1089;&#1077;, &#1095;&#1090;&#1086;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1079;&#1072;
&#1076;&#1080;&#1088;&#1077;&#1082;&#1090;&#1080;&#1074;&#1086;&#1081;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1072; end,
&#1080;&#1075;&#1085;&#1086;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1086;&#1084;
masm. &#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1074;&#1077;&#1089;&#1100;
&#1090;&#1077;&#1082;&#1089;&#1090; &#1084;&#1077;&#1078;&#1076;&#1091;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1086;&#1081; <i>goto make</i>
&#1080; &#1084;&#1077;&#1090;&#1082;&#1086;&#1081; <i>:make</i>,
&#1080;&#1075;&#1085;&#1086;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1085;&#1099;&#1084;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1086;&#1084;,
&#1085;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1086;&#1084;
masm. &#1040; &#1074;&#1089;&#1077;, &#1095;&#1090;&#1086; &#1074;&#1085;&#1077;
(&#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1091; <i>goto make</i> &#1080;
&#1084;&#1077;&#1090;&#1082;&#1091; <i>:make</i>),
&#1080;&#1075;&#1085;&#1086;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1086;&#1084;
masm, &#1085;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1085;&#1099;&#1084;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1086;&#1084;.
&#1069;&#1090;&#1086;&#1090; &#1084;&#1077;&#1090;&#1086;&#1076;
&#1095;&#1088;&#1077;&#1079;&#1074;&#1099;&#1095;&#1072;&#1081;&#1085;&#1086;
&#1091;&#1076;&#1086;&#1073;&#1077;&#1085;, &#1090;.&#1082;.
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081;
&#1090;&#1077;&#1082;&#1089;&#1090; &quot;&#1087;&#1086;&#1084;&#1085;&#1080;&#1090;&quot;
&#1089; &#1082;&#1072;&#1082;&#1080;&#1084;&#1080;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1084;&#1080;
&#1077;&#1075;&#1086; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;.
&#1071; &#1073;&#1091;&#1076;&#1091;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1103;&#1090;&#1100;
&#1090;&#1072;&#1082;&#1091;&#1102;
&#1090;&#1077;&#1093;&#1085;&#1080;&#1082;&#1091; &#1074;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1093;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;, &#1072; &#1074;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1093;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;,
&#1073;&#1091;&#1076;&#1091;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1086;&#1073;&#1099;&#1095;&#1085;&#1099;&#1084;
&#1084;&#1077;&#1090;&#1086;&#1076;&#1086;&#1084;.
<p>&#1055;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1082;&#1080;
&#1080;&#1084;&#1077;&#1102;&#1090;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1089;&#1084;&#1099;&#1089;&#1083;:
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font face="Courier New">/driver</font></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1059;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
        &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;&#1091;,
        &#1095;&#1090;&#1086; &#1085;&#1091;&#1078;&#1085;&#1086;
        &#1089;&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1092;&#1072;&#1081;&#1083;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
        Windows NT;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font face="Courier New">/base:0x10000</font></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1059;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1090;
        &#1087;&#1088;&#1077;&#1076;&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;
        &#1072;&#1076;&#1088;&#1077;&#1089;
        &#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
        &#1086;&#1073;&#1088;&#1072;&#1079;&#1072;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
        &#1088;&#1072;&#1074;&#1085;&#1099;&#1084; 10000h. &#1071;
        &#1091;&#1078;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;
        &#1087;&#1088;&#1086; &#1101;&#1090;&#1086; &#1074;
        &#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1081;
        &#1089;&#1090;&#1072;&#1090;&#1100;&#1077;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font face="Courier New">/align:32</font></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1055;&#1072;&#1084;&#1103;&#1090;&#1100;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
        -
        &#1076;&#1088;&#1072;&#1075;&#1086;&#1094;&#1077;&#1085;&#1085;&#1099;&#1081;
        &#1088;&#1077;&#1089;&#1091;&#1088;&#1089;.
        &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
        &#1092;&#1072;&#1081;&#1083;&#1099;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;
        &#1080;&#1084;&#1077;&#1102;&#1090; &#1073;&#1086;&#1083;&#1077;&#1077;
        &quot;&#1084;&#1077;&#1083;&#1082;&#1086;&#1077;&quot;
        &#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;
        &#1089;&#1077;&#1082;&#1094;&#1080;&#1081;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font face="Courier New">/out:driver.sys</font></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1055;&#1086;
        &#1091;&#1084;&#1086;&#1083;&#1095;&#1072;&#1085;&#1080;&#1102;
        &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;
        &#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1090;
        &#1092;&#1072;&#1081;&#1083;&#1099; &#1089;
        &#1088;&#1072;&#1089;&#1096;&#1080;&#1088;&#1077;&#1085;&#1080;&#1077;&#1084;
        .exe. &#1055;&#1088;&#1080;
        &#1085;&#1072;&#1083;&#1080;&#1095;&#1080;&#1080;
        &#1082;&#1083;&#1102;&#1095;&#1072; /dll &#1092;&#1072;&#1081;&#1083;
        &#1073;&#1091;&#1076;&#1077;&#1090; &#1080;&#1084;&#1077;&#1090;&#1100;
        &#1088;&#1072;&#1089;&#1096;&#1080;&#1088;&#1077;&#1085;&#1080;&#1077; .dll.
        &#1053;&#1072;&#1084; &#1085;&#1091;&#1078;&#1085;&#1086;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
        &#1092;&#1072;&#1081;&#1083; &#1089;
        &#1088;&#1072;&#1089;&#1096;&#1088;&#1077;&#1085;&#1080;&#1077;&#1084; .sys;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font face="Courier New">/subsystem:native</font></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1042; PE-&#1079;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;&#1082;&#1077;
        &#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
        &#1087;&#1086;&#1083;&#1077;,
        &#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1077;
        &#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1095;&#1080;&#1082;&#1091;
        &#1086;&#1073;&#1088;&#1072;&#1079;&#1072;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1084;&#1086;&#1075;&#1086;
        &#1092;&#1072;&#1081;&#1083;&#1072;, &#1076;&#1083;&#1103;
        &#1082;&#1072;&#1082;&#1086;&#1081;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;
        &#1101;&#1090;&#1086;&#1090; &#1092;&#1072;&#1081;&#1083;
        &#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;:
        Win32, POSIX &#1080;&#1083;&#1080; OS/2. &#1069;&#1090;&#1086;
        &#1085;&#1091;&#1078;&#1085;&#1086; &#1076;&#1083;&#1103;
        &#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086;&#1073;&#1099;
        &#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100;
        &#1086;&#1073;&#1088;&#1072;&#1079; &#1074;
        &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1077;
        &#1077;&#1084;&#1091;
        &#1086;&#1082;&#1088;&#1091;&#1078;&#1077;&#1085;&#1080;&#1077;.
        &#1055;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        Win32
        &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
        &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1077;&#1090;&#1089;&#1103;
        &#1087;&#1088;&#1080;
        &#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1077;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;.
        &#1045;&#1089;&#1083;&#1080; &#1078;&#1077;
        &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1077;&#1090;&#1089;&#1103;
        &#1092;&#1072;&#1081;&#1083;,
        &#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1099;&#1081;
        &#1076;&#1083;&#1103;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;,
        &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1074;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
        POSIX, &#1090;&#1086; &#1089;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1072;&#1103;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1077;&#1090;
        &#1089;&#1072;&#1084;&#1091;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1091;
        POSIX. &#1058;&#1072;&#1082;&#1080;&#1084;
        &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1089;
        &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
        &#1101;&#1090;&#1086;&#1075;&#1086; &#1082;&#1083;&#1102;&#1095;&#1072;
        &#1084;&#1086;&#1078;&#1085;&#1086;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;
        &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;&#1091;,
        &#1082;&#1072;&#1082;&#1072;&#1103;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1072;.
        &#1050;&#1086;&#1075;&#1076;&#1072; &#1084;&#1099;
        &#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1091;&#1077;&#1084;
        *.exe &#1080;&#1083;&#1080; *.dll, &#1090;&#1086;
        &#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;
        &#1087;&#1086;&#1076; &#1101;&#1090;&#1080;&#1084;
        &#1082;&#1083;&#1102;&#1095;&#1077;&#1084;
        &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; windows,
        &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
        &#1086;&#1079;&#1085;&#1072;&#1095;&#1072;&#1077;&#1090;,
        &#1095;&#1090;&#1086; &#1092;&#1072;&#1081;&#1083;&#1091;
        &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        Win32. &#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
        &#1074;&#1086;&#1086;&#1073;&#1097;&#1077; &#1085;&#1077;
        &#1085;&#1091;&#1078;&#1085;&#1072; &#1085;&#1080;
        &#1086;&#1076;&#1085;&#1072; &#1080;&#1079;
        &#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;, &#1090;.&#1082;.
        &#1086;&#1085; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090;
        &#1074; <i>&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1081;</i>
        (native) &#1076;&#1083;&#1103; &#1089;&#1072;&#1084;&#1086;&#1081;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1086;&#1081;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;
        &#1089;&#1088;&#1077;&#1076;&#1077;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica"><br>
<br>
<br>
<p><strong>&#1057;&#1072;&#1084;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;</strong>
<p>&#1042;&#1086;&#1090;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081;
&#1090;&#1077;&#1082;&#1089;&#1090;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1077;&#1075;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;.
<p><code><!--mstheme--></font>
<pre><font size="2"><b> ;@echo off
 ;goto make

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;
 ; simplest - &#1057;&#1072;&#1084;&#1099;&#1081; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
 ;
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .386
 .model flat, stdcall
 option casemap:none

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                              &#1042; &#1050; &#1051; &#1070; &#1063; &#1040; &#1045; &#1052; &#1067; &#1045;    &#1060; &#1040; &#1049; &#1051; &#1067;                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 include \masm32\include\w2k\ntstatus.inc
 include \masm32\include\w2k\ntddk.inc

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                              &#1050; &#1054; &#1044;                                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                       DriverEntry                                                 
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DriverEntry proc pDriverObject:PDRIVER_OBJECT, pusRegistryPath:PUNICODE_STRING

     mov eax, STATUS_DEVICE_CONFIGURATION_ERROR
     ret

 DriverEntry endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                                                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 end DriverEntry

 :make
 \masm32\bin\ml /nologo /c /coff simplest.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:simplest.sys /subsystem:native simplest.obj

 del simplest.obj

 echo.
 pause
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050;&#1072;&#1082; &#1080; &#1091;
&#1083;&#1102;&#1073;&#1086;&#1075;&#1086;
&#1076;&#1088;&#1091;&#1075;&#1086;&#1075;&#1086;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1084;&#1086;&#1075;&#1086;
&#1084;&#1086;&#1076;&#1091;&#1083;&#1103;, &#1091;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1072; &#1073;&#1099;&#1090;&#1100;
&#1090;&#1086;&#1095;&#1082;&#1072; &#1074;&#1093;&#1086;&#1076;&#1072;,
&#1085;&#1072; &#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1089;&#1090;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1086;&#1089;&#1083;&#1077;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;. &#1050;&#1072;&#1082; &#1080;
&#1087;&#1086;&#1083;&#1072;&#1075;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1077; &#1085;&#1072;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;,
&#1090;&#1086;&#1095;&#1082;&#1086;&#1081; &#1074;&#1093;&#1086;&#1076;&#1072;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1087;&#1077;&#1088;&#1074;&#1072;&#1103;
&#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1103;,
&#1086;&#1073;&#1086;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1084;&#1077;&#1090;&#1082;&#1086;&#1081;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1085;&#1085;&#1086;&#1081; &#1074;
&#1076;&#1080;&#1088;&#1077;&#1082;&#1090;&#1080;&#1074;&#1077; end. &#1059;
&#1085;&#1072;&#1089;, &#1082;&#1072;&#1082; &#1080; &#1074;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093; &#1085;&#1072; &#1089;,
&#1101;&#1090;&#1086; DriverEntry,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103;
&#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1077;&#1085;&#1072; &#1074;
&#1074;&#1080;&#1076;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;,
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1102;&#1097;&#1077;&#1081;
&#1076;&#1074;&#1072;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;.
&#1048;&#1084;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1083;&#1102;&#1073;&#1099;&#1084;.
&#1055;&#1088;&#1086;&#1090;&#1086;&#1090;&#1080;&#1087; DriverEntry
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1080;&#1090; &#1090;&#1072;&#1082;:
<p><code><!--mstheme--></font>
<pre><b><font size="2"> DriverEntry proto DriverObject:PDRIVER_OBJECT, RegistryPath:PUNICODE_STRING</font></b>

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050; &#1089;&#1086;&#1078;&#1072;&#1083;&#1077;&#1085;&#1080;&#1102;,
Microsoft &#1086;&#1090;&#1086;&#1096;&#1083;&#1072; &#1086;&#1090;
&#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1072; &quot;&#1074;&#1077;&#1085;&#1075;&#1077;&#1088;&#1089;&#1082;&#1086;&#1081;
&#1085;&#1086;&#1090;&#1072;&#1094;&#1080;&#1080;&quot; &#1087;&#1088;&#1080;
&#1089;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1080;
&#1079;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;&#1086;&#1095;&#1085;&#1099;&#1093;
&#1092;&#1072;&#1081;&#1083;&#1086;&#1074; &#1080;
&#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1080;
DDK. &#1042;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;,
&#1101;&#1090;&#1086; &#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1086; &#1089;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1084;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;&#1084;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1092;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1093;
&#1090;&#1080;&#1087;&#1086;&#1074; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1099;&#1093;
&#1074; DDK. &#1061;&#1086;&#1090;&#1103;, &#1074;
&#1086;&#1073;&#1086;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1080;
&#1090;&#1080;&#1087;&#1086;&#1074; &#1082;&#1086;&#1077;-&#1095;&#1090;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1086;&#1089;&#1100;. &#1042;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1093;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093; &#1103;
&#1073;&#1091;&#1076;&#1091;
&#1087;&#1088;&#1080;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1072;
&#1074;&#1077;&#1079;&#1076;&#1077;, &#1075;&#1076;&#1077;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;, &#1090;.&#1082;.
&#1085;&#1072;&#1089;&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1087;&#1088;&#1080;&#1074;&#1099;&#1082; &#1080;&#1084;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;,
&#1095;&#1090;&#1086;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1080;&#1082;&#1080; &#1085;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1097;&#1080;&#1077;
&quot;&#1074;&#1077;&#1085;&#1075;&#1077;&#1088;&#1089;&#1082;&#1091;&#1102;
&#1085;&#1086;&#1090;&#1072;&#1094;&#1080;&#1102;&quot; &#1084;&#1085;&#1077;
&#1082;&#1072;&#1078;&#1091;&#1090;&#1089;&#1103;
&#1089;&#1086;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1086;
&#1085;&#1077;&#1095;&#1080;&#1090;&#1072;&#1073;&#1077;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;,
&#1083;&#1077;&#1075;&#1082;&#1080;&#1084;
&#1076;&#1074;&#1080;&#1078;&#1077;&#1085;&#1080;&#1077;&#1084;
&#1088;&#1091;&#1082;&#1080;, DriverObject
&#1087;&#1088;&#1077;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074; pDriverObject, &#1072; RegistryPath &#1074; pusRegistryPath.
<p>&#1058;&#1080;&#1087;&#1099; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
PDRIVER_OBJECT &#1080; PUNICODE_STRING
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1072;&#1093; \include\w2k\ntddk.inc &#1080; \include\w2k\ntdef.inc
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;.
<p><code><!--mstheme--></font>
<pre> PDRIVER_OBJECT   typedef PTR DRIVER_OBJECT
 PUNICODE_STRING  typedef PTR UNICODE_STRING

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pDriverObject</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
        &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1095;&#1090;&#1086;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
        <p>Windows &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1081;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1086;&#1081;.
        &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
        &#1087;&#1086;&#1085;&#1103;&#1090;&#1080;&#1077;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
        &#1088;&#1072;&#1089;&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1085;&#1072; &#1074;&#1089;&#1077;, &#1095;&#1090;&#1086;
        &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
        &#1084;&#1086;&#1078;&#1085;&#1086;, &#1080; &#1095;&#1090;&#1086;
        &#1085;&#1077;&#1083;&#1100;&#1079;&#1103; &#1090;&#1086;&#1078;&#1077;.
        &#1048; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;
        &#1085;&#1077; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;.
        &#1047;&#1072;&#1075;&#1088;&#1091;&#1078;&#1072;&#1103;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;,
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1077;&#1090; <i>&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
        &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;</i> (driver
        object),
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
        &#1076;&#1083;&#1103; &#1085;&#1077;&#1077;
        &#1086;&#1073;&#1088;&#1072;&#1079;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1074;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;.
        &#1063;&#1077;&#1088;&#1077;&#1079; &#1101;&#1090;&#1086;&#1090;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;.
        &#1047;&#1074;&#1091;&#1095;&#1080;&#1090;
        &#1082;&#1088;&#1072;&#1089;&#1080;&#1074;&#1086;, &#1085;&#1086;
        &#1085;&#1077; &#1076;&#1072;&#1077;&#1090;
        &#1085;&#1080;&#1082;&#1072;&#1082;&#1086;&#1075;&#1086;
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
        &#1086; &#1090;&#1086;&#1084;, &#1095;&#1090;&#1086; &#1078;&#1077;
        &#1074;
        &#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1080;
        &#1087;&#1088;&#1086;&#1080;&#1089;&#1093;&#1086;&#1076;&#1080;&#1090;.
        &#1045;&#1089;&#1083;&#1080;
        &#1086;&#1090;&#1073;&#1088;&#1086;&#1089;&#1080;&#1090;&#1100;
        &#1074;&#1089;&#1102; &#1101;&#1090;&#1091;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1091;&#1102;
        &#1084;&#1080;&#1096;&#1091;&#1088;&#1091;, &#1090;&#1086;
        &#1089;&#1090;&#1072;&#1085;&#1077;&#1090;
        &#1086;&#1095;&#1077;&#1074;&#1080;&#1076;&#1085;&#1086;,
        &#1095;&#1090;&#1086; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
        &#1089;&#1086;&#1073;&#1086;&#1081;
        &#1086;&#1073;&#1099;&#1082;&#1085;&#1086;&#1074;&#1077;&#1085;&#1085;&#1091;&#1102;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
        &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1090;&#1080;&#1087;&#1072;
        DRIVER_OBJECT (&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072;
        &#1074; \include\w2k\ntddk.inc).
        &#1053;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
        &#1087;&#1086;&#1083;&#1103; &#1101;&#1090;&#1086;&#1081;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
        &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;,
        &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
        &#1087;&#1088;&#1080;&#1076;&#1077;&#1090;&#1089;&#1103;
        &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;
        &#1085;&#1072;&#1084; &#1089;&#1072;&#1084;&#1080;&#1084;.
        &#1054;&#1073;&#1088;&#1072;&#1097;&#1072;&#1103;&#1089;&#1100; &#1082;
        &#1101;&#1090;&#1086;&#1081;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1077;,
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1080;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;.
        &#1048;&#1090;&#1072;&#1082;, &#1082;&#1072;&#1082; &#1074;&#1099;
        &#1085;&#1072;&#1074;&#1077;&#1088;&#1085;&#1086;&#1077;
        &#1091;&#1078;&#1077; &#1087;&#1086;&#1085;&#1103;&#1083;&#1080;,
        &#1087;&#1077;&#1088;&#1074;&#1099;&#1084;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084;,
        &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1102;&#1097;&#1080;&#1084;&#1089;&#1103;
        &#1074; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; DriverEntry,
        &#1082;&#1072;&#1082; &#1088;&#1072;&#1079; &#1080;
        &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1101;&#1090;&#1091; &#1089;&#1072;&#1084;&#1091;&#1102;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; (&#1080;&#1083;&#1080;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;&#1089;&#1100;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1081;
        &#1090;&#1077;&#1088;&#1084;&#1080;&#1085;&#1086;&#1083;&#1086;&#1075;&#1080;&#1077;&#1081;
        - &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;).
        &#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
        &#1101;&#1090;&#1086;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;,
        &#1084;&#1099; &#1084;&#1086;&#1078;&#1077;&#1084; (&#1080;
        &#1073;&#1091;&#1076;&#1077;&#1084;, &#1085;&#1086;
        &#1087;&#1086;&#1079;&#1078;&#1077;)
        &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
        &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077;
        &#1087;&#1086;&#1083;&#1103;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
        DRIVER_OBJECT. &#1053;&#1086;, &#1074;
        &#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1077;&#1084;&#1099;&#1093;
        &#1074; &#1101;&#1090;&#1086;&#1081; &#1095;&#1072;&#1089;&#1090;&#1080;
        &#1089;&#1090;&#1072;&#1090;&#1100;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;&#1093;
        &#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1077;
        &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;,
        &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1084;&#1099;,
        &#1087;&#1086;&#1082;&#1072;,
        &#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1084; <i>pDriverObject</i>
        &#1073;&#1077;&#1079;
        &#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1103;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pusRegistryPath</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;
        &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;,
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1080;&#1081;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
        &#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
        &#1055;&#1088;&#1086; &#1101;&#1090;&#1086;&#1090;
        &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;, &#1084;&#1099;
        &#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
        &#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
        &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1080; &#1074;
        &#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;.
        <p>&#1058;&#1086;&#1095;&#1085;&#1077;&#1077;
        &#1075;&#1086;&#1074;&#1086;&#1088;&#1103;, &#1101;&#1090;&#1086;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
        &#1090;&#1080;&#1087;&#1072; UNICODE_STRING. &#1040;
        &#1091;&#1078;&#1077; &#1074; &#1085;&#1077;&#1081;
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;&#1089;&#1103;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1089;&#1072;&#1084;&#1091; Unicode-&#1089;&#1090;&#1088;&#1086;&#1082;&#1091;,
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1091;&#1102;
        &#1080;&#1084;&#1103; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1072;.
        &#1069;&#1090;&#1086;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
        &#1084;&#1086;&#1078;&#1077;&#1090;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1076;&#1083;&#1103;
        &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; (&#1080;&#1083;&#1080;
        &#1080;&#1079;&#1074;&#1083;&#1077;&#1095;&#1077;&#1085;&#1080;&#1103;,
        &#1074; &#1095;&#1077;&#1084; &#1084;&#1099;
        &#1086;&#1095;&#1077;&#1085;&#1100; &#1089;&#1082;&#1086;&#1088;&#1086;
        &#1091;&#1073;&#1077;&#1076;&#1080;&#1084;&#1089;&#1103;) &#1074;
        &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;
        &#1082;&#1072;&#1082;&#1086;&#1081;-&#1083;&#1080;&#1073;&#1086;
        &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080;,
        &#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102; &#1086;&#1085;
        &#1089;&#1084;&#1086;&#1078;&#1077;&#1090; &#1074;
        &#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1077;&#1084;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;.
        &#1042; &#1101;&#1090;&#1086;&#1084;
        &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
        &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;
        &#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
        &#1087;&#1091;&#1090;&#1100; &#1082;
        &#1087;&#1086;&#1076;&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1091;
        &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;, &#1085;&#1086;
        &#1085;&#1077; &#1089;&#1072;&#1084;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;, &#1090;.&#1082;.
        &#1087;&#1086; &#1074;&#1099;&#1093;&#1086;&#1076;&#1091; &#1080;&#1079;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
        DriverEntry &#1086;&#1085;
        &#1087;&#1086;&#1090;&#1077;&#1088;&#1103;&#1077;&#1090;
        &#1074;&#1089;&#1103;&#1082;&#1080;&#1081;
        &#1089;&#1084;&#1099;&#1089;&#1083;. &#1053;&#1086;,
        &#1086;&#1073;&#1099;&#1095;&#1085;&#1086;
        &#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1077;
        &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1054; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093; UNICODE_STRING
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;
&#1086;&#1089;&#1086;&#1073;&#1086;. &#1042;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1080;&#1077; &#1086;&#1090;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1088;&#1077;&#1078;&#1080;&#1084; &#1103;&#1076;&#1088;&#1072;
&#1086;&#1087;&#1077;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080; &#1074;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077; UNICODE_STRING.
&#1069;&#1090;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1077; \include\w2k\ntdef.inc
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;:
<p><code><!--mstheme--></font>
<pre> UNICODE_STRING STRUCT
     woLength        WORD    ?  ; &#1076;&#1083;&#1080;&#1085;&#1072; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1074; &#1073;&#1072;&#1081;&#1090;&#1072;&#1093; (&#1085;&#1077; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072;&#1093;)
     MaximumLength   WORD    ?  ; &#1076;&#1083;&#1080;&#1085;&#1072; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1077;&#1075;&#1086; &#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1074; &#1073;&#1072;&#1081;&#1090;&#1072;&#1093; (&#1085;&#1077; &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072;&#1093;)
     Buffer          PWSTR   ?  ; &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072; &#1073;&#1091;&#1092;&#1077;&#1088; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1080;&#1081; &#1089;&#1090;&#1088;&#1086;&#1082;&#1091;
 UNICODE_STRING ENDS

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>woLength</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- (&#1084;&#1085;&#1077;
        &#1087;&#1088;&#1080;&#1096;&#1083;&#1086;&#1089;&#1100;
        &#1080;&#1079;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100;
        &#1086;&#1088;&#1080;&#1075;&#1080;&#1085;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077;
        &#1080;&#1084;&#1103; Length, &#1090;.&#1082;. &#1086;&#1085;&#1086;
        &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1079;&#1072;&#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1084;
        &#1089;&#1083;&#1086;&#1074;&#1086;&#1084;)
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
        &#1090;&#1077;&#1082;&#1091;&#1097;&#1091;&#1102;
        &#1076;&#1083;&#1080;&#1085;&#1091;
        &#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1074;
        &#1073;&#1072;&#1081;&#1090;&#1072;&#1093; (&#1085;&#1077; &#1074;
        &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072;&#1093;!),
        &#1085;&#1077; &#1089;&#1095;&#1080;&#1090;&#1072;&#1103;
        &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1085;&#1091;&#1083;&#1103;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>MaximumLength</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
        &#1073;&#1091;&#1092;&#1077;&#1088;&#1072; (&#1090;&#1072;&#1082;&#1078;&#1077;
        &#1074; &#1073;&#1072;&#1081;&#1090;&#1072;&#1093;), &#1074;
        &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084; &#1101;&#1090;&#1072;
        &#1089;&#1090;&#1088;&#1086;&#1082;&#1072;
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;&#1089;&#1103;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>Buffer</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1089;&#1072;&#1084;&#1091; Unicode-&#1089;&#1090;&#1088;&#1086;&#1082;&#1091;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1043;&#1083;&#1072;&#1074;&#1085;&#1086;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1086;&#1080;&#1085;&#1089;&#1090;&#1074;&#1086;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1072; &#1074; &#1090;&#1086;&#1084;,
&#1095;&#1090;&#1086; &#1086;&#1085; &#1103;&#1074;&#1085;&#1086;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;,
&#1082;&#1072;&#1082; &#1090;&#1077;&#1082;&#1091;&#1097;&#1091;&#1102;
&#1076;&#1083;&#1080;&#1085;&#1091; &#1089;&#1090;&#1088;&#1086;&#1082;&#1080;,
&#1090;&#1072;&#1082; &#1080; &#1077;&#1077;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1091;&#1102;
&#1076;&#1083;&#1080;&#1085;&#1091;. &#1069;&#1090;&#1086;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1077;&#1090;,
&#1087;&#1088;&#1080;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103;&#1093; &#1089;
&#1090;&#1072;&#1082;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1086;&#1081;,
&#1086;&#1073;&#1086;&#1081;&#1090;&#1080;&#1089;&#1100; &#1073;&#1077;&#1079;
&#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1074;&#1099;&#1095;&#1080;&#1089;&#1083;&#1077;&#1085;&#1080;&#1081;.
<p>&#1055;&#1086;&#1095;&#1077;&#1084;&#1091; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091; DriverEntry
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086; &#1101;&#1090;&#1080;
&#1076;&#1074;&#1072;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1103;?
&#1055;&#1086;&#1090;&#1086;&#1084;&#1091;, &#1095;&#1090;&#1086;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1085;&#1080;&#1084; (&#1086;&#1089;&#1086;&#1073;&#1077;&#1085;&#1085;&#1086;
&#1082; &#1087;&#1077;&#1088;&#1074;&#1086;&#1084;&#1091;)
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1083;&#1102;&#1095;&#1077;&#1074;&#1099;&#1084;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;&#1086;&#1084; &#1074;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1080;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1078;&#1080;&#1079;&#1085;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
&#1055;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1077; &#1086;&#1073;
&#1101;&#1090;&#1086;&#1084; &#1084;&#1099;
&#1087;&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1084; &#1074;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1093;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1103;&#1093;. &#1055;&#1086;&#1082;&#1072;
&#1078;&#1077;, &#1084;&#1099;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1077;&#1081;&#1096;&#1080;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1099;,
&#1074;&#1088;&#1077;&#1084;&#1103; &#1078;&#1080;&#1079;&#1085;&#1080;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;,
&#1086;&#1075;&#1088;&#1072;&#1085;&#1080;&#1095;&#1077;&#1085;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1077;&#1084;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099; DriverEntry.
&#1063;&#1090;&#1086; &#1078;&#1077; &#1084;&#1099;
&#1084;&#1086;&#1078;&#1077;&#1084; &#1090;&#1091;&#1090;
&#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1086;&#1075;&#1086; (&#1080;&#1083;&#1080;
&#1074;&#1088;&#1077;&#1076;&#1085;&#1086;&#1075;&#1086;)
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;? &#1053;&#1091;,
&#1074;&#1088;&#1077;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1093;&#1086;&#1090;&#1100;
&#1086;&#1090;&#1073;&#1072;&#1074;&#1083;&#1103;&#1081;. &#1052;&#1099;
&#1074;&#1077;&#1076;&#1100; &#1091;&#1078;&#1077; &#1074;
&#1085;&#1091;&#1083;&#1077;&#1074;&#1086;&#1084;
&#1082;&#1086;&#1083;&#1100;&#1094;&#1077;
&#1079;&#1072;&#1097;&#1080;&#1090;&#1099;. &#1052;&#1086;&#1078;&#1085;&#1086;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
&#1090;&#1072;&#1082;&#1086;&#1081; &#1082;&#1086;&#1076;:
<p><code><!--mstheme--></font>
<pre> xor eax, eax
 xchg [eax], eax

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1069;&#1090;&#1086;
&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1090; &#1082;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1082;&#1077;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099; &#1080;
&#1087;&#1086;&#1103;&#1074;&#1083;&#1077;&#1085;&#1080;&#1102; BSOD (Blue
Screen Of Death). &#1040;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077;
&#1090;&#1072;&#1082;&#1086;&#1075;&#1086; &#1082;&#1086;&#1076;&#1072;
&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1090; &#1082;
&#1087;&#1077;&#1088;&#1077;&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1077;
&#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1072;:
<p><code><!--mstheme--></font>
<pre> mov al, 0FEh
 out 64h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1072;&#1082;&#1086;&#1081;
&#1088;&#1072;&#1076;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;,
&#1087;&#1088;&#1077;&#1088;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1091;
&#1080;&#1089;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;,
&#1080;&#1085;&#1086;&#1075;&#1076;&#1072;
&#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1079;&#1072;&#1097;&#1080;&#1090;&#1072;&#1093;.
&#1063;&#1077;&#1089;&#1090;&#1085;&#1086;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1103;, &#1103; &#1080;
&#1089;&#1072;&#1084; &#1085;&#1072; &#1101;&#1090;&#1086; &#1085;&#1077;
&#1088;&#1072;&#1079;
&#1087;&#1086;&#1087;&#1072;&#1076;&#1072;&#1083;&#1089;&#1103; ;-)
<p>&#1042; &#1101;&#1090;&#1080;&#1093; &#1076;&#1074;&#1091;&#1093;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1103;&#1093;,
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072; DriverEntry
&#1085;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1077;
&#1074;&#1077;&#1088;&#1085;&#1077;&#1090;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;&#1086;&#1077;
&#1077;&#1081; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1085;&#1077; &#1074;&#1072;&#1078;&#1085;&#1086;. &#1045;&#1089;&#1083;&#1080;
&#1078;&#1077; &#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1084;&#1099;&#1077;
DriverEntry &#1073;&#1091;&#1076;&#1091;&#1090;
&#1073;&#1086;&#1083;&#1077;&#1077;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1080;&#1074;&#1085;&#1099;&#1084;&#1080;,
&#1082;&#1072;&#1082;, &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1074; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077; beeper.sys,
&#1090;&#1086; &#1085;&#1072;&#1076;&#1086;
&#1074;&#1077;&#1088;&#1085;&#1091;&#1090;&#1100;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1085;&#1077;&#1082;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;,
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1077;
&#1085;&#1072; &#1090;&#1086;, &#1082;&#1072;&#1082;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
&#1045;&#1089;&#1083;&#1080; &#1074;&#1077;&#1088;&#1085;&#1091;&#1090;&#1100;
STATUS_SUCCESS, &#1090;&#1086;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1089;&#1095;&#1080;&#1090;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1081;, &#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1086;&#1089;&#1090;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1051;&#1102;&#1073;&#1086;&#1077;
&#1076;&#1088;&#1091;&#1075;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; STATUS_*
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090; &#1085;&#1072;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1091;, &#1080; &#1074;
&#1101;&#1090;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1078;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1086;&#1081;.
&#1042;&#1099;&#1096;&#1077;&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; (\src\Article2-3\simplest\simplest.sys)
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1072;&#1084;&#1099;&#1084;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1099;&#1084;,
&#1082;&#1072;&#1082;&#1086;&#1081; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1089;&#1077;&#1073;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100;.
&#1045;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1077;
&#1095;&#1090;&#1086; &#1086;&#1085; &#1076;&#1077;&#1083;&#1072;&#1077;&#1090;,
&#1101;&#1090;&#1086;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1077;&#1073;&#1103;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1080;&#1090;&#1100;. &#1058;.&#1082;.
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1082;&#1088;&#1086;&#1084;&#1077;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1086;&#1085;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077; &#1085;&#1077;
&#1084;&#1086;&#1078;&#1077;&#1090;, &#1090;&#1086;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1082;&#1086;&#1076; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080;
STATUS_DEVICE_CONFIGURATION_ERROR. &#1071;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;
&#1087;&#1086;&#1076;&#1086;&#1073;&#1088;&#1072;&#1083;
&#1087;&#1086;&#1076;&#1093;&#1086;&#1076;&#1103;&#1097;&#1077;&#1077;
&#1087;&#1086; &#1089;&#1084;&#1099;&#1089;&#1083;&#1091;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; (&#1087;&#1086;&#1083;&#1085;&#1099;&#1081;
&#1089;&#1087;&#1080;&#1089;&#1086;&#1082; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100; &#1074;
&#1092;&#1072;&#1081;&#1083;&#1077; \include\w2k\ntstatus.inc).
&#1045;&#1089;&#1083;&#1080;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1090;&#1080;&#1090;&#1100;
STATUS_SUCCESS, &#1090;&#1086; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1090;&#1072;&#1082; &#1080;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1077;&#1090;&#1089;&#1103;
&#1073;&#1086;&#1083;&#1090;&#1072;&#1090;&#1100;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1073;&#1077;&#1079;
&#1076;&#1077;&#1083;&#1072;, &#1080;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086;
&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1072;&#1084;&#1080; SCM
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1085;&#1077;&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;, &#1090;.&#1082;.
&#1084;&#1099; &#1085;&#1077;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091;
&#1086;&#1090;&#1074;&#1077;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102;
&#1079;&#1072; &#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1091;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;. &#1069;&#1090;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1072;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1100;&#1089;&#1103; &#1074;
&#1089;&#1072;&#1084;&#1086;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077;. &#1054;&#1085;&#1072;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;,
&#1079;&#1077;&#1088;&#1082;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1087;&#1086; &#1086;&#1090;&#1085;&#1086;&#1096;&#1077;&#1085;&#1080;&#1102;
&#1082; DriverEntry. &#1045;&#1089;&#1083;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1080;&#1083; &#1089;&#1077;&#1073;&#1077;
&#1082;&#1072;&#1082;&#1080;&#1077;-&#1090;&#1086;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1099;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;, &#1090;&#1086; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080; &#1101;&#1090;&#1072;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1072; &#1073;&#1099;&#1090;&#1100;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1077;&#1085;&#1072;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;. &#1048;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1089;&#1072;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1079;&#1085;&#1072;&#1077;&#1090; &#1086;&#1073; &#1101;&#1090;&#1086;&#1084;.
&#1053;&#1086;, &#1090;&#1091;&#1090; &#1103;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1079;&#1072;&#1073;&#1077;&#1078;&#1072;&#1083;
&#1074;&#1087;&#1077;&#1088;&#1077;&#1076;. &#1055;&#1086;&#1082;&#1072;
&#1085;&#1072;&#1084; &#1101;&#1090;&#1086; &#1085;&#1077;
&#1087;&#1086;&#1085;&#1072;&#1076;&#1086;&#1073;&#1080;&#1090;&#1089;&#1103;.<br>
<br>
<br>
<p><strong>&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
beeper.sys</strong>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1087;&#1077;&#1088;&#1077;&#1081;&#1076;&#1077;&#1084; &#1082;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1080;&#1102;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;,
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084;, &#1084;&#1099;
&#1087;&#1080;&#1089;&#1072;&#1083;&#1080; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;.
&#1052;&#1085;&#1077; &#1087;&#1088;&#1080;&#1096;&#1083;&#1086;&#1089;&#1100;
&#1087;&#1077;&#1088;&#1077;&#1080;&#1084;&#1077;&#1085;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1077;&#1075;&#1086; &#1080;&#1079; beep.sys &#1074; beeper.sys,
&#1087;&#1086;&#1090;&#1086;&#1084;&#1091; &#1095;&#1090;&#1086;,
&#1082;&#1072;&#1082;
&#1086;&#1082;&#1072;&#1079;&#1072;&#1083;&#1086;&#1089;&#1100;, &#1074; NT4
&#1080; &#1074; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1103;&#1093; XP &#1091;&#1078;&#1077;
&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; beep.sys.
&#1042;&#1086;&#1073;&#1097;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1103;,
beep.sys &#1077;&#1089;&#1090;&#1100; &#1074;&#1086;
&#1074;&#1089;&#1077;&#1093; &#1074;&#1077;&#1088;&#1089;&#1080;&#1103;&#1093;
NT (\%SystemRoot%\System32\Drivers\beep.sys), &#1085;&#1086; &#1086;&#1085;
&#1077;&#1097;&#1077; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1073;&#1099;&#1090;&#1100;
&#1079;&#1072;&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;
&#1074; &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1077;. &#1050;&#1072;&#1082;
&#1073;&#1099; &#1090;&#1072;&#1084; &#1085;&#1080; &#1073;&#1099;&#1083;&#1086;,
&#1085;&#1072;&#1076;&#1077;&#1102;&#1089;&#1100; beeper.sys
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1091;&#1085;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;.
&#1042;&#1086;&#1090; &#1077;&#1075;&#1086;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081;
&#1090;&#1077;&#1082;&#1089;&#1090;:
<p><code><!--mstheme--></font>
<pre><b><font size="2"> ;@echo off
 ;goto make

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;
 ;  beeper - &#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
 ;  &#1055;&#1080;&#1097;&#1080;&#1090; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1084; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1086;&#1084;
 ;
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .386
 .model flat, stdcall
 option casemap:none

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                              &#1042; &#1050; &#1051; &#1070; &#1063; &#1040; &#1045; &#1052; &#1067; &#1045;    &#1060; &#1040; &#1049; &#1051; &#1067;                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 include \masm32\include\w2k\ntstatus.inc
 include \masm32\include\w2k\ntddk.inc

 include \masm32\include\w2k\hal.inc

 includelib \masm32\lib\w2k\hal.lib

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                           &#1057; &#1048; &#1052; &#1042; &#1054; &#1051; &#1068; &#1053; &#1067; &#1045;    &#1050; &#1054; &#1053; &#1057; &#1058; &#1040; &#1053; &#1058; &#1067;                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 TIMER_FREQUENCY        equ 1193167                   ; 1,193,167 &#1043;&#1094;
 OCTAVE                 equ 2                         ; &#1084;&#1085;&#1086;&#1078;&#1080;&#1090;&#1077;&#1083;&#1100; &#1086;&#1082;&#1090;&#1072;&#1074;&#1099;

 PITCH_C                equ 523                       ; &#1044;&#1086;        -  523,25 &#1043;&#1094;
 PITCH_Cs               equ 554                       ; &#1044;&#1086; &#1076;&#1080;&#1077;&#1079;   -  554,37 &#1043;&#1094;
 PITCH_D                equ 587                       ; &#1056;&#1077;        -  587,33 &#1043;&#1094;
 PITCH_Ds               equ 622                       ; &#1056;&#1077; &#1076;&#1080;&#1077;&#1079;   -  622,25 &#1043;&#1094;
 PITCH_E                equ 659                       ; &#1052;&#1080;        -  659,25 &#1043;&#1094;
 PITCH_F                equ 698                       ; &#1060;&#1072;        -  698,46 &#1043;&#1094;
 PITCH_Fs               equ 740                       ; &#1060;&#1072; &#1076;&#1080;&#1077;&#1079;   -  739,99 &#1043;&#1094;
 PITCH_G                equ 784                       ; &#1057;&#1086;&#1083;&#1100;      -  783,99 &#1043;&#1094;
 PITCH_Gs               equ 831                       ; &#1057;&#1086;&#1083;&#1100; &#1076;&#1080;&#1077;&#1079; -  830,61 &#1043;&#1094;
 PITCH_A                equ 880                       ; &#1051;&#1103;        -  880,00 &#1043;&#1094;
 PITCH_As               equ 988                       ; &#1051;&#1103; &#1076;&#1080;&#1077;&#1079;   -  987,77 &#1043;&#1094;
 PITCH_H                equ 1047                      ; &#1057;&#1080;        - 1046,50 &#1043;&#1094;


 ; &#1053;&#1072;&#1084; &#1085;&#1091;&#1078;&#1085;&#1099; &#1090;&#1088;&#1080; &#1079;&#1074;&#1091;&#1082;&#1072; &#1076;&#1083;&#1103; &#1076;&#1086;-&#1084;&#1072;&#1078;&#1086;&#1088;&#1085;&#1086;&#1075;&#1086; &#1072;&#1088;&#1087;&#1077;&#1076;&#1078;&#1080;&#1086; (&#1076;&#1086;, &#1084;&#1080;, &#1089;&#1086;&#1083;&#1100;)

 TONE_1                 equ TIMER_FREQUENCY/(PITCH_C*OCTAVE)
 TONE_2                 equ TIMER_FREQUENCY/(PITCH_E*OCTAVE)
 TONE_3                 equ (PITCH_G*OCTAVE)           ; &#1076;&#1083;&#1103; HalMakeBeep

 DELAY                  equ 1800000h                   ; &#1076;&#1083;&#1103; &#1084;&#1086;&#1077;&#1081; ~800mHz &#1084;&#1072;&#1096;&#1080;&#1085;&#1099;

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                         &#1052; &#1040; &#1050; &#1056; &#1054; &#1057; &#1067;                                             
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DO_DELAY MACRO
     mov eax, DELAY
     .while eax
         dec eax
     .endw
 ENDM

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                              &#1050; &#1054; &#1044;                                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                            MakeBeep1                                              
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 MakeBeep1 proc dwPitch:DWORD

     ; &#1055;&#1088;&#1103;&#1084;&#1086;&#1081; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1086;&#1073;&#1086;&#1088;&#1091;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1102; &#1095;&#1077;&#1088;&#1077;&#1079; &#1087;&#1086;&#1088;&#1090;&#1099; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;

     cli

     mov al, 10110110y
     out 43h, al

     mov eax, dwPitch
     out 42h, al

     mov al, ah
     out 42h, al

     ; &#1074;&#1082;&#1083;&#1102;&#1095;&#1080;&#1090;&#1100; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;

     in al, 61h
     or  al, 11y
     out 61h, al

     sti

     DO_DELAY

     cli

     ; &#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1080;&#1090;&#1100; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;

     in al, 61h
     and al, 11111100y
     out 61h, al

     sti

     ret

 MakeBeep1 endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                            MakeBeep2                                              
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 MakeBeep2 proc dwPitch:DWORD

     ; &#1055;&#1088;&#1103;&#1084;&#1086;&#1081; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1086;&#1073;&#1086;&#1088;&#1091;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1102; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
     ; WRITE_PORT_UCHAR &#1080; READ_PORT_UCHAR &#1080;&#1079; &#1084;&#1086;&#1076;&#1091;&#1083;&#1103; hal.dll

     cli

     invoke WRITE_PORT_UCHAR, 43h, 10110110y

     mov eax, dwPitch
     invoke WRITE_PORT_UCHAR, 42h, al
     mov eax, dwPitch
     invoke WRITE_PORT_UCHAR, 42h, ah

     ; &#1074;&#1082;&#1083;&#1102;&#1095;&#1080;&#1090;&#1100; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;

     invoke READ_PORT_UCHAR, 61h
     or  al, 11y
     invoke WRITE_PORT_UCHAR, 61h, al

     sti

     DO_DELAY	

     cli

     ; &#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1080;&#1090;&#1100; &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;

     invoke READ_PORT_UCHAR, 61h
     and al, 11111100y
     invoke WRITE_PORT_UCHAR, 61h, al

     sti

     ret

 MakeBeep2 endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                       DriverEntry                                                 
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DriverEntry proc pDriverObject:PDRIVER_OBJECT, pusRegistryPath:PUNICODE_STRING

     invoke MakeBeep1, TONE_1
     invoke MakeBeep2, TONE_2

     ; &#1055;&#1088;&#1103;&#1084;&#1086;&#1081; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1086;&#1073;&#1086;&#1088;&#1091;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1102; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; HalMakeBeep &#1080;&#1079; &#1084;&#1086;&#1076;&#1091;&#1083;&#1103; hal.dll

     invoke HalMakeBeep, TONE_3
     DO_DELAY
     invoke HalMakeBeep, 0

     mov eax, STATUS_DEVICE_CONFIGURATION_ERROR
     ret

 DriverEntry endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                                                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 end DriverEntry

 :make
 \masm32\bin\ml /nologo /c /coff beeper.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:beeper.sys /subsystem:native beeper.obj

 del beeper.obj

 echo.
 pause

</font></b></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1076;&#1072;&#1095;&#1072;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100; &#1085;&#1072;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1077;
&#1074;&#1086;&#1089;&#1093;&#1086;&#1076;&#1103;&#1097;&#1077;&#1077;
&#1076;&#1086;-&#1084;&#1072;&#1078;&#1086;&#1088;&#1085;&#1086;&#1077;
&#1072;&#1088;&#1087;&#1077;&#1076;&#1078;&#1080;&#1086;. &#1063;&#1090;&#1086;
&#1101;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077;, &#1074;&#1099;,
&#1085;&#1072;&#1074;&#1077;&#1088;&#1085;&#1086;&#1077; &#1091;&#1078;&#1077;
&#1087;&#1086;&#1089;&#1083;&#1091;&#1096;&#1072;&#1083;&#1080;.
&#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;
&#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1080;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1072; in
&#1080; out, &#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1103;&#1089;&#1100;
&#1082;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1054;&#1073;&#1097;&#1077;&#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1085;&#1086;,
&#1095;&#1090;&#1086; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
- &#1101;&#1090;&#1086; &#1089;&#1074;&#1103;&#1090;&#1086;
&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1077;&#1084;&#1099;&#1081; Windows
NT &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;.
&#1055;&#1086;&#1087;&#1099;&#1090;&#1082;&#1072;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1103; &#1082;
&#1083;&#1102;&#1073;&#1086;&#1084;&#1091; &#1080;&#1079; &#1085;&#1080;&#1093;,
&#1082;&#1072;&#1082; &#1085;&#1072; &#1074;&#1074;&#1086;&#1076;,
&#1090;&#1072;&#1082; &#1080; &#1085;&#1072; &#1074;&#1099;&#1074;&#1086;&#1076;,
&#1080;&#1079; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1085;&#1077;&#1080;&#1079;&#1073;&#1077;&#1078;&#1085;&#1086;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1076;&#1080;&#1090; &#1082;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1102;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;.
&#1053;&#1086;, &#1085;&#1072; &#1089;&#1072;&#1084;&#1086;&#1084;
&#1076;&#1077;&#1083;&#1077;, &#1077;&#1089;&#1090;&#1100;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;
&#1086;&#1073;&#1086;&#1081;&#1090;&#1080; &#1080; &#1101;&#1090;&#1086;
&#1086;&#1075;&#1088;&#1072;&#1085;&#1080;&#1095;&#1077;&#1085;&#1080;&#1077;,
&#1090;.&#1077;.
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1087;&#1088;&#1103;&#1084;&#1086; &#1080;&#1079;
&#1090;&#1088;&#1077;&#1090;&#1100;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1083;&#1100;&#1094;&#1072;. &#1042; &#1101;&#1090;&#1086;&#1084;
&#1074;&#1099; &#1091;&#1073;&#1077;&#1076;&#1080;&#1090;&#1077;&#1089;&#1100;
&#1085;&#1080;&#1078;&#1077;. &#1055;&#1088;&#1072;&#1074;&#1076;&#1072;,
&#1076;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086;,
&#1086;&#1087;&#1103;&#1090;&#1100; &#1090;&#1072;&#1082;&#1080;,
&#1085;&#1091;&#1078;&#1077;&#1085;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;.
<p>&#1053;&#1072;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1085;&#1089;&#1082;&#1086;&#1081;
&#1087;&#1083;&#1072;&#1090;&#1077;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086; <i>&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;</i>,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1087;&#1077;&#1088;&#1077;&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1091;&#1077;&#1084;&#1099;&#1084;.
&#1058;&#1072;&#1081;&#1084;&#1077;&#1088;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1082;&#1072;&#1085;&#1072;&#1083;&#1086;&#1074;, 2-&#1086;&#1081;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1086;&#1084;
&#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1072;,
&#1075;&#1077;&#1085;&#1077;&#1088;&#1080;&#1088;&#1091;&#1103;
&#1087;&#1088;&#1103;&#1084;&#1086;&#1091;&#1075;&#1086;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1080;&#1084;&#1087;&#1091;&#1083;&#1100;&#1089;&#1099; &#1089;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1086;&#1081; 1193180/&lt;<i>&#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;</i>&gt;
&#1075;&#1077;&#1088;&#1094;. <i>&#1053;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;</i>
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; 16-&#1073;&#1080;&#1090;&#1085;&#1099;&#1084;,
&#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1095;&#1077;&#1088;&#1077;&#1079; &#1087;&#1086;&#1088;&#1090; 42h. 1193180
&#1043;&#1094; - &#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1072;
&#1090;&#1072;&#1082;&#1090;&#1086;&#1074;&#1086;&#1075;&#1086;
&#1075;&#1077;&#1085;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;&#1072;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;. &#1058;&#1091;&#1090;
&#1077;&#1089;&#1090;&#1100; &#1086;&#1076;&#1085;&#1072;
&#1090;&#1086;&#1085;&#1082;&#1086;&#1089;&#1090;&#1100;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102; &#1103; &#1085;&#1077;
&#1089;&#1086;&#1074;&#1089;&#1077;&#1084;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1102;.
&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; QueryPerformanceFrequency
&#1080;&#1079; kernel32.dll
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; 1193180.
&#1054;&#1085;&#1086; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;
&#1078;&#1077;&#1089;&#1090;&#1082;&#1086;
&#1079;&#1072;&#1096;&#1080;&#1090;&#1086; &#1074; &#1090;&#1077;&#1083;&#1086;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;. &#1053;&#1086;
&#1076;&#1080;&#1079;&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1080;&#1088;&#1086;&#1074;&#1072;&#1074;
hal.dll, &#1074; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; HalMakeBeep
&#1103; &#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1080;&#1083;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1076;&#1088;&#1091;&#1075;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;,
&#1088;&#1072;&#1074;&#1085;&#1086;&#1077; 1193167 &#1043;&#1094;.
&#1045;&#1075;&#1086; &#1103; &#1080;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;.
&#1042;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;,
&#1079;&#1076;&#1077;&#1089;&#1100; &#1091;&#1095;&#1090;&#1077;&#1085;&#1072;
&#1082;&#1072;&#1082;&#1072;&#1103;-&#1090;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1079;&#1072;&#1076;&#1077;&#1088;&#1078;&#1082;&#1072;, &#1080;&#1083;&#1080;
&#1095;&#1090;&#1086;-&#1090;&#1086;
&#1087;&#1086;&#1076;&#1086;&#1073;&#1085;&#1086;&#1077;. &#1042;
&#1083;&#1102;&#1073;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1087;&#1080;&#1097;&#1072;&#1090;&#1100;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1086;&#1084;
&#1085;&#1072;&#1084; &#1101;&#1090;&#1086; &#1085;&#1080;&#1082;&#1072;&#1082;
&#1085;&#1077; &#1087;&#1086;&#1084;&#1077;&#1096;&#1072;&#1077;&#1090;. &#1071;
&#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1085;&#1072; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1080;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;. &#1069;&#1090;&#1091;
&#1090;&#1077;&#1084;&#1091; &#1086;&#1095;&#1077;&#1085;&#1100;
&#1083;&#1102;&#1073;&#1103;&#1090;
&#1084;&#1091;&#1089;&#1086;&#1083;&#1080;&#1090;&#1100;
&#1087;&#1086;&#1095;&#1090;&#1080; &#1074;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1081;
&#1082;&#1085;&#1080;&#1078;&#1082;&#1077; &#1087;&#1086;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1102;
&#1085;&#1072;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;.
&#1044;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1091;&#1102;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1085;&#1072;&#1081;&#1090;&#1080; &#1074;
&#1089;&#1077;&#1090;&#1080;.
<p>&#1048;&#1090;&#1072;&#1082;, &#1087;&#1077;&#1088;&#1074;&#1099;&#1081;
&#1079;&#1074;&#1091;&#1082; &#1076;&#1086;-&#1084;&#1072;&#1078;&#1086;&#1088;&#1085;&#1086;&#1075;&#1086;
&#1072;&#1088;&#1087;&#1077;&#1076;&#1078;&#1080;&#1086; &#1084;&#1099;
&#1074;&#1086;&#1089;&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1084;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;&#1089;&#1100;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1086;&#1081;
MakeBeep1.
<p><code><!--mstheme--></font>
<pre> mov al, 10110110y
 out 43h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1074;&#1086;&#1076;&#1086;&#1084; &#1074;
&#1087;&#1086;&#1088;&#1090; 43h
&#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1086;&#1075;&#1086;
&#1095;&#1080;&#1089;&#1083;&#1072; 10110110, &#1084;&#1099;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1074;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1102;&#1097;&#1077;&#1077;
&#1085;&#1086;&#1084;&#1077;&#1088; &#1082;&#1072;&#1085;&#1072;&#1083;&#1072;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084; &#1084;&#1099;
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;,
&#1090;&#1080;&#1087; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;,
&#1088;&#1077;&#1078;&#1080;&#1084; &#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1082;&#1072;&#1085;&#1072;&#1083;&#1072; &#1080;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;.
<p><code><!--mstheme--></font>
<pre> mov eax, dwPitch
 out 42h, al

 mov al, ah
 out 42h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1090;&#1077;&#1084;, &#1074; &#1087;&#1086;&#1088;&#1090; 42h
&#1074;&#1099;&#1074;&#1086;&#1076;&#1080;&#1084; 16-&#1073;&#1080;&#1090;&#1085;&#1086;&#1077;
&#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;.
&#1057;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072;
&#1084;&#1083;&#1072;&#1076;&#1096;&#1080;&#1081; &#1073;&#1072;&#1081;&#1090;,
&#1079;&#1072;&#1090;&#1077;&#1084;
&#1089;&#1090;&#1072;&#1088;&#1096;&#1080;&#1081;.
<p><code><!--mstheme--></font>
<pre> in al, 61h
 or  al, 11y
 out 61h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1048;, &#1085;&#1072;&#1082;&#1086;&#1085;&#1077;&#1094;,
&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084;
&#1074;&#1099;&#1074;&#1086;&#1076;&#1072; &#1074; &#1087;&#1086;&#1088;&#1090;
61h &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;, &#1089;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1085;&#1099;&#1084;&#1080;
0-&#1099;&#1084; &#1080; 1-&#1099;&#1084;
&#1073;&#1080;&#1090;&#1072;&#1084;&#1080;,
&#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;.
<p><code><!--mstheme--></font>
<pre> DO_DELAY MACRO
     mov eax, DELAY
     .while eax
         dec eax
     .endw
 ENDM

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1072;&#1077;&#1084;
&#1076;&#1072;&#1085;&#1072;&#1084;&#1080;&#1082;&#1091;
&#1087;&#1086;&#1079;&#1074;&#1091;&#1095;&#1072;&#1090;&#1100;
&#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
&#1074;&#1088;&#1077;&#1084;&#1103;,
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;&#1089;&#1100;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1086;&#1084; DO_DELAY.
&#1044;&#1072; -
&#1087;&#1088;&#1080;&#1084;&#1080;&#1090;&#1080;&#1074;&#1085;&#1086;,
&#1085;&#1086; -
&#1101;&#1092;&#1092;&#1077;&#1082;&#1090;&#1080;&#1074;&#1085;&#1086; ;-)
<p><code><!--mstheme--></font>
<pre> in al, 61h
 and al, 11111100y
 out 61h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1048; &#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;,
&#1089;&#1073;&#1088;&#1072;&#1089;&#1099;&#1074;&#1072;&#1103;
&#1076;&#1074;&#1072; &#1084;&#1083;&#1072;&#1076;&#1096;&#1080;&#1093;
&#1073;&#1080;&#1090;&#1072;. &#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084;
&#1085;&#1072;&#1076;&#1086; &#1085;&#1077;
&#1079;&#1072;&#1073;&#1099;&#1074;&#1072;&#1090;&#1100;, &#1095;&#1090;&#1086;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088; - &#1101;&#1090;&#1086;
&#1075;&#1083;&#1086;&#1073;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1085;&#1072;
&#1074;&#1088;&#1077;&#1084;&#1103; &#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1089; &#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1072;&#1084;&#1080;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;, &#1084;&#1099;
&#1079;&#1072;&#1087;&#1088;&#1077;&#1097;&#1072;&#1077;&#1084;
&#1072;&#1087;&#1087;&#1072;&#1088;&#1072;&#1090;&#1085;&#1099;&#1077;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103;.
<p>&#1042;&#1090;&#1086;&#1088;&#1086;&#1081; &#1079;&#1074;&#1091;&#1082; (&#1084;&#1080;)
&#1084;&#1099;
&#1074;&#1086;&#1089;&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1084;
&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099; MakeBeep2,
&#1090;&#1077;&#1084; &#1078;&#1077; &#1089;&#1072;&#1084;&#1099;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1085;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1076;&#1083;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1103; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; WRITE_PORT_UCHAR &#1080;
READ_PORT_UCHAR &#1080;&#1079; &#1084;&#1086;&#1076;&#1091;&#1083;&#1103;
hal.dll. &#1055;&#1086;&#1084;&#1080;&#1084;&#1086; &#1101;&#1090;&#1080;&#1093;
&#1076;&#1074;&#1091;&#1093;, &#1074; &#1084;&#1086;&#1076;&#1091;&#1083;&#1077;
hal.dll &#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1094;&#1077;&#1083;&#1099;&#1081; &#1085;&#1072;&#1073;&#1086;&#1088;
&#1087;&#1086;&#1076;&#1086;&#1073;&#1085;&#1099;&#1093;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;. &#1054;&#1085;&#1080;
&#1087;&#1088;&#1080;&#1079;&#1074;&#1072;&#1085;&#1099;
&#1089;&#1082;&#1088;&#1099;&#1090;&#1100;
&#1084;&#1077;&#1078;&#1087;&#1083;&#1072;&#1090;&#1092;&#1086;&#1088;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1080;&#1103;.
&#1042;&#1089;&#1087;&#1086;&#1084;&#1085;&#1080;&#1090;&#1077;,
&#1095;&#1090;&#1086; &#1103; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;
&#1087;&#1088;&#1086; HAL &#1074; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1080; &#1089;&#1090;&#1072;&#1090;&#1100;&#1080;.
&#1044;&#1083;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1072; alpha,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1074;&#1085;&#1091;&#1090;&#1088;&#1077;&#1085;&#1085;&#1103;&#1103;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1101;&#1090;&#1080;&#1093; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1089;&#1086;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1086;
&#1076;&#1088;&#1091;&#1075;&#1086;&#1081;, &#1085;&#1086; &#1076;&#1083;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1080;&#1079;&#1084;&#1077;&#1085;&#1080;&#1090;&#1089;&#1103;. &#1071;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1083;
&#1101;&#1090;&#1080; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1076;&#1083;&#1103;
&#1088;&#1072;&#1079;&#1085;&#1086;&#1086;&#1073;&#1088;&#1072;&#1079;&#1080;&#1103;.
&#1055;&#1088;&#1086;&#1089;&#1090;&#1086;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1087;&#1086;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;, &#1095;&#1090;&#1086;
&#1090;&#1072;&#1082;&#1080;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1077;&#1089;&#1090;&#1100;.
<p>&#1058;&#1088;&#1077;&#1090;&#1080;&#1081; &#1079;&#1074;&#1091;&#1082; (&#1089;&#1086;&#1083;&#1100;)
&#1084;&#1099;
&#1074;&#1086;&#1089;&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1084;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;&#1089;&#1100;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1077;&#1081; HalMakeBeep,
&#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1097;&#1077;&#1081;&#1089;&#1103;
&#1074; &#1084;&#1086;&#1076;&#1091;&#1083;&#1077; hal.dll.
&#1042;&#1085;&#1091;&#1090;&#1088;&#1080; &#1101;&#1090;&#1086;&#1081;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1089;&#1093;&#1086;&#1076;&#1103;&#1090;
&#1089;&#1086;&#1073;&#1099;&#1090;&#1080;&#1103;,
&#1087;&#1086;&#1083;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;
&#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1099;&#1077;
&#1076;&#1074;&#1091;&#1084;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1080;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1103;&#1084;.
&#1054;&#1087;&#1103;&#1090;&#1100; &#1078;&#1077;,
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1074;&#1080;&#1076;&#1091; &#1084;&#1086;&#1076;&#1091;&#1083;&#1100; hal.dll
&#1076;&#1083;&#1103;
&#1087;&#1083;&#1072;&#1090;&#1092;&#1086;&#1088;&#1084;&#1099; x86.
&#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084;, &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;,
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1085;&#1077; &#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1077;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1099;
&#1090;&#1072;&#1082;&#1090;&#1086;&#1074;&#1086;&#1075;&#1086;
&#1075;&#1077;&#1085;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;&#1072;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072; &#1080;
&#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;&#1072;, &#1072;
&#1089;&#1072;&#1084;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1095;&#1072;&#1089;&#1090;&#1086;&#1090;&#1099;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102; &#1084;&#1099;
&#1093;&#1086;&#1090;&#1080;&#1084;
&#1074;&#1086;&#1089;&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1080;.
&#1042; &#1085;&#1072;&#1095;&#1072;&#1083;&#1077;
&#1092;&#1072;&#1081;&#1083;&#1072; beeper.bat
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099;
&#1074;&#1089;&#1077; 12 &#1085;&#1086;&#1090;. &#1071;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1086;, &#1084;&#1080;
&#1080; &#1089;&#1086;&#1083;&#1100;.
&#1054;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1099;
&#1076;&#1083;&#1103; &#1074;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1073;&#1091;&#1076;&#1091;&#1097;&#1077;&#1075;&#1086;
&#1089;&#1091;&#1087;&#1077;&#1088;-&#1087;&#1091;&#1087;&#1087;&#1077;&#1088;
&#1089;&#1080;&#1085;&#1090;&#1077;&#1079;&#1072;&#1090;&#1086;&#1088;&#1072;
;-). &#1044;&#1083;&#1103;
&#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1072;,
&#1085;&#1072;&#1076;&#1086; &#1074;&#1099;&#1079;&#1074;&#1072;&#1090;&#1100;
HalMakeBeep &#1077;&#1097;&#1077; &#1088;&#1072;&#1079;,
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1074; &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072; 0.
<p>&#1053;&#1072; &#1101;&#1090;&#1086;&#1084;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1091;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; beeper.sys
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1089;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100;
&#1079;&#1072;&#1082;&#1086;&#1085;&#1095;&#1077;&#1085;&#1085;&#1086;&#1081;.
&#1054;&#1085;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077; &#1082;&#1086;&#1076;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1080;
&#1073;&#1083;&#1072;&#1075;&#1086;&#1087;&#1086;&#1083;&#1091;&#1095;&#1085;&#1086;
&#1091;&#1076;&#1072;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1080;&#1079;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1053;&#1072;
&#1074;&#1089;&#1103;&#1082;&#1080;&#1081;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1081;
&#1087;&#1086;&#1074;&#1090;&#1086;&#1088;&#1103;&#1102;: &#1082;&#1086;&#1076;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1074;&#1077;&#1088;&#1085;&#1091;&#1090;&#1100;,
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1083;&#1103;
&#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1091;&#1076;&#1072;&#1083;&#1080;&#1083;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1080;&#1079;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1042;&#1089;&#1077;
&#1095;&#1090;&#1086; &#1084;&#1086;&#1075;, &#1086;&#1085;
&#1091;&#1078;&#1077; &#1089;&#1076;&#1077;&#1083;&#1072;&#1083;.
&#1050;&#1086;&#1075;&#1076;&#1072; &#1084;&#1099;
&#1076;&#1086;&#1073;&#1077;&#1088;&#1077;&#1084;&#1089;&#1103; &#1076;&#1086;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;, &#1090;&#1086;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;
STATUS_SUCCESS.
<p>&#1055;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1072; scp.exe
&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1090;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1091;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; beeper.sys
&#1087;&#1086;
&#1090;&#1088;&#1077;&#1073;&#1086;&#1074;&#1072;&#1085;&#1080;&#1102;.
&#1044;&#1083;&#1103; &#1090;&#1086;&#1075;&#1086;,
&#1095;&#1090;&#1086;&#1073;&#1099;
&#1079;&#1072;&#1082;&#1086;&#1085;&#1095;&#1080;&#1090;&#1100; &#1089;
&#1101;&#1090;&#1080;&#1084;
&#1074;&#1086;&#1087;&#1088;&#1086;&#1089;&#1086;&#1084;,
&#1076;&#1091;&#1084;&#1072;&#1102;, &#1073;&#1091;&#1076;&#1077;&#1090;
&#1091;&#1084;&#1077;&#1089;&#1090;&#1085;&#1086;
&#1087;&#1086;&#1087;&#1088;&#1086;&#1073;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1080;&#1090;&#1100;
&#1077;&#1075;&#1086;
&#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;,
&#1088;&#1072;&#1079; &#1091;&#1078; &#1084;&#1099; &#1090;&#1072;&#1082;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1088;&#1072;&#1079;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;
&#1101;&#1090;&#1086;&#1090; &#1074;&#1086;&#1087;&#1088;&#1086;&#1089; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;.
&#1055;&#1088;&#1086;&#1097;&#1077; &#1074;&#1089;&#1077;&#1075;&#1086;
&#1101;&#1090;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;
&#1090;&#1072;&#1082;:
&#1079;&#1072;&#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1100;&#1090;&#1077;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeleteService, &#1074;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CreateService
&#1079;&#1072;&#1084;&#1077;&#1085;&#1080;&#1090;&#1077; SERVICE_DEMAND_START
&#1085;&#1072; SERVICE_AUTO_START, &#1072; SERVICE_ERROR_IGNORE &#1085;&#1072;
SERVICE_ERROR_NORMAL,
&#1087;&#1077;&#1088;&#1077;&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1091;&#1081;&#1090;&#1077;
csp.asm &#1080; &#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1077;.
&#1042; &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1077;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1072;&#1103;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1100;.
&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1084;&#1086;&#1078;&#1077;&#1090;&#1077;
&#1079;&#1072;&#1073;&#1099;&#1090;&#1100; &#1086;&#1073;
&#1101;&#1090;&#1086;&#1084; &#1076;&#1086;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1087;&#1077;&#1088;&#1077;&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;.
&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; beeper.sys
&#1089;&#1072;&#1084; &#1085;&#1072;&#1087;&#1086;&#1084;&#1085;&#1080;&#1090;
&#1086; &#1089;&#1077;&#1073;&#1077;, &#1072; &#1074;
&#1078;&#1091;&#1088;&#1085;&#1072;&#1083;&#1077;
&#1089;&#1086;&#1073;&#1099;&#1090;&#1080;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1077;&#1090;&#1089;&#1103;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1100; &#1086;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1096;&#1077;&#1076;&#1096;&#1077;&#1081;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1077;.
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1085;&#1072; &#1085;&#1077;&#1077; &#1084;&#1086;&#1078;&#1085;&#1086; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1086;&#1089;&#1085;&#1072;&#1089;&#1090;&#1082;&#1080; <font color="#000099">&#1040;&#1076;&#1084;&#1080;&#1085;&#1080;&#1089;&#1090;&#1088;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
&gt; &#1055;&#1088;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;
&#1089;&#1086;&#1073;&#1099;&#1090;&#1080;&#1081;</font> (<font color="#000099">Administrative
Tools &gt; Event Viewer</font>).
<p align="center"><!-- &#1047;&#1076;&#1077;&#1089;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1082;&#1072;&#1088;&#1090;&#1080;&#1085;&#1082;&#1072; -->
<img src="BeeperError.gif" width="404" height="448"><center>
<p>&#1056;&#1080;&#1089;. 3-1.
&#1057;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1077; &#1086;&#1073;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1077;</center><br>
<br>
<p>&#1053;&#1077; &#1079;&#1072;&#1073;&#1091;&#1076;&#1100;&#1090;&#1077;
&#1091;&#1076;&#1072;&#1083;&#1080;&#1090;&#1100;
&#1087;&#1086;&#1089;&#1083;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;,
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091; beeper.sys,
&#1080;&#1085;&#1072;&#1095;&#1077; &#1076;&#1086;-&#1084;&#1080;-&#1089;&#1086;&#1083;&#1100;
&#1073;&#1091;&#1076;&#1091;&#1090;
&#1079;&#1074;&#1091;&#1095;&#1072;&#1090;&#1100; &#1087;&#1088;&#1080;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1081;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1077;.<br>
<br>
<br>
<p><strong>&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
giveio.sys</strong>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1088;&#1091;&#1075;&#1080;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084; - giveio.sys.
<p><code><!--mstheme--></font>
<pre> <font size="2"><b>;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;
 ;  DateTime.asm
 ;
 ;  &#1055;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1072; &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084; giveio.sys
 ;
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .386
 .model flat, stdcall
 option casemap:none

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                              &#1042; &#1050; &#1051; &#1070; &#1063; &#1040; &#1045; &#1052; &#1067; &#1045;    &#1060; &#1040; &#1049; &#1051; &#1067;                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 include \masm32\include\windows.inc

 include \masm32\include\kernel32.inc
 include \masm32\include\user32.inc
 include \masm32\include\advapi32.inc

 includelib \masm32\lib\kernel32.lib
 includelib \masm32\lib\user32.lib
 includelib \masm32\lib\advapi32.lib

 include \masm32\Macros\Strings.mac

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                         &#1052; &#1040; &#1050; &#1056; &#1054; &#1057; &#1067;                                             
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 CMOS MACRO by:REQ
     mov al, by
     out 70h, al
     in al, 71h

     mov ah, al
     shr al, 4
     add al, '0'

     and ah, 0Fh
     add ah, '0'
     stosw
 ENDM

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                           &#1050; &#1054; &#1044;                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                          DateTime                                                 
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DateTime proc uses edi

 LOCAL acDate[16]:CHAR
 LOCAL acTime[16]:CHAR
 LOCAL acOut[64]:CHAR

     ; &#1055;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1077; &#1089;&#1084;&#1086;&#1090;&#1088;&#1080; Ralf Brown's Interrupt List

     ;:::::::::::::::::: &#1059;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1080;&#1084; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072; ::::::::::::::::::

     mov al, 0Bh               ; &#1059;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081; &#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088; B
     out 70h, al
     in al, 71h

     push eax                  ; &#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1084; &#1089;&#1090;&#1072;&#1088;&#1099;&#1081; &#1092;&#1072;&#1088;&#1084;&#1072;&#1090; &#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;
     and al, 11111011y         ; &#1041;&#1080;&#1090; 2: &#1060;&#1086;&#1088;&#1084;&#1072;&#1090; - 0: &#1091;&#1087;&#1072;&#1082;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081; &#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1086;-&#1076;&#1077;&#1089;&#1103;&#1090;&#1080;&#1095;&#1085;&#1099;&#1081;, 1: &#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1099;&#1081;
     or al, 010y               ; &#1041;&#1080;&#1090; 1: 24/12 &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1095;&#1072;&#1089;&#1072; - 1 &#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1090; 24-&#1095;&#1072;&#1089;&#1086;&#1074;&#1086;&#1081; &#1088;&#1077;&#1078;&#1080;&#1084;
     out 71h, al

     ;:::::::::::::::::::: &#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084; &#1090;&#1077;&#1082;&#1091;&#1097;&#1091;&#1102; &#1076;&#1072;&#1090;&#1091; ::::::::::::::::::::

     lea edi, acDate

     CMOS 07h                  ; &#1063;&#1080;&#1089;&#1083;&#1086; &#1084;&#1077;&#1089;&#1103;&#1094;&#1072;
     mov al, '.'
     stosb

     CMOS 08h                  ; &#1052;&#1077;&#1089;&#1103;&#1094;
     mov al, '.'
     stosb

     CMOS 32h                  ; &#1044;&#1074;&#1077; &#1089;&#1090;&#1072;&#1088;&#1096;&#1080;&#1077; &#1094;&#1080;&#1092;&#1088;&#1099; &#1075;&#1086;&#1076;&#1072;
     CMOS 09h                  ; &#1044;&#1074;&#1077; &#1084;&#1083;&#1072;&#1076;&#1096;&#1080;&#1077; &#1094;&#1080;&#1092;&#1088;&#1099; &#1075;&#1086;&#1076;&#1072;

     xor eax, eax              ; &#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1084; &#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1085;&#1091;&#1083;&#1077;&#1084;
     stosb

     ;:::::::::::::::::::: &#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084; &#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1077; &#1074;&#1088;&#1077;&#1084;&#1103; :::::::::::::::::::

     lea edi, acTime

     CMOS 04h                  ; &#1063;&#1072;&#1089;&#1099;
     mov al, ':'
     stosb

     CMOS 02h                  ; &#1052;&#1080;&#1085;&#1091;&#1090;&#1099;
     mov al, ':'
     stosb

     CMOS 0h                   ; &#1057;&#1077;&#1082;&#1091;&#1085;&#1076;&#1099;

     xor eax, eax              ; &#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1084; &#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1085;&#1091;&#1083;&#1077;&#1084;
     stosb

     ;:::::::::::::: &#1042;&#1086;&#1089;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1080;&#1084; &#1089;&#1090;&#1072;&#1088;&#1099;&#1081; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072; :::::::::::::

     mov al, 0Bh
     out 70h, al
     pop eax
     out 71h, al

     ;::::::::::::::::: &#1055;&#1086;&#1082;&#1072;&#1078;&#1077;&#1084; &#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1077; &#1076;&#1072;&#1090;&#1091; &#1080; &#1074;&#1088;&#1077;&#1084;&#1103; :::::::::::::::

     invoke wsprintf, addr acOut, $CTA0(&quot;Date:\t%s\nTime:\t%s&quot;), addr acDate, addr acTime
     invoke MessageBox, NULL, addr acOut, $CTA0(&quot;Current Date and Time&quot;), MB_OK

     ret

 DateTime endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                         start                                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 start proc

 LOCAL fOK:BOOL
 LOCAL hSCManager:HANDLE
 LOCAL hService:HANDLE
 LOCAL acDriverPath[MAX_PATH]:CHAR

 LOCAL hKey:HANDLE
 LOCAL dwProcessId:DWORD

     and fOK, 0        ; &#1055;&#1088;&#1077;&#1076;&#1087;&#1086;&#1083;&#1086;&#1078;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090; &#1086;&#1096;&#1080;&#1073;&#1082;&#1072;

     ; &#1054;&#1090;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084; &#1073;&#1072;&#1079;&#1091; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; SCM

     invoke OpenSCManager, NULL, NULL, SC_MANAGER_CREATE_SERVICE
     .if eax != NULL
         mov hSCManager, eax

         push eax
         invoke GetFullPathName, $CTA0(&quot;giveio.sys&quot;), sizeof acDriverPath, addr acDriverPath, esp
         pop eax

         ; &#1056;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1080;&#1088;&#1091;&#1077;&#1084; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;

         invoke CreateService, hSCManager, $CTA0(&quot;giveio&quot;), $CTA0(&quot;Current Date and Time fetcher.&quot;), \
                 SERVICE_START + DELETE, SERVICE_KERNEL_DRIVER, SERVICE_DEMAND_START, \
                 SERVICE_ERROR_IGNORE, addr acDriverPath, NULL, NULL, NULL, NULL, NULL

         .if eax != NULL
             mov hService, eax

             invoke RegOpenKeyEx, HKEY_LOCAL_MACHINE, \
                                     $CTA0(&quot;SYSTEM\\CurrentControlSet\\Services\\giveio&quot;), \
                                     0, KEY_CREATE_SUB_KEY + KEY_SET_VALUE, addr hKey

             .if eax == ERROR_SUCCESS

                 ; &#1044;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084; &#1074; &#1088;&#1077;&#1077;&#1089;&#1090;&#1088; &#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088; &#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1075;&#1086; &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;

                 invoke GetCurrentProcessId
                 mov dwProcessId, eax
                 invoke RegSetValueEx, hKey, $CTA0(&quot;ProcessId&quot;, szProcessId), NULL, REG_DWORD, \
                                         addr dwProcessId, sizeof DWORD

                 .if eax == ERROR_SUCCESS                
                     invoke StartService, hService, 0, NULL
                     inc fOK                ; &#1059;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084; &#1092;&#1083;&#1072;&#1075;
                     invoke RegDeleteValue, hKey, addr szProcessId
                 .else
                     invoke MessageBox, NULL, $CTA0(&quot;Can't add Process ID into registry.&quot;), \
                                         NULL, MB_ICONSTOP
                 .endif
                
                 invoke RegCloseKey, hKey

             .else
                 invoke MessageBox, NULL, $CTA0(&quot;Can't open registry.&quot;), NULL, MB_ICONSTOP
             .endif

             ; &#1059;&#1076;&#1072;&#1083;&#1103;&#1077;&#1084; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1080;&#1079; &#1073;&#1072;&#1079;&#1099; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; SCM

             invoke DeleteService, hService
             invoke CloseServiceHandle, hService
         .else
             invoke MessageBox, NULL, $CTA0(&quot;Can't register driver.&quot;), NULL, MB_ICONSTOP
         .endif
         invoke CloseServiceHandle, hSCManager
     .else
         invoke MessageBox, NULL, $CTA0(&quot;Can't connect to Service Control Manager.&quot;), \
                            NULL, MB_ICONSTOP
     .endif

     ; &#1045;&#1089;&#1083;&#1080; &#1074;&#1089;&#1077; &#1054;&#1050;, &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1080; &#1087;&#1086;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084; &#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1077; &#1076;&#1072;&#1090;&#1091; &#1080; &#1074;&#1088;&#1077;&#1084;&#1103;

     .if fOK
         invoke DateTime
     .endif

     invoke ExitProcess, 0

 start endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                                                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 end start

</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1080;&#1095;&#1077;&#1075;&#1086;
&#1085;&#1086;&#1074;&#1086;&#1075;&#1086; &#1074;
&#1089;&#1072;&#1084;&#1086;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080; &#1085;&#1077;&#1090;,
&#1079;&#1072;
&#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1093;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;.
<p><code><!--mstheme--></font>
<pre> invoke RegOpenKeyEx, HKEY_LOCAL_MACHINE, \
                         $CTA0(&quot;SYSTEM\\CurrentControlSet\\Services\\giveio&quot;), \
                         0, KEY_CREATE_SUB_KEY + KEY_SET_VALUE, addr hKey

 .if eax == ERROR_SUCCESS
     invoke GetCurrentProcessId
     mov dwProcessId, eax
     invoke RegSetValueEx, hKey, $CTA0(&quot;ProcessId&quot;, szProcessId), NULL, REG_DWORD, \
                           addr dwProcessId, sizeof DWORD

     .if eax == ERROR_SUCCESS                
         invoke StartService, hService, 0, NULL

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1077;&#1088;&#1077;&#1076;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1086;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;, &#1084;&#1099;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1077;&#1084; &#1074;
&#1087;&#1086;&#1076;&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1077;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;,
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;,
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; <i>ProcessId</i>,
&#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1077;&#1075;&#1086; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1088;&#1072;&#1074;&#1085;&#1099;&#1084;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1091;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;, &#1090;.&#1077;.
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;.
&#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072;
&#1090;&#1086;, &#1095;&#1090;&#1086;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1103;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; $CTA0, &#1103;
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;
&#1084;&#1077;&#1090;&#1082;&#1091; szProcessId,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1087;&#1086;&#1084;&#1077;&#1095;&#1077;&#1085;
&#1090;&#1077;&#1082;&#1089;&#1090; &quot;ProcessId&quot;, &#1076;&#1083;&#1103;
&#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1087;&#1086;&#1079;&#1078;&#1077; &#1082; &#1085;&#1077;&#1084;&#1091;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1100;&#1089;&#1103;.
&#1045;&#1089;&#1083;&#1080;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086; &#1073;&#1077;&#1079;
&#1086;&#1096;&#1080;&#1073;&#1086;&#1082;, &#1090;&#1086;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1077;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;.
&#1047;&#1072;&#1095;&#1077;&#1084; &#1085;&#1091;&#1078;&#1077;&#1085;
&#1101;&#1090;&#1086;&#1090;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; &#1074;&#1099;
&#1091;&#1079;&#1085;&#1072;&#1077;&#1090;&#1077;
&#1087;&#1086;&#1079;&#1078;&#1077;, &#1082;&#1086;&#1075;&#1076;&#1072;
&#1084;&#1099; &#1073;&#1091;&#1076;&#1077;&#1084;
&#1088;&#1072;&#1079;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100;
&#1090;&#1077;&#1082;&#1089;&#1090;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
<p><code><!--mstheme--></font>
<pre><b><font size="2">         inc fOK
         invoke RegDeleteValue, hKey, addr szProcessId
     .else
         invoke MessageBox, NULL, $CTA0(&quot;Can't add Process ID into registry.&quot;), \
                             NULL, MB_ICONSTOP
     .endif
                
     invoke RegCloseKey, hKey
</font></b>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1074;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1086;&#1090; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; StartService,
&#1084;&#1099; &#1089;&#1095;&#1080;&#1090;&#1072;&#1077;&#1084;,
&#1095;&#1090;&#1086; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;
&#1086;&#1090;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1083; &#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1092;&#1083;&#1072;&#1075; fOK. &#1042;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; RegDeleteValue
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;.
&#1042;&#1089;&#1077; &#1088;&#1072;&#1074;&#1085;&#1086;,
&#1074;&#1077;&#1089;&#1100; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;
&#1073;&#1091;&#1076;&#1077;&#1090; &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084; DeleteService.
&#1055;&#1088;&#1086;&#1089;&#1090;&#1086;, &#1103;
&#1089;&#1090;&#1072;&#1088;&#1072;&#1102;&#1089;&#1100;
&#1087;&#1088;&#1080;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1074;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1080;
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1072; &quot;&#1093;&#1086;&#1088;&#1086;&#1096;&#1077;&#1075;&#1086;
&#1090;&#1086;&#1085;&#1072;&quot;:
&#1085;&#1072;&#1075;&#1072;&#1076;&#1080;&#1083; -
&#1087;&#1086;&#1076;&#1086;&#1090;&#1088;&#1080; ;-)
<p><code><!--mstheme--></font>
<pre> .if fOK
     invoke DateTime
 .endif

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1059;&#1076;&#1072;&#1083;&#1080;&#1074;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1080;&#1079;
&#1073;&#1072;&#1079;&#1099; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; SCM
&#1080; &#1079;&#1072;&#1082;&#1088;&#1099;&#1074; &#1074;&#1089;&#1077;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1099;&#1077;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1080;, &#1084;&#1099;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091; DateTime,
&#1087;&#1088;&#1077;&#1076;&#1074;&#1072;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1080;&#1074;
&#1092;&#1083;&#1072;&#1075; fOK.
<p>&#1053;&#1072;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1085;&#1089;&#1082;&#1086;&#1081;
&#1087;&#1083;&#1072;&#1090;&#1077;
&#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1072;
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103;
&#1084;&#1080;&#1082;&#1088;&#1086;&#1089;&#1093;&#1077;&#1084;&#1072;,
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1087;&#1086;
&#1090;&#1077;&#1093;&#1085;&#1086;&#1083;&#1086;&#1075;&#1080;&#1080; CMOS (Complementary
Metal-Oxide Semiconductor, &#1052;&#1077;&#1090;&#1072;&#1083;&#1083;-&#1054;&#1082;&#1080;&#1089;&#1077;&#1083;-&#1055;&#1086;&#1083;&#1091;&#1087;&#1088;&#1086;&#1074;&#1086;&#1076;&#1085;&#1080;&#1082;
&#1089;
&#1050;&#1086;&#1084;&#1087;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1086;&#1081;,
&#1050;&#1052;&#1054;&#1055;), &#1080;
&#1087;&#1080;&#1090;&#1072;&#1102;&#1097;&#1072;&#1103;&#1089;&#1103;
&#1086;&#1090; &#1073;&#1072;&#1090;&#1072;&#1088;&#1077;&#1081;&#1082;&#1080;.
&#1042; &#1101;&#1090;&#1086;&#1081;
&#1084;&#1080;&#1082;&#1088;&#1086;&#1089;&#1093;&#1077;&#1084;&#1077;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1085;
&#1077;&#1097;&#1077; &#1086;&#1076;&#1080;&#1085;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;,
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;&#1099;&#1081; <i>&#1095;&#1072;&#1089;&#1072;&#1084;&#1080;
&#1088;&#1077;&#1072;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080;</i> (Real Time Clock, RTC),
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090;
&#1087;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1085;&#1086;,
&#1076;&#1072;&#1078;&#1077; &#1087;&#1088;&#1080;
&#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1085;&#1086;&#1084;
&#1087;&#1080;&#1090;&#1072;&#1085;&#1080;&#1080;
&#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1072;.
&#1055;&#1086;&#1084;&#1080;&#1084;&#1086;
&#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;, &#1074;
&#1101;&#1090;&#1086;&#1081;
&#1084;&#1080;&#1082;&#1088;&#1086;&#1089;&#1093;&#1077;&#1084;&#1077;
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1085;&#1077;&#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1081;
&#1073;&#1083;&#1086;&#1082; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1074;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084;
&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1089;&#1103;
&#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1077;
&#1074;&#1088;&#1077;&#1084;&#1103;, &#1072; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1082;&#1086;&#1077;-&#1082;&#1072;&#1082;&#1072;&#1103;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103; &#1086;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1093;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1093;
&#1082;&#1086;&#1084;&#1087;&#1100;&#1102;&#1090;&#1077;&#1088;&#1072;.
&#1044;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086; &#1086;&#1073;
&#1101;&#1090;&#1086;&#1084; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1091;&#1079;&#1085;&#1072;&#1090;&#1100; &#1074;
&#1089;&#1087;&#1088;&#1072;&#1074;&#1086;&#1095;&#1085;&#1080;&#1082;&#1077;
&quot;Ralf Brown's Interrupt List&quot;.
&#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1077;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; CMOS
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1074;&#1096;&#1080;&#1089;&#1100;
&#1082; &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
70h &#1080; 71h.
<p><code><!--mstheme--></font>
<pre> mov al, 0Bh               ; &#1059;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081; &#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088; B
 out 70h, al
 in al, 71h

 push eax                  ; &#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1084; &#1089;&#1090;&#1072;&#1088;&#1099;&#1081; &#1092;&#1072;&#1088;&#1084;&#1072;&#1090; &#1090;&#1072;&#1081;&#1084;&#1077;&#1088;&#1072;
 and al, 11111011y         ; &#1041;&#1080;&#1090; 2: &#1060;&#1086;&#1088;&#1084;&#1072;&#1090; - 0: &#1091;&#1087;&#1072;&#1082;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081; &#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1086;-&#1076;&#1077;&#1089;&#1103;&#1090;&#1080;&#1095;&#1085;&#1099;&#1081;, 1: &#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1099;&#1081;
 or al, 010y               ; &#1041;&#1080;&#1090; 1: 24/12 &#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1095;&#1072;&#1089;&#1072; - 1 &#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1090; 24-&#1095;&#1072;&#1089;&#1086;&#1074;&#1086;&#1081; &#1088;&#1077;&#1078;&#1080;&#1084;
 out 71h, al

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1057;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1091;&#1076;&#1086;&#1073;&#1085;&#1099;&#1081; &#1085;&#1072;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1099;
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1090;&#1100;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088; B.
&#1061;&#1086;&#1090;&#1103;, &#1087;&#1086;
&#1091;&#1084;&#1086;&#1083;&#1095;&#1072;&#1085;&#1080;&#1102;, &#1086;&#1085;
&#1080; &#1090;&#1072;&#1082;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;,
&#1085;&#1086; &#1090;&#1077;&#1084; &#1085;&#1077;
&#1084;&#1077;&#1085;&#1077;&#1077;. &#1053;&#1072;&#1084;
&#1091;&#1076;&#1086;&#1073;&#1085;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1090;&#1100;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1074;
&#1091;&#1087;&#1072;&#1082;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1076;&#1074;&#1086;&#1080;&#1095;&#1085;&#1086;-&#1076;&#1077;&#1089;&#1103;&#1090;&#1080;&#1095;&#1085;&#1086;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077; (&#1074;
&#1086;&#1076;&#1085;&#1086;&#1084; &#1073;&#1072;&#1081;&#1090;&#1077;
&#1076;&#1074;&#1077; &#1094;&#1080;&#1092;&#1088;&#1099; - &#1087;&#1086; 4
&#1073;&#1080;&#1090;&#1072; &#1085;&#1072;
&#1082;&#1072;&#1078;&#1076;&#1091;&#1102;).
&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;, &#1091;
&#1085;&#1072;&#1089; &#1087;&#1088;&#1080;&#1085;&#1103;&#1090;&#1072; 24-&#1095;&#1072;&#1089;&#1086;&#1074;&#1072;&#1103;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1091;&#1090;&#1086;&#1082;, &#1090;&#1086; &#1101;&#1090;&#1086;&#1090;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090; &#1084;&#1099; &#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1084;.
<p>&#1047;&#1072;&#1090;&#1077;&#1084;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; CMOS,
&#1074;&#1099;&#1076;&#1077;&#1088;&#1075;&#1080;&#1074;&#1072;&#1077;&#1084;
&#1087;&#1086; &#1086;&#1076;&#1085;&#1086;&#1084;&#1091;
&#1073;&#1072;&#1081;&#1090;&#1091; &#1085;&#1091;&#1078;&#1085;&#1086;&#1081;
&#1085;&#1072;&#1084;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080;,
&#1087;&#1086;&#1087;&#1091;&#1090;&#1085;&#1086;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1080;&#1088;&#1091;&#1103;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102;&#1089;&#1103;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091;.
<p><code><!--mstheme--></font>
<pre> invoke wsprintf, addr acOut, $CTA0(&quot;Date:\t%s\nTime:\t%s&quot;), addr acDate, addr acTime
 invoke MessageBox, NULL, addr acOut, $CTA0(&quot;Current Date and Time&quot;), MB_OK

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1074;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1077; &#1076;&#1072;&#1090;&#1091;
&#1080; &#1074;&#1088;&#1077;&#1084;&#1103;,
&#1089;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084;
&#1080;&#1079; &#1085;&#1080;&#1093; &#1077;&#1076;&#1080;&#1085;&#1091;&#1102;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091; &#1080;
&#1074;&#1099;&#1074;&#1086;&#1076;&#1080;&#1084; &#1077;&#1077; &#1085;&#1072;
&#1101;&#1082;&#1088;&#1072;&#1085;.
&#1059;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1072;&#1103;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100;
\t &#1074;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;
&#1075;&#1086;&#1088;&#1080;&#1079;&#1086;&#1085;&#1090;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1090;&#1072;&#1073;&#1091;&#1083;&#1103;&#1094;&#1080;&#1080;, &#1072; \n
&#1087;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076;&#1072;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080; (&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1077;
&#1089;&#1084;. \Macros\Strings.mac). &#1048; &#1085;&#1072;
&#1101;&#1082;&#1088;&#1072;&#1085;&#1077; &#1084;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1091;&#1074;&#1080;&#1076;&#1077;&#1090;&#1100;:
<p align="center"><!-- &#1047;&#1076;&#1077;&#1089;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1082;&#1072;&#1088;&#1090;&#1080;&#1085;&#1082;&#1072; -->
<img src="DateTime.gif" width="170" height="113"><center>
<p>&#1056;&#1080;&#1089;. 3-2.
&#1056;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099; DateTime.exe</center><br>
<br>
<p>&#1057;&#1072;&#1084;&#1099;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1085;&#1099;&#1084;, &#1074;
&#1074;&#1099;&#1096;&#1077;&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1086;&#1084;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;,
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1077; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1087;&#1088;&#1103;&#1084;&#1086; &#1080;&#1079;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;.
&#1050;&#1072;&#1082; &#1103; &#1091;&#1078;&#1077;
&#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1083;
&#1074;&#1099;&#1096;&#1077;, &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1089;&#1074;&#1103;&#1090;&#1086;
&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103; Windows
NT. &#1048; &#1090;&#1077;&#1084; &#1085;&#1077;
&#1084;&#1077;&#1085;&#1077;&#1077;, &#1084;&#1099; &#1082;
&#1085;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1083;&#1080;&#1089;&#1100;.
&#1069;&#1090;&#1086; &#1089;&#1090;&#1072;&#1083;&#1086;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;
&#1073;&#1083;&#1072;&#1075;&#1086;&#1076;&#1072;&#1088;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091; giveio.sys, &#1082;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1080;&#1102;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086; &#1084;&#1099; &#1080;
&#1087;&#1077;&#1088;&#1077;&#1093;&#1086;&#1076;&#1080;&#1084;.
<p><code><!--mstheme--></font>
<pre><font size="2"><b> ;@echo off
 ;goto make


 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;
 ;  giveio - &#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
 ;
 ;  &#1044;&#1072;&#1077;&#1090; &#1087;&#1088;&#1103;&#1084;&#1086;&#1081; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072; &#1080;&#1079; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
 ;   &#1054;&#1089;&#1085;&#1086;&#1074;&#1072;&#1085; &#1085;&#1072; &#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1084; &#1090;&#1077;&#1082;&#1089;&#1090;&#1077; &#1044;&#1077;&#1081;&#1083;&#1072; &#1056;&#1086;&#1073;&#1077;&#1088;&#1090;&#1089;&#1072;
 ;
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .386
 .model flat, stdcall
 option casemap:none

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                              &#1042; &#1050; &#1051; &#1070; &#1063; &#1040; &#1045; &#1052; &#1067; &#1045;    &#1060; &#1040; &#1049; &#1051; &#1067;                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 include \masm32\include\w2k\ntstatus.inc
 include \masm32\include\w2k\ntddk.inc
 include \masm32\include\w2k\ntoskrnl.inc

 includelib \masm32\lib\w2k\ntoskrnl.lib

 include \masm32\Macros\Strings.mac

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                           &#1057; &#1048; &#1052; &#1042; &#1054; &#1051; &#1068; &#1053; &#1067; &#1045;    &#1050; &#1054; &#1053; &#1057; &#1058; &#1040; &#1053; &#1058; &#1067;                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 IOPM_SIZE equ 2000h

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                              &#1050; &#1054; &#1044;                                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                       DriverEntry                                                 
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DriverEntry proc pDriverObject:PDRIVER_OBJECT, pusRegistryPath:PUNICODE_STRING

 LOCAL status:NTSTATUS
 LOCAL oa:OBJECT_ATTRIBUTES
 LOCAL hKey:HANDLE
 LOCAL kvpi:KEY_VALUE_PARTIAL_INFORMATION
 LOCAL pIopm:PVOID
 LOCAL pProcess:LPVOID

     invoke DbgPrint, $CTA0(&quot;giveio: Entering DriverEntry&quot;)
        
     mov status, STATUS_DEVICE_CONFIGURATION_ERROR

     lea ecx, oa
     InitializeObjectAttributes ecx, pusRegistryPath, 0, NULL, NULL

     invoke ZwOpenKey, addr hKey, KEY_READ, ecx
     .if eax == STATUS_SUCCESS

         push eax
         invoke ZwQueryValueKey, hKey, $CCOUNTED_UNICODE_STRING(&quot;ProcessId&quot;, 4), \
                                KeyValuePartialInformation, addr kvpi, sizeof kvpi, esp
         pop ecx

         .if ( eax != STATUS_OBJECT_NAME_NOT_FOUND ) &amp;&amp; ( ecx != 0 )

             invoke DbgPrint, $CTA0(&quot;giveio: Process ID: %X&quot;), \
                                 dword ptr (KEY_VALUE_PARTIAL_INFORMATION PTR [kvpi]).Data

             ; &#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084; &#1073;&#1091;&#1092;&#1077;&#1088; &#1076;&#1083;&#1103; &#1082;&#1072;&#1088;&#1090;&#1099; &#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1103; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;

             invoke MmAllocateNonCachedMemory, IOPM_SIZE
             .if eax != NULL
                 mov pIopm, eax

                 lea ecx, kvpi
                 invoke PsLookupProcessByProcessId, \
                         dword ptr (KEY_VALUE_PARTIAL_INFORMATION PTR [ecx]).Data, addr pProcess
                 .if eax == STATUS_SUCCESS

                     invoke DbgPrint, $CTA0(&quot;giveio: PTR KPROCESS: %08X&quot;), pProcess

                     invoke Ke386QueryIoAccessMap, 0, pIopm
                     .if al != 0

                         ; &#1054;&#1090;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1087;&#1086;&#1088;&#1090;&#1091; 70h

                         mov ecx, pIopm
                         add ecx, 70h / 8
                         mov eax, [ecx]
                         btr eax, 70h MOD 8
                         mov [ecx], eax


                        ; &#1054;&#1090;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; &#1087;&#1086;&#1088;&#1090;&#1091; 71h

                         mov ecx, pIopm
                         add ecx, 71h / 8
                         mov eax, [ecx]
                         btr eax, 71h MOD 8
                         mov [ecx], eax

                         invoke Ke386SetIoAccessMap, 1, pIopm
                         .if al != 0
                             invoke Ke386IoSetAccessProcess, pProcess, 1
                             .if al != 0
                                 invoke DbgPrint, $CTA0(&quot;giveio: I/O permission is successfully given&quot;)
                             .else
                                 invoke DbgPrint, $CTA0(&quot;giveio: I/O permission is failed&quot;)
                                 mov status, STATUS_IO_PRIVILEGE_FAILED
                             .endif
                         .else
                             mov status, STATUS_IO_PRIVILEGE_FAILED
                         .endif
                     .else
                         mov status, STATUS_IO_PRIVILEGE_FAILED
                     .endif
                     invoke ObDereferenceObject, pProcess
                 .else
                     mov status, STATUS_OBJECT_TYPE_MISMATCH
                 .endif
                 invoke MmFreeNonCachedMemory, pIopm, IOPM_SIZE
             .else
                 invoke DbgPrint, $CTA0(&quot;giveio: Call to MmAllocateNonCachedMemory failed&quot;)
                 mov status, STATUS_INSUFFICIENT_RESOURCES
             .endif
         .endif
         invoke ZwClose, hKey
     .endif

     invoke DbgPrint, $CTA0(&quot;giveio: Leaving DriverEntry&quot;)

     mov eax, status
     ret

 DriverEntry endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                                                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 end DriverEntry

 :make
 \masm32\bin\ml /nologo /c /coff giveio.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:giveio.sys /subsystem:native giveio.obj

 del giveio.obj

 echo.
 pause

</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050;&#1086;&#1076;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1086;&#1089;&#1085;&#1086;&#1074;&#1072;&#1085; &#1085;&#1072;
&#1093;&#1086;&#1088;&#1086;&#1096;&#1086;
&#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1085;&#1099;&#1093;
&#1080;&#1079;&#1099;&#1089;&#1082;&#1072;&#1085;&#1080;&#1103;&#1093;
&#1044;&#1077;&#1081;&#1083;&#1072;
&#1056;&#1086;&#1073;&#1077;&#1088;&#1090;&#1089;&#1072;,
&#1074;&#1086;&#1089;&#1093;&#1086;&#1076;&#1103;&#1097;&#1080;&#1093;
&#1072;&#1078; &#1082; 96 &#1075;&#1086;&#1076;&#1091;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086;&#1075;&#1086;
&#1074;&#1077;&#1082;&#1072;, &#1074;
&#1086;&#1073;&#1083;&#1072;&#1089;&#1090;&#1080;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1091;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1085;&#1072; &#1087;&#1083;&#1072;&#1090;&#1092;&#1086;&#1088;&#1084;&#1077;
Windows NT. &#1071; &#1088;&#1077;&#1096;&#1080;&#1083;, &#1095;&#1090;&#1086;
&#1079;&#1076;&#1077;&#1089;&#1100; &#1101;&#1090;&#1086;
&#1073;&#1091;&#1076;&#1077;&#1090; &#1086;&#1095;&#1077;&#1085;&#1100;
&#1082;&#1089;&#1090;&#1072;&#1090;&#1080;.
&#1055;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1080; &#1044;&#1077;&#1081;&#1083;&#1072;
&#1056;&#1086;&#1073;&#1077;&#1088;&#1090;&#1089;&#1072; &quot;&#1055;&#1088;&#1103;&#1084;&#1086;&#1081;
&#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076; &#1074;
&#1089;&#1088;&#1077;&#1076;&#1077; Windows NT&quot;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; <a href="http://void.ru/?do=printable&amp;id=701"><u>http://void.ru/?do=printable&amp;id=701</u></a>.
<p>&#1071; &#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1086;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1085;&#1072; &#1090;&#1077;&#1086;&#1088;&#1080;&#1080;, &#1090;.&#1082;.
&#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086; &#1101;&#1090;&#1086;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1086; &#1074;
&#1074;&#1099;&#1096;&#1077;&#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1090;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;. &#1045;&#1089;&#1083;&#1080;
&#1086;&#1095;&#1077;&#1085;&#1100;
&#1082;&#1086;&#1088;&#1086;&#1090;&#1082;&#1086;, &#1090;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1075;&#1080;&#1073;&#1082;&#1080;&#1081;
&#1084;&#1077;&#1093;&#1072;&#1085;&#1080;&#1079;&#1084;
&#1079;&#1072;&#1097;&#1080;&#1090;&#1099;,
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1086;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
&#1083;&#1102;&#1073;&#1086;&#1084;&#1091;
&#1087;&#1086;&#1076;&#1084;&#1085;&#1086;&#1078;&#1077;&#1089;&#1090;&#1074;&#1091;
&#1087;&#1086;&#1088;&#1090;&#1086;&#1074; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086;
&#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1074;&#1079;&#1103;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;. &#1069;&#1090;&#1086;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;
&#1073;&#1083;&#1072;&#1075;&#1086;&#1076;&#1072;&#1088;&#1103; <i>&#1082;&#1072;&#1088;&#1090;&#1077;
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;</i>
(I/O Permission Map, IOPM). &#1053;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1077;
&#1087;&#1088;&#1086; &#1101;&#1090;&#1091; &#1082;&#1072;&#1088;&#1090;&#1091;
&#1079;&#1076;&#1077;&#1089;&#1100;: <a href="http://www.sasm.narod.ru/docs/pm/pm_tss/chap_5.htm"><u>http://www.sasm.narod.ru/docs/pm/pm_tss/chap_5.htm</u></a>.
&#1055;&#1088;&#1086; <i>&#1089;&#1077;&#1075;&#1084;&#1077;&#1085;&#1090;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1103;
&#1079;&#1072;&#1076;&#1072;&#1095;&#1080;</i> (Task State Segment, TSS),
&#1090;&#1072;&#1082;&#1078;&#1077;
&#1072;&#1082;&#1090;&#1080;&#1074;&#1085;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1102;&#1097;&#1080;&#1081;
&#1074; &#1101;&#1090;&#1086;&#1084;
&#1091;&#1095;&#1072;&#1089;&#1090;&#1080;&#1077;,
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1090;&#1072;&#1084;
&#1078;&#1077;: <a href="http://www.sasm.narod.ru/docs/pm/pm_tss/chap_3.htm"><u>http://www.sasm.narod.ru/docs/pm/pm_tss/chap_3.htm</u></a>.
<p>&#1050;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1080;&#1084;&#1077;&#1090;&#1100;
&#1089;&#1074;&#1086;&#1102;
&#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1091;&#1102;
IOPM. &#1050;&#1072;&#1078;&#1076;&#1099;&#1081; &#1073;&#1080;&#1090; &#1074;
&#1101;&#1090;&#1086;&#1081; &#1082;&#1072;&#1088;&#1090;&#1077;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1073;&#1072;&#1081;&#1090;&#1086;&#1074;&#1086;&#1084;&#1091;
&#1087;&#1086;&#1088;&#1090;&#1091; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1045;&#1089;&#1083;&#1080; &#1086;&#1085; (&#1073;&#1080;&#1090;)
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;,
&#1090;&#1086; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1084;&#1091;
&#1087;&#1086;&#1088;&#1090;&#1091;
&#1079;&#1072;&#1087;&#1088;&#1077;&#1097;&#1077;&#1085;,
&#1077;&#1089;&#1083;&#1080; &#1089;&#1073;&#1088;&#1086;&#1096;&#1077;&#1085; -
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;.
&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;,
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086;
&#1087;&#1086;&#1088;&#1090;&#1086;&#1074; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;
&#1072;&#1088;&#1093;&#1080;&#1090;&#1077;&#1082;&#1090;&#1091;&#1088;&#1077;
x86 &#1089;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
65535, &#1090;&#1086;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; IOPM
&#1088;&#1072;&#1074;&#1077;&#1085; 2000h &#1073;&#1072;&#1081;&#1090;.
<p><i>&#1042;&#1089;&#1105;, &#1095;&#1090;&#1086;
&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1086; &#1074;&#1099;&#1096;&#1077;
&#1086; I/O Permission Map &#1074;&#1077;&#1088;&#1085;&#1086;, &#1085;&#1086;
&#1085;&#1077; &#1076;&#1083;&#1103;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1093;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084; Windows NT+.
&#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1095;&#1080;&#1082;&#1080;
&#1101;&#1090;&#1080;&#1093; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;
&#1086;&#1090;&#1082;&#1072;&#1079;&#1072;&#1083;&#1080;&#1089;&#1100;
&#1086;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086; TSS
&#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;, &#1087;&#1086;
&#1087;&#1088;&#1080;&#1095;&#1080;&#1085;&#1077;
&#1093;&#1091;&#1076;&#1096;&#1077;&#1081;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1076;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1080;,
&#1072; &#1092;&#1080;&#1088;&#1084;&#1072; Intel
&#1079;&#1072;&#1076;&#1091;&#1084;&#1099;&#1074;&#1072;&#1083;&#1072;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086; &#1090;&#1072;&#1082; &#1080;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1099;
&#1101;&#1090;&#1086;&#1081; &#1092;&#1080;&#1088;&#1084;&#1099;
&#1090;&#1072;&#1082;&#1091;&#1102;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1102;&#1090;.
&#1054;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1077;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084; Windows NT+
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090;
&#1086;&#1076;&#1080;&#1085; TSS &#1085;&#1072; &#1074;&#1089;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1099;.
&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091; TSS
&#1075;&#1083;&#1086;&#1073;&#1072;&#1083;&#1077;&#1085;, &#1090;&#1086; &#1080;
IOPM &#1090;&#1086;&#1078;&#1077;. &#1069;&#1090;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1095;&#1090;&#1086;
&#1083;&#1102;&#1073;&#1099;&#1077;
&#1084;&#1072;&#1085;&#1080;&#1087;&#1091;&#1083;&#1103;&#1094;&#1080;&#1080;
&#1089; &#1085;&#1077;&#1081;
&#1086;&#1090;&#1088;&#1072;&#1078;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1085;&#1072; &#1074;&#1089;&#1077;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1102;&#1097;&#1080;&#1077;&#1089;&#1103;,
&#1072; &#1090;&#1072;&#1082;&#1078;&#1077; &#1090;&#1077;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1073;&#1091;&#1076;&#1091;&#1090;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;&#1089;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1099;.</i>
<p>&#1044;&#1083;&#1103;
&#1084;&#1072;&#1085;&#1080;&#1087;&#1091;&#1083;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
IOPM &#1074; &#1084;&#1086;&#1076;&#1091;&#1083;&#1077; ntoskrnl.exe
&#1080;&#1084;&#1077;&#1102;&#1090;&#1089;&#1103; &#1076;&#1074;&#1077;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;
&#1085;&#1077;&#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;: Ke386QueryIoAccessMap &#1080;
Ke386SetIoAccessMap. &#1055;&#1088;&#1080;&#1074;&#1077;&#1076;&#1091;
&#1080;&#1093; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1085;&#1086;&#1077;
&#1089;&#1090;&#1072;&#1088;&#1072;&#1085;&#1080;&#1103;&#1084;&#1080;
&#1044;&#1077;&#1081;&#1083;&#1072;
&#1056;&#1086;&#1073;&#1077;&#1088;&#1090;&#1089;&#1072; &#1080;
&#1084;&#1086;&#1080;&#1084;&#1080; &#1090;&#1086;&#1078;&#1077;.<br>
<br>
<br>
<p><code><!--mstheme--></font>
<pre> Ke386QueryIoAccessMap proto stdcall dwFlag:DWORD, pIopm:PVOID

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1091;&#1102; IOPM
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; 2000h &#1080;&#1079;
TSS &#1074; &#1073;&#1091;&#1092;&#1077;&#1088;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077; <i>pIopm</i>.
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>dwFlag</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>0 - &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
        &#1073;&#1091;&#1092;&#1077;&#1088;
        &#1077;&#1076;&#1080;&#1085;&#1080;&#1095;&#1085;&#1099;&#1084;&#1080;
        &#1073;&#1080;&#1090;&#1072;&#1084;&#1080; (&#1090;.&#1077;
        &#1079;&#1072;&#1087;&#1088;&#1077;&#1090;&#1080;&#1090;&#1100;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;&#1086;
        &#1074;&#1089;&#1077;&#1084; &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;);<br>
        1 -
        &#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1090;&#1077;&#1082;&#1091;&#1097;&#1091;&#1102; IOPM &#1080;&#1079;
        TSS &#1074; &#1073;&#1091;&#1092;&#1077;&#1088;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pIopm</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1073;&#1083;&#1086;&#1082;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1076;&#1083;&#1103;
        &#1087;&#1088;&#1080;&#1077;&#1084;&#1072; IOPM,
        &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; &#1085;&#1077;
        &#1084;&#1077;&#1085;&#1077;&#1077; 2000h &#1073;&#1072;&#1081;&#1090;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1055;&#1088;&#1080;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1084;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;,
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; al
&#1085;&#1077;&#1085;&#1091;&#1083;&#1077;&#1074;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;.<br>
&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1096;&#1083;&#1072;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086; al
&#1088;&#1072;&#1074;&#1077;&#1085; &#1085;&#1091;&#1083;&#1102;.<br>
<br>
<br>
<p><code><!--mstheme--></font>
<pre> Ke386SetIoAccessMap proto stdcall dwFlag:DWORD, pIopm:PVOID

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1050;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1091;&#1102; IOPM
&#1076;&#1083;&#1080;&#1085;&#1085;&#1086;&#1081; 2000h &#1080;&#1079;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077; <i>pIopm</i>,
&#1074; TSS.
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>dwFlag</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; 1 -
        &#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1072;&#1077;&#1090;
        &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;.
        &#1055;&#1088;&#1080; &#1083;&#1102;&#1073;&#1086;&#1084;
        &#1076;&#1088;&#1091;&#1075;&#1086;&#1084;
        &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1080;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
        &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
        &#1086;&#1096;&#1080;&#1073;&#1082;&#1091;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pIopm</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1073;&#1083;&#1086;&#1082;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
        &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1080;&#1081;
        IOPM, &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084;
        &#1085;&#1077; &#1084;&#1077;&#1085;&#1077;&#1077; 2000h
        &#1073;&#1072;&#1081;&#1090;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1055;&#1088;&#1080;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1084;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;,
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; al
&#1085;&#1077;&#1085;&#1091;&#1083;&#1077;&#1074;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;.<br>
&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1096;&#1083;&#1072;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086; al
&#1088;&#1072;&#1074;&#1077;&#1085; &#1085;&#1091;&#1083;&#1102;.<br>
<br>
<br>
<p>&#1048; &#1077;&#1097;&#1077; &#1086;&#1076;&#1085;&#1072;
&#1086;&#1095;&#1077;&#1085;&#1100;
&#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1072;&#1103;,
&#1090;&#1072;&#1082;&#1078;&#1077;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;
&#1085;&#1077;&#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1072;&#1103;,
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; &#1080;&#1079;
&#1084;&#1086;&#1076;&#1091;&#1083;&#1103; ntoskrnl.exe.<br>
<br>
<br>
<p><code><!--mstheme--></font>
<pre> Ke386IoSetAccessProcess proto stdcall pProcess:PTR KPROCESS, dwFlag:DWORD

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1056;&#1072;&#1079;&#1088;&#1077;&#1096;&#1072;&#1077;&#1090;/&#1079;&#1072;&#1087;&#1088;&#1077;&#1097;&#1072;&#1077;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
IOPM &#1076;&#1083;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pProcess</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; KPROCESS
        (&#1095;&#1091;&#1090;&#1100;
        &#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1081;
        &#1085;&#1080;&#1078;&#1077;).<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="100"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>dwFlag</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>0 - &#1079;&#1072;&#1087;&#1088;&#1077;&#1090;&#1080;&#1090;&#1100;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
        &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
        &#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1082;&#1086;&#1081;
        &#1089;&#1084;&#1077;&#1097;&#1077;&#1085;&#1080;&#1103; IOPM
        &#1079;&#1072; &#1075;&#1088;&#1072;&#1085;&#1080;&#1094;&#1091;
        &#1089;&#1077;&#1075;&#1084;&#1077;&#1085;&#1090;&#1072; TSS;<br>
        1 - &#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1080;&#1090;&#1100;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
        &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
        &#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1103;
        &#1089;&#1084;&#1077;&#1097;&#1077;&#1085;&#1080;&#1077; IOPM &#1074;
        &#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1072;&#1093; TSS
        &#1088;&#1072;&#1074;&#1085;&#1099;&#1084; 88h.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1055;&#1088;&#1080;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1084;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;,
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090; &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; al
&#1085;&#1077;&#1085;&#1091;&#1083;&#1077;&#1074;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;.<br>
&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1096;&#1083;&#1072;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086; al
&#1088;&#1072;&#1074;&#1077;&#1085; &#1085;&#1091;&#1083;&#1102;.<br>
<br>
<br>
<p>&#1055;&#1086; &#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1091;
&#1074; &#1080;&#1084;&#1077;&#1085;&#1080;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1082;
&#1082;&#1072;&#1082;&#1086;&#1084;&#1091;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1091;
&#1086;&#1085;&#1072;
&#1086;&#1090;&#1085;&#1086;&#1089;&#1080;&#1090;&#1089;&#1103;: Ke -
&#1103;&#1076;&#1088;&#1086;, Ob -
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;, Ps -
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1074;, Mm -
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1080; &#1090;.&#1076;.<br>
<br>
<br>
<p>&#1044;&#1083;&#1103; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072;
&#1082; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1084;
&#1082;&#1086;&#1076; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1080; (handles),
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; &#1085;&#1080;
&#1095;&#1077;&#1084; &#1080;&#1085;&#1099;&#1084; &#1082;&#1072;&#1082;
&#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1072;&#1084;&#1080; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1093;
&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072;&#1093;, &#1074;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;&#1089;&#1103;
&#1089;&#1072;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;. &#1053;&#1091; &#1072;
&#1095;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077;, &#1085;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1084; &#1076;&#1077;&#1083;&#1077;,
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1084;&#1099; &#1091;&#1078;&#1077;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1080;
&#1074;&#1099;&#1096;&#1077;. &#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;,
&#1087;&#1086;&#1089;&#1088;&#1077;&#1076;&#1089;&#1090;&#1074;&#1086;&#1084;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1086;&#1090;&#1088;&#1077;&#1079;&#1072;&#1077;&#1090; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1086;&#1090; &#1087;&#1088;&#1103;&#1084;&#1086;&#1075;&#1086;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1091;. &#1050;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;,
&#1085;&#1072;&#1087;&#1088;&#1086;&#1090;&#1080;&#1074;,
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1103;&#1084;&#1080;,
&#1090;.&#1082;. &#1086;&#1085; &#1080; &#1077;&#1089;&#1090;&#1100;
&#1089;&#1072;&#1084;&#1072; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1080; &#1080;&#1084;&#1077;&#1077;&#1090; &#1087;&#1088;&#1072;&#1074;&#1086;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1089;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1084;&#1080;
&#1095;&#1090;&#1086; &#1093;&#1086;&#1095;&#1077;&#1090;.
&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; Ke386IoSetAccessProcess
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;, &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1087;&#1077;&#1088;&#1074;&#1086;&#1075;&#1086;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&quot;
(process object), &#1090;.&#1077;. &#1085;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; KPROCESS (&#1089;&#1084;.
\include\w2k\w2kundoc.inc. &#1071;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1083;
&#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089; &quot;w2k&quot;, &#1090;.&#1082;.
&#1074; Windows XP
&#1085;&#1077;&#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
&#1089;&#1080;&#1083;&#1100;&#1085;&#1086;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1102;&#1090;&#1089;&#1103;.
&#1058;&#1072;&#1082; &#1095;&#1090;&#1086;,
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1092;&#1072;&#1081;&#1083;&#1080;&#1082;
&#1087;&#1088;&#1080;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1094;&#1080;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1086;&#1075;&#1086;
&#1076;&#1083;&#1103; XP, &#1085;&#1077; &#1089;&#1072;&#1084;&#1072;&#1103;
&#1083;&#1091;&#1095;&#1096;&#1072;&#1103; &#1080;&#1076;&#1077;&#1103;).
&#1050;&#1086;&#1076; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
Ke386IoSetAccessProcess
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1095;&#1083;&#1077;&#1085; <i>IopmOffset</i>
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; KPROCESS &#1074;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;.
<p>&#1056;&#1072;&#1079; &#1084;&#1099; &#1073;&#1091;&#1076;&#1077;&#1084;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; Ke386IoSetAccessProcess,
&#1085;&#1072;&#1084;
&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&quot;.
&#1045;&#1075;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1088;&#1072;&#1079;&#1085;&#1099;&#1084;&#1080;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1072;&#1084;&#1080;. &#1071;
&#1074;&#1099;&#1073;&#1088;&#1072;&#1083;
&#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1077;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; - &#1087;&#1086;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1091;.
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1074;
&#1084;&#1086;&#1076;&#1091;&#1083;&#1077; DateTime, &#1084;&#1099;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072; &#1080;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1077;&#1075;&#1086;
&#1074; &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;. &#1042;
&#1076;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1084;&#1099;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#1076;&#1083;&#1103;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1095;&#1080;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1074;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;. &#1058;.&#1082;.
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072; DriverEntry
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072; System,
&#1085;&#1077;&#1090;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1080;
&#1091;&#1079;&#1085;&#1072;&#1090;&#1100;, &#1082;&#1072;&#1082;&#1086;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089; &#1085;&#1072;
&#1089;&#1072;&#1084;&#1086;&#1084; &#1076;&#1077;&#1083;&#1077;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1083;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;.
&#1042;&#1090;&#1086;&#1088;&#1099;&#1084;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084;, <i>pusRegistryPath</i>,
&#1074; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
DriverEntry &#1084;&#1099; &#1080;&#1084;&#1077;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;,
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1080;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;. &#1052;&#1099;
&#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1089;&#1103;
&#1080;&#1084;, &#1095;&#1090;&#1086;&#1073;&#1099;
&#1080;&#1079;&#1074;&#1083;&#1077;&#1095;&#1100; &#1080;&#1079;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.<br>
<br>
<br>
<p>&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1081;&#1090;&#1080; &#1082;
&#1088;&#1072;&#1079;&#1073;&#1086;&#1088;&#1091; &#1082;&#1086;&#1076;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; giveio.sys.
<p><code><!--mstheme--></font>
<pre> lea ecx, oa
 InitializeObjectAttributes ecx, pusRegistryPath, 0, NULL, NULL

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1083;&#1103;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ZwOpenKey
&#1085;&#1072;&#1084;
&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
OBJECT_ATTRIBUTES (\include\w2k\ntdef.inc). &#1044;&#1083;&#1103; &#1077;&#1077;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103; &#1103;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; InitializeObjectAttributes.
&#1052;&#1086;&#1078;&#1085;&#1086;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100; &#1080; &quot;&#1074;&#1088;&#1091;&#1095;&#1085;&#1091;&#1102;&quot;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b> lea ecx, oa
 xor eax, eax
 assume ecx:ptr OBJECT_ATTRIBUTES
 mov [ecx].dwLength, sizeof OBJECT_ATTRIBUTES
 mov [ecx].RootDirectory, eax                       ; NULL
 push pusRegistryPath
 pop [ecx].ObjectName
 mov [ecx].Attributes, eax                          ; 0
 mov [ecx].SecurityDescriptor, eax                  ; NULL
 mov [ecx].SecurityQualityOfService, eax            ; NULL
 assume ecx:nothing
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1052;&#1072;&#1082;&#1088;&#1086;&#1089; InitializeObjectAttributes
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103;
&#1077;&#1097;&#1077; &#1085;&#1072; &#1089;&#1090;&#1072;&#1076;&#1080;&#1080;
&#1088;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;,
&#1090;&#1072;&#1082; &#1095;&#1090;&#1086; &#1085;&#1077;
&#1089;&#1086;&#1074;&#1077;&#1090;&#1091;&#1102;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1077;&#1075;&#1086; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1086;&#1084;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1085;&#1099;&#1084; &#1086;&#1090;
&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1086;&#1075;&#1086;
&#1074;&#1099;&#1096;&#1077;. &#1045;&#1089;&#1083;&#1080; &#1095;&#1090;&#1086;
&#1085;&#1077; &#1090;&#1072;&#1082; - &#1103; &#1085;&#1077;
&#1074;&#1080;&#1085;&#1086;&#1074;&#1072;&#1090; ;-)
<p><code><!--mstheme--></font>
<pre> <font size="2"><b>invoke ZwOpenKey, addr hKey, KEY_READ, ecx
 .if eax == STATUS_SUCCESS

     push eax
     invoke ZwQueryValueKey, hKey, $CCOUNTED_UNICODE_STRING(&quot;ProcessId&quot;, 4), \
                             KeyValuePartialInformation, addr kvpi, sizeof kvpi, esp
     pop ecx
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ZwOpenKey
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1072;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072; &#1074;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; hKey.
&#1042;&#1090;&#1086;&#1088;&#1099;&#1084;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084; &#1074;
&#1101;&#1090;&#1091; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1087;&#1088;&#1072;&#1074;&#1072;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072;,
&#1090;&#1088;&#1077;&#1090;&#1100;&#1080;&#1084; -
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
OBJECT_ATTRIBUTES,
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1085;&#1072;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1084;
&#1101;&#1090;&#1072;&#1087;&#1077;. &#1057;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ZwQueryValueKey
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;,
&#1079;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1086;&#1077; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072; ProcessId.
&#1042;&#1090;&#1086;&#1088;&#1099;&#1084;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084; &#1074;
&#1101;&#1090;&#1091; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1091;&#1102;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; UNICODE_STRING,
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1091;&#1102;
&#1080;&#1084;&#1103;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;,
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086; &#1084;&#1099;
&#1093;&#1086;&#1090;&#1080;&#1084;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;. &#1071;
&#1089;&#1090;&#1072;&#1088;&#1072;&#1102;&#1089;&#1100;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1080;
&#1087;&#1088;&#1077;&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1072;
masm &#1085;&#1072; &quot;&#1087;&#1086;&#1083;&#1085;&#1091;&#1102;
&#1082;&#1072;&#1090;&#1091;&#1096;&#1082;&#1091;&quot;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1080; &#1090;&#1091;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;
&#1089;&#1072;&#1084;&#1086;&#1087;&#1080;&#1089;&#1085;&#1099;&#1081;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; $CCOUNTED_UNICODE_STRING (&#1074;&#1089;&#1077;
&#1090;&#1072;&#1084; &#1078;&#1077; - \Macros\Strings.mac).
&#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072;
&#1090;&#1086;, &#1095;&#1090;&#1086; &#1103;
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;
&#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080; &#1087;&#1086;
&#1075;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077;
&#1076;&#1074;&#1086;&#1081;&#1085;&#1086;&#1075;&#1086;
&#1089;&#1083;&#1086;&#1074;&#1072; (&#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1072;&#1084;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; UNICODE_STRING
&#1078;&#1077;&#1089;&#1090;&#1082;&#1086;
&#1087;&#1088;&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1086; &#1074;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1077; &#1080;
&#1088;&#1072;&#1074;&#1085;&#1086;
&#1076;&#1074;&#1086;&#1081;&#1085;&#1086;&#1084;&#1091;
&#1089;&#1083;&#1086;&#1074;&#1091;). &#1050;&#1072;&#1082;&#1086;&#1081;-&#1090;&#1086;
&#1086;&#1089;&#1086;&#1073;&#1086;&#1081;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;
&#1074; &#1101;&#1090;&#1086;&#1084; &#1090;&#1091;&#1090; &#1085;&#1077;&#1090;,
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;, &#1103; &#1076;&#1072;&#1102;
&#1074;&#1072;&#1084;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1086;&#1094;&#1077;&#1085;&#1080;&#1090;&#1100;
&#1075;&#1080;&#1073;&#1082;&#1086;&#1089;&#1090;&#1100; &#1080;
&#1091;&#1076;&#1086;&#1073;&#1089;&#1090;&#1074;&#1086;
&#1084;&#1086;&#1080;&#1093;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1086;&#1074;.
&#1056;&#1077;&#1082;&#1083;&#1072;&#1084;&#1085;&#1072;&#1103;
&#1087;&#1072;&#1091;&#1079;&#1072; ;-) &#1045;&#1089;&#1083;&#1080;
&#1086;&#1088;&#1075;&#1072;&#1085;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1085;&#1077;
&#1087;&#1077;&#1088;&#1077;&#1074;&#1072;&#1088;&#1080;&#1074;&#1072;&#1077;&#1090;&#1077;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1099;, &#1090;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1088;&#1072;&#1076;&#1080;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1081;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
Unicode-&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;, &#1080;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; UNICODE_STRING
&#1077;&#1077;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1077;&#1081;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b> usz dw 'U', 'n', 'i', 'c', 'o', 'd', 'e', ' ', 's', 't', 'r', 'i', 'n', 'g', 0
 us UNICODE_STRING {sizeof usz - 2, sizeof usz, offset usz}
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1052;&#1077;&#1085;&#1103; &#1101;&#1090;&#1086;&#1090;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;
&#1085;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1077;
&#1074;&#1076;&#1086;&#1093;&#1085;&#1086;&#1074;&#1083;&#1103;&#1083;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1103; &#1080;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083; &#1076;&#1083;&#1103;
&#1101;&#1090;&#1086;&#1081; &#1094;&#1077;&#1083;&#1080;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1099; COUNTED_UNICODE_STRING, $COUNTED_UNICODE_STRING,
CCOUNTED_UNICODE_STRING, $CCOUNTED_UNICODE_STRING (&#1089;&#1084;. \Macros\Strings.mac).
<p>&#1058;&#1088;&#1077;&#1090;&#1080;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ZwQueryValueKey
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;
&#1090;&#1080;&#1087;
&#1079;&#1072;&#1087;&#1088;&#1072;&#1096;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1081;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080;.
KeyValuePartialInformation -
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1072;&#1103;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1072;
&#1088;&#1072;&#1074;&#1085;&#1072;&#1103; 2 (\include\w2k\ntddk.inc).
&#1063;&#1077;&#1090;&#1074;&#1077;&#1088;&#1090;&#1099;&#1081; &#1080;
&#1087;&#1103;&#1090;&#1099;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; -
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
KEY_VALUE_PARTIAL_INFORMATION &#1080; &#1077;&#1077;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;.
&#1042; &#1095;&#1083;&#1077;&#1085;&#1077; Data &#1101;&#1090;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; &#1084;&#1099;
&#1080; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.
&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; -
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1091;&#1102;,
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; DWORD, &#1074;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1086;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1080;&#1079; &#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;
&#1073;&#1072;&#1081;&#1090;. &#1055;&#1077;&#1088;&#1077;&#1076;
&#1089;&#1072;&#1084;&#1099;&#1084;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084; ZwQueryValueKey,
&#1084;&#1099;
&#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1080;&#1088;&#1091;&#1077;&#1084;
&#1085;&#1072; &#1089;&#1090;&#1077;&#1082;&#1077; &#1076;&#1083;&#1103;
&#1085;&#1077;&#1075;&#1086; &#1084;&#1077;&#1089;&#1090;&#1086;, &#1072;
&#1087;&#1086;&#1089;&#1083;&#1077; &#1074;&#1099;&#1079;&#1086;&#1074;&#1072;
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;. &#1071;
&#1087;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1085;&#1086;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1089;&#1100;
&#1090;&#1072;&#1082;&#1080;&#1084;
&#1087;&#1088;&#1080;&#1077;&#1084;&#1086;&#1084; -
&#1086;&#1095;&#1077;&#1085;&#1100; &#1091;&#1076;&#1086;&#1073;&#1085;&#1086;.
<p><code><!--mstheme--></font>
<pre><font size="2"><b> .if ( eax != STATUS_OBJECT_NAME_NOT_FOUND ) &amp;&amp; ( ecx != 0 )
     invoke MmAllocateNonCachedMemory, IOPM_SIZE
     .if eax != NULL
         mov pIopm, eax

</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; &#1074;&#1099;&#1079;&#1086;&#1074;
ZwQueryValueKey &#1087;&#1088;&#1086;&#1096;&#1077;&#1083;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;,
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; MmAllocateNonCachedMemory
&#1082;&#1091;&#1089;&#1086;&#1095;&#1077;&#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1074; &#1087;&#1091;&#1083;&#1077;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1081;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; (&#1090;&#1072;&#1082;&#1072;&#1103;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;
&#1085;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1077;
&#1089;&#1073;&#1088;&#1072;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1085;&#1072; &#1076;&#1080;&#1089;&#1082;),
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; 2000h
&#1073;&#1072;&#1081;&#1090; -
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; &#1082;&#1072;&#1088;&#1090;&#1099;
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1074;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; pIopm.
<p><code><!--mstheme--></font>
<pre><font size="2"><b> lea ecx, kvpi
 invoke PsLookupProcessByProcessId, \
           dword ptr (KEY_VALUE_PARTIAL_INFORMATION PTR [ecx]).Data, addr pProcess
 .if eax == STATUS_SUCCESS
     invoke Ke386QueryIoAccessMap, 0, pIopm
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1077;&#1088;&#1077;&#1076;&#1072;&#1074;&#1072;&#1103; &#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; PsLookupProcessByProcessId
&#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1088;&#1072;&#1085;&#1077;&#1077;
&#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;,
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
KPROCESS &#1074;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; pProcess.
&#1042;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; Ke386QueryIoAccessMap,
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1084; IOPM &#1074;
&#1073;&#1091;&#1092;&#1077;&#1088;.
<p><code><!--mstheme--></font>
<pre><font size="2"><b> .if al != 0

     mov ecx, pIopm
     add ecx, 70h / 8
     mov eax, [ecx]
     btr eax, 70h MOD 8
     mov [ecx], eax

     mov ecx, pIopm
     add ecx, 71h / 8
     mov eax, [ecx]
     btr eax, 71h MOD 8
     mov [ecx], eax

     invoke Ke386SetIoAccessMap, 1, pIopm
     .if al != 0
         invoke Ke386IoSetAccessProcess, pProcess, 1
         .if al != 0
             ; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;
         .else
             mov status, STATUS_IO_PRIVILEGE_FAILED
         .endif
     .else
          mov status, STATUS_IO_PRIVILEGE_FAILED
     .endif
 .else
     mov status, STATUS_IO_PRIVILEGE_FAILED
 .endif</b></font>

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1057;&#1073;&#1088;&#1072;&#1089;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1073;&#1080;&#1090;&#1099;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
70h &#1080; 71h, &#1080;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1084;&#1086;&#1076;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1091;&#1102;
IOPM. &#1042;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; Ke386IoSetAccessProcess
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1072;&#1077;&#1084;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;.
&#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077;, &#1095;&#1090;&#1086;
Microsoft
&#1087;&#1088;&#1077;&#1076;&#1091;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1083;&#1072;
&#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1082;&#1086;&#1076; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080;
STATUS_IO_PRIVILEGE_FAILED. &#1042;
&#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1077;,
&#1079;&#1076;&#1077;&#1089;&#1100;
&#1089;&#1086;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1086;
&#1085;&#1077; &#1074;&#1072;&#1078;&#1085;&#1086;,
&#1082;&#1072;&#1082;&#1086;&#1081; &#1082;&#1086;&#1076;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1084;&#1099;
&#1074;&#1077;&#1088;&#1085;&#1077;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077; &#1087;&#1088;&#1080;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1077; &#1080;&#1079; DriverEntry. &#1071;,
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;
&#1087;&#1086;&#1090;&#1080;&#1093;&#1086;&#1085;&#1100;&#1082;&#1091;,
&#1074;&#1074;&#1086;&#1078;&#1091; &#1074;&#1072;&#1089; &#1074;
&#1082;&#1091;&#1088;&#1089; &#1076;&#1077;&#1083;&#1072;.
<p><code><!--mstheme--></font>
<pre> <font size="2"><b>    invoke ObDereferenceObject, pProcess
 .else
     mov status, STATUS_OBJECT_TYPE_MISMATCH
 .endif
</b></font>
</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1080;&#1081;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; PsLookupProcessByProcessId,
&#1091;&#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1083;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082; &#1085;&#1072;
&#1086;&#1073;&#1100;&#1077;&#1082;&#1090;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.
&#1057;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1099;&#1093;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;
&#1086;&#1073;&#1100;&#1077;&#1082;&#1090;&#1072; &#1080;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1085;&#1099;&#1093;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082; &#1085;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;.
&#1054;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1103;&#1084;&#1080;,
&#1074; &#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1086;&#1084;,
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1076; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1089;&#1089;&#1099;&#1083;&#1082;&#1072;&#1084;&#1080; -
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;.
&#1055;&#1086;&#1082;&#1072;, &#1093;&#1086;&#1090;&#1103; &#1073;&#1099;
&#1086;&#1076;&#1085;&#1086; &#1080;&#1079; &#1101;&#1090;&#1080;&#1093;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1081;, &#1085;&#1077;
&#1088;&#1072;&#1074;&#1085;&#1086; &#1085;&#1091;&#1083;&#1102;,
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1085;&#1077;
&#1091;&#1076;&#1072;&#1083;&#1103;&#1077;&#1090;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1080;&#1079;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;,
&#1089;&#1095;&#1080;&#1090;&#1072;&#1103; &#1095;&#1090;&#1086; &#1086;&#1085;
&#1077;&#1097;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1072;&#1082;&#1080;&#1084;-&#1090;&#1086;
&#1082;&#1086;&#1076;&#1086;&#1084;.
&#1042;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ObDereferenceObject
&#1084;&#1099; &#1091;&#1084;&#1077;&#1085;&#1100;&#1096;&#1072;&#1077;&#1084;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1089;&#1089;&#1099;&#1083;&#1086;&#1082; &#1085;&#1072;
&#1086;&#1073;&#1100;&#1077;&#1082;&#1090;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;.
<p><code><!--mstheme--></font>
<pre>       <b><font size="2">      invoke MmFreeNonCachedMemory, pIopm, IOPM_SIZE
         .else
             mov status, STATUS_INSUFFICIENT_RESOURCES
         .endif
     .endif
     invoke ZwClose, hKey
 .endif</font></b>

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1057; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; MmFreeNonCachedMemory
&#1086;&#1089;&#1074;&#1086;&#1073;&#1086;&#1078;&#1076;&#1072;&#1077;&#1084;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;, &#1080;,
&#1074;&#1099;&#1079;&#1086;&#1074;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ZwClose,
&#1079;&#1072;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1084;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1072;
&#1088;&#1077;&#1077;&#1089;&#1090;&#1088;&#1072;.
<p>&#1056;&#1072;&#1073;&#1086;&#1090;&#1072;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1085;&#1072; -
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077; &#1085;&#1077;
&#1085;&#1091;&#1078;&#1077;&#1085;. &#1058;.&#1082;. &#1086;&#1085;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1086;&#1076;&#1080;&#1085; &#1080;&#1079; &#1082;&#1086;&#1076;&#1086;&#1074;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1080;,
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1091;&#1076;&#1072;&#1083;&#1103;&#1077;&#1090; &#1077;&#1075;&#1086;
&#1080;&#1079; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1053;&#1086;
&#1090;&#1077;&#1087;&#1077;&#1088;&#1100;, &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1080;&#1084;&#1077;&#1077;&#1090; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;
&#1082; &#1076;&#1074;&#1091;&#1084; &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1095;&#1077;&#1084; &#1086;&#1085; &#1080;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;,
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1103;&#1089;&#1100; &#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; CMOS.
<p>&#1042; &#1101;&#1090;&#1086;&#1084;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1077; &#1103;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1083;&#1089;&#1103; &#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; CMOS,
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;, &#1076;&#1083;&#1103;
&#1088;&#1072;&#1079;&#1085;&#1086;&#1086;&#1073;&#1088;&#1072;&#1079;&#1080;&#1103;.
&#1052;&#1086;&#1078;&#1085;&#1086; &#1073;&#1099;&#1083;&#1086;,
&#1082;&#1072;&#1082; &#1074;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077; beeper.sys,
&#1087;&#1086;&#1087;&#1080;&#1097;&#1072;&#1090;&#1100;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1086;&#1084;.
&#1054;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102; &#1101;&#1090;&#1086;
&#1074;&#1072;&#1084;, &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1076;&#1086;&#1084;&#1072;&#1096;&#1085;&#1077;&#1075;&#1086;
&#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103;. &#1053;&#1072;&#1076;&#1086;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1100;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1042;&#1099;&#1079;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091; MakeBeep1,
&#1087;&#1088;&#1077;&#1076;&#1074;&#1072;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1091;&#1073;&#1088;&#1072;&#1074; &#1080;&#1079; &#1077;&#1077;
&#1090;&#1077;&#1083;&#1072; &#1082;&#1072;&#1084;&#1072;&#1085;&#1076;&#1099;
cli &#1080; sti, &#1090;.&#1082;.
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;
&#1087;&#1088;&#1080;&#1074;&#1080;&#1083;&#1077;&#1075;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1072; &#1074;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1074;&#1072;&#1084; &#1085;&#1080;&#1082;&#1090;&#1086; &#1085;&#1077;
&#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1080;&#1090;.
&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1080;&#1079;
&#1084;&#1086;&#1076;&#1091;&#1083;&#1103; hal.dll,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1090;&#1086;&#1078;&#1077; &#1085;&#1077;&#1083;&#1100;&#1079;&#1103;, &#1090;.&#1082;.
&#1086;&#1085;&#1080;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1090;&#1089;&#1103; &#1074;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1084;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1077;
&#1103;&#1076;&#1088;&#1072;.
&#1052;&#1072;&#1082;&#1089;&#1080;&#1084;&#1091;&#1084;, &#1095;&#1090;&#1086;
&#1074;&#1099; &#1084;&#1086;&#1078;&#1077;&#1090;&#1077;
&#1089;&#1077;&#1073;&#1077;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1080;&#1090;&#1100; -
&#1101;&#1090;&#1086;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;&#1086;
&#1074;&#1089;&#1077;&#1084; 65535 &#1087;&#1086;&#1088;&#1090;&#1072;&#1084;,
&#1086;&#1076;&#1085;&#1080;&#1084; &#1084;&#1072;&#1093;&#1086;&#1084;:
<p><code><!--mstheme--></font>
<pre><font size="2"><b> invoke MmAllocateNonCachedMemory, IOPM_SIZE
 .if eax != NULL
     mov pIopm, eax
     invoke RtlZeroMemory, pIopm, IOPM_SIZE

     lea ecx, kvpi
     invoke PsLookupProcessByProcessId, \
                 dword ptr (KEY_VALUE_PARTIAL_INFORMATION PTR [ecx]).Data, addr pProcess
     .if eax == STATUS_SUCCESS
         invoke Ke386SetIoAccessMap, 1, pIopm
         .if al != 0
             invoke Ke386IoSetAccessProcess, pProcess, 1
         .endif
         invoke ObDereferenceObject, pProcess
     .endif
     invoke MmFreeNonCachedMemory, pIopm, IOPM_SIZE
 .else
     mov status, STATUS_INSUFFICIENT_RESOURCES
 .endif

</b></font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1086;&#1084;&#1085;&#1080;&#1090;&#1077;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;, &#1095;&#1090;&#1086;
&#1073;&#1072;&#1083;&#1086;&#1074;&#1089;&#1090;&#1074;&#1086; &#1089;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1084;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1082;&#1086;&#1084; &#1080;
&#1095;&#1090;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; CMOS,
&#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1073;&#1077;&#1079;&#1086;&#1073;&#1080;&#1076;&#1085;&#1086;&#1077;
&#1079;&#1072;&#1085;&#1103;&#1090;&#1080;&#1077;. &#1053;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1077; &#1082;
&#1082;&#1072;&#1082;&#1080;&#1084;-&#1090;&#1086;
&#1076;&#1088;&#1091;&#1075;&#1080;&#1084;
&#1087;&#1086;&#1088;&#1090;&#1072;&#1084; &#1084;&#1086;&#1078;&#1077;&#1090;
&#1073;&#1099;&#1090;&#1100;
&#1085;&#1077;&#1073;&#1077;&#1079;&#1086;&#1087;&#1072;&#1089;&#1085;&#1086;,
&#1090;.&#1082;. &#1074; &#1088;&#1077;&#1078;&#1080;&#1084;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1077;&#1075;&#1086;
&#1085;&#1077;&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;
&#1089;&#1080;&#1085;&#1093;&#1088;&#1086;&#1085;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;.<br>
<br>
<br>
<p><strong>&#1055;&#1072;&#1088;&#1072; &#1089;&#1083;&#1086;&#1074;
&#1086;&#1073; &#1086;&#1090;&#1083;&#1072;&#1076;&#1082;&#1077;</strong>
<p>&#1057;&#1077;&#1081;&#1095;&#1072;&#1089; &#1084;&#1099;
&#1091;&#1078;&#1077; &#1073;&#1086;&#1083;&#1077;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1084;&#1077;&#1090;&#1085;&#1086;
&#1084;&#1086;&#1078;&#1077;&#1084;
&#1087;&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1090;&#1100;
&#1086;&#1073; &#1101;&#1090;&#1086;&#1084;
&#1091;&#1074;&#1083;&#1077;&#1082;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1084;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1077;. &#1050;&#1072;&#1082;
&#1103; &#1091;&#1078;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;
&#1074; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1080;,
&#1091;&#1076;&#1086;&#1073;&#1085;&#1077;&#1077;
&#1074;&#1089;&#1077;&#1075;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1086;&#1090;&#1083;&#1072;&#1076;&#1095;&#1080;&#1082;&#1072; SoftICE.
<p>&#1041;&#1072;&#1079;&#1086;&#1074;&#1086;&#1081;
&#1090;&#1077;&#1093;&#1085;&#1080;&#1082;&#1086;&#1081;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1088;&#1072;&#1089;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1082;&#1072;
&#1074; &#1085;&#1091;&#1078;&#1085;&#1099;&#1093;
&#1084;&#1077;&#1089;&#1090;&#1072;&#1093;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1086;&#1090;&#1083;&#1072;&#1076;&#1086;&#1095;&#1085;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103; int 3.
&#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084;
&#1085;&#1091;&#1078;&#1085;&#1086;
&#1091;&#1073;&#1077;&#1076;&#1080;&#1090;&#1100;&#1089;&#1103;,
&#1095;&#1090;&#1086; &#1074; SoftICE
&#1074;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1086;
&#1086;&#1090;&#1089;&#1083;&#1077;&#1078;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103;. &#1042;
&#1073;&#1086;&#1083;&#1077;&#1077;
&#1087;&#1086;&#1079;&#1076;&#1085;&#1080;&#1093;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1103;&#1093; SoftICE, &#1076;&#1083;&#1103;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
(&gt;80000000h), &#1101;&#1090;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1085;&#1086;
&#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;.
&#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1080;&#1090;&#1100;
&#1101;&#1090;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; i3here.
&#1045;&#1089;&#1083;&#1080; &#1086;&#1090;&#1083;&#1086;&#1074; int 3
&#1085;&#1077; &#1074;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;,
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1101;&#1090;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1090;&#1086;&#1081;
&#1078;&#1077; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; i3here on (&#1074;&#1099;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103;
- i3here off). &#1054;&#1095;&#1077;&#1085;&#1100;
&#1089;&#1086;&#1074;&#1077;&#1090;&#1091;&#1102;
&#1087;&#1088;&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100;
&#1101;&#1090;&#1091; &#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1091;
&#1087;&#1088;&#1103;&#1084;&#1086; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
SoftICE. &#1045;&#1089;&#1083;&#1080; &#1074;&#1099;
&#1079;&#1072;&#1073;&#1091;&#1076;&#1080;&#1090;&#1077; &#1101;&#1090;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1087;&#1088;&#1080;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1077;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;, &#1080;
&#1079;&#1072;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1089;
&#1090;&#1072;&#1082;&#1080;&#1084;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1077;&#1084;,
&#1090;&#1086; BSOD &#1085;&#1077;
&#1079;&#1072;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;
&#1089;&#1077;&#1073;&#1103; &#1078;&#1076;&#1072;&#1090;&#1100;.
&#1045;&#1089;&#1090;&#1100; &#1077;&#1097;&#1077; &#1086;&#1076;&#1085;&#1072;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1072;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1076;&#1103;&#1097;&#1072;&#1103; &#1082;
&#1090;&#1086;&#1084;&#1091; &#1078;&#1077;
&#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1091; - bpint
3. &#1056;&#1072;&#1079;&#1085;&#1080;&#1094;&#1072; &#1074;
&#1090;&#1086;&#1084;, &#1095;&#1090;&#1086; &#1074;
&#1087;&#1077;&#1088;&#1074;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;, &#1074;&#1099;
&#1086;&#1082;&#1072;&#1078;&#1077;&#1090;&#1077;&#1089;&#1100; &#1074; SoftICE
&#1085;&#1072;
&#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1080;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081; &#1079;&#1072;
int 3, &#1072; &#1074;&#1086; &#1074;&#1090;&#1086;&#1088;&#1086;&#1084;,
&#1087;&#1088;&#1103;&#1084;&#1086; &#1085;&#1072; int 3.
&#1052;&#1086;&#1078;&#1085;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1080; &#1090;&#1072;&#1082;:
bpint 3 do &quot;r eip eip+1&quot;, &#1085;&#1086; &#1101;&#1090;&#1086;
&#1084;&#1077;&#1085;&#1077;&#1077; &#1091;&#1076;&#1086;&#1073;&#1085;&#1086;.
<p>&#1042; &#1082;&#1086;&#1076;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; giveio &#1103;
&#1085;&#1077;&#1086;&#1076;&#1085;&#1086;&#1082;&#1088;&#1072;&#1090;&#1085;&#1086;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1083;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; DbgPrint.
&#1069;&#1090;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
&#1074;&#1099;&#1074;&#1086;&#1076;&#1080;&#1090; &#1085;&#1072;
&#1082;&#1086;&#1085;&#1089;&#1086;&#1083;&#1100;
&#1086;&#1090;&#1083;&#1072;&#1076;&#1095;&#1080;&#1082;&#1072;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103;. SoftICE
&#1087;&#1088;&#1077;&#1082;&#1088;&#1072;&#1089;&#1085;&#1086; &#1080;&#1093;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;.
&#1052;&#1086;&#1078;&#1085;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1091;&#1090;&#1080;&#1083;&#1080;&#1090;&#1091; DebugView
&#1052;&#1072;&#1088;&#1082;&#1072;
&#1056;&#1091;&#1089;&#1089;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;&#1072; <a href="http://sysinternals.com/ntw2k/utilities.shtml"><u>http://sysinternals.com/ntw2k/utilities.shtml</u></a><br>
<br>
<br>
<p><strong>&#1063;&#1090;&#1086; &#1074;
&#1072;&#1088;&#1093;&#1080;&#1074;&#1077;</strong>
<p>&#1042; <a href="http://wasm.ru/pub/21/files/kmd3.zip"><u>&#1072;&#1088;&#1093;&#1080;&#1074;&#1077;</u></a>
&#1082; &#1101;&#1090;&#1086;&#1081; &#1089;&#1090;&#1072;&#1090;&#1100;&#1077;,
&#1087;&#1086;&#1084;&#1080;&#1084;&#1086;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1093;
&#1082;&#1086;&#1076;&#1086;&#1074;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1086;&#1074; &#1080;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1086;&#1074;, &#1074;&#1099;
&#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1080;&#1090;&#1077;:
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\tools\protoize</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1090;&#1080;&#1083;&#1080;&#1090;&#1072;
        &#1082;&#1086;&#1085;&#1074;&#1077;&#1088;&#1090;&#1072;&#1094;&#1080;&#1080;
        &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1095;&#1085;&#1099;&#1093;
        .lib &#1092;&#1072;&#1081;&#1083;&#1086;&#1074; &#1074;&#1086;
        &#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1084;&#1099;&#1077; .inc
        &#1092;&#1072;&#1081;&#1083;&#1099;
        &#1089;&#1076;&#1077;&#1083;&#1072;&#1085;&#1085;&#1072;&#1103; f0dder;
        <p>&#1053;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; inc-&#1092;&#1072;&#1081;&#1083;&#1099;
        &#1074; &#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1077; \include\w2k\
        &#1080;&#1079;&#1075;&#1086;&#1090;&#1086;&#1074;&#1083;&#1077;&#1085;&#1099;
        &#1089; &#1077;&#1077; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;.
        &#1055;&#1088;&#1072;&#1074;&#1076;&#1072;, &#1074;&#1089;&#1077;
        __cdecl-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
        &#1084;&#1085;&#1077;
        &#1087;&#1088;&#1080;&#1096;&#1083;&#1086;&#1089;&#1100;
        &#1092;&#1080;&#1082;&#1089;&#1080;&#1090;&#1100;
        &#1088;&#1091;&#1082;&#1072;&#1084;&#1080; :-(<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\tools\KmdManager</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1090;&#1080;&#1083;&#1080;&#1090;&#1072;
        &#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1081;
        &#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;/&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074; (&#1089;
        &#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1080;&#1082;&#1072;&#1084;&#1080;,
        &#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;).
        &#1055;&#1086;&#1088;&#1099;&#1074;&#1096;&#1080;&#1089;&#1100;
        &#1093;&#1086;&#1088;&#1086;&#1096;&#1077;&#1085;&#1100;&#1082;&#1086;
        &#1074; &#1089;&#1077;&#1090;&#1080;, &#1074;&#1099;
        &#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1080;&#1090;&#1077;
        &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
        &#1087;&#1086;&#1076;&#1086;&#1073;&#1085;&#1099;&#1093;
        &#1080;&#1085;&#1089;&#1090;&#1088;&#1091;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;,
        &#1082;&#1072;&#1082; &#1089;
        &#1082;&#1086;&#1085;&#1089;&#1086;&#1083;&#1100;&#1085;&#1099;&#1084;,
        &#1090;&#1072;&#1082; &#1080; &#1089;
        &#1075;&#1088;&#1072;&#1092;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1084;
        &#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;&#1086;&#1084;,
        &#1085;&#1086; &#1074;&#1089;&#1077; &#1086;&#1085;&#1080;
        &#1095;&#1077;&#1084;-&#1083;&#1080;&#1073;&#1086; &#1076;&#1072;
        &#1085;&#1077;
        &#1091;&#1089;&#1090;&#1088;&#1072;&#1080;&#1074;&#1072;&#1083;&#1080;
        &#1084;&#1077;&#1085;&#1103;.
        &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1103;
        &#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083;
        &#1089;&#1074;&#1086;&#1102;
        &#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1091;&#1102;.
        &#1055;&#1086;&#1082;&#1072; &#1086;&#1085;&#1072; &#1085;&#1077;
        &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
        &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
        &#1085;&#1086;, &#1076;&#1091;&#1084;&#1072;&#1102;, &#1074;
        &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
        &#1074;&#1077;&#1088;&#1089;&#1080;&#1080; &#1103;
        &#1101;&#1090;&#1086;&#1090;
        &#1085;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1082;
        &#1080;&#1089;&#1087;&#1088;&#1072;&#1074;&#1083;&#1102;.
        &#1045;&#1089;&#1083;&#1080;
        &#1079;&#1072;&#1093;&#1086;&#1090;&#1080;&#1090;&#1077; &#1077;&#1077;
        &#1087;&#1077;&#1088;&#1077;&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;,
        &#1090;&#1086;
        &#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1084;&#1086;&#1081; &#1087;&#1072;&#1082;&#1077;&#1090; <a href="http://wasm.ru/tools/4/cocomac.zip"><u>cocomac
        v1.2</u></a>;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\include\w2k</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1077;
        &#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1084;&#1099;&#1077;
        &#1092;&#1072;&#1081;&#1083;&#1099;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\lib\w2k</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1077;
        &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1095;&#1085;&#1099;&#1077;
        &#1092;&#1072;&#1081;&#1083;&#1099;.<br>
        <br>
        <p>&#1042; &#1089;&#1074;&#1103;&#1079;&#1080; &#1089;
        &#1090;&#1077;&#1084;, &#1095;&#1090;&#1086; Microsoft
        &#1087;&#1088;&#1077;&#1082;&#1088;&#1072;&#1090;&#1080;&#1083;&#1072;
        &#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1086;&#1077;
        &#1088;&#1072;&#1089;&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1077;
        DDK, &#1091; &#1074;&#1072;&#1089; &#1084;&#1086;&#1075;&#1091;&#1090;
        &#1074;&#1086;&#1079;&#1085;&#1080;&#1082;&#1085;&#1091;&#1090;&#1100;
        &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
        &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1099;
        &#1087;&#1088;&#1080;
        &#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1094;&#1080;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;.
        &#1055;&#1088;&#1077;&#1078;&#1076;&#1077;
        &#1074;&#1089;&#1077;&#1075;&#1086; - &#1101;&#1090;&#1086;
        &#1086;&#1090;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1080;&#1077; .lib
        &#1092;&#1072;&#1081;&#1083;&#1086;&#1074;. &#1042;
        &#1101;&#1090;&#1086;&#1084;
        &#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1077;
        &#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1090;&#1089;&#1103;
        &#1092;&#1072;&#1081;&#1083;&#1099; &#1086;&#1090;
        &#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
        &#1074;&#1099;&#1087;&#1091;&#1089;&#1082;&#1072; Windows 2000,
        &#1085;&#1086; &#1087;&#1086;&#1076;&#1086;&#1081;&#1076;&#1091;&#1090;
        &#1073;&#1077;&#1079; &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;
        &#1080; &#1076;&#1083;&#1103; Windows XP, &#1080;,
        &#1076;&#1091;&#1084;&#1072;&#1102;, &#1076;&#1083;&#1103; Windows NT4.0
        &#1090;&#1086;&#1078;&#1077;.
        &#1053;&#1072;&#1076;&#1077;&#1102;&#1089;&#1100;, Microsoft
        &#1085;&#1072; &#1084;&#1077;&#1085;&#1103; &#1079;&#1072;
        &#1101;&#1090;&#1086; &#1085;&#1077; &#1086;&#1095;&#1077;&#1085;&#1100;
        &#1086;&#1073;&#1080;&#1076;&#1080;&#1090;&#1089;&#1103; ;-)</p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica"><br>
<br>
<p><strong>&#1063;&#1090;&#1086;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100;</strong>
<p>&#1044;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1102;
DDK, &#1087;&#1086;&#1084;&#1080;&#1084;&#1086;
&#1089;&#1072;&#1081;&#1090;&#1072; <a href="http://www.microsoft.com/"><u>http://www.microsoft.com/</u></a>,
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1090;&#1091;&#1090;: <a href="http://www.osr.com/"><u>&quot;Windows XP SP1 DDK
Documentation On-line&quot;</u></a>.
<p>&#1042;&#1089;&#1077; Zw* &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1080; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1099;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086; &#1074;
&#1082;&#1085;&#1080;&#1075;&#1077; &#1043;&#1101;&#1088;&#1080;
&#1053;&#1077;&#1073;&#1073;&#1077;&#1090;&#1072; &quot;&#1057;&#1087;&#1088;&#1072;&#1074;&#1086;&#1095;&#1085;&#1080;&#1082;
&#1087;&#1086; &#1073;&#1072;&#1079;&#1086;&#1074;&#1099;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;&#1084; API Windows NT/2000&quot;,
&#1048;&#1079;&#1076;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1076;&#1086;&#1084; &quot;&#1042;&#1080;&#1083;&#1100;&#1103;&#1084;&#1089;&quot;,
2002. &#1042; &#1089;&#1077;&#1090;&#1080; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1085;&#1072;&#1081;&#1090;&#1080;
&#1101;&#1083;&#1077;&#1082;&#1090;&#1088;&#1086;&#1085;&#1085;&#1091;&#1102;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1102; &#1101;&#1090;&#1086;&#1081;
&#1082;&#1085;&#1080;&#1075;&#1080;: Gary Nebbett, &quot;Windows NT-2000 Native
API Reference&quot;.
<p>&#1042;&#1086;&#1073;&#1097;&#1077;&#1084;, &#1085;&#1072;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1093; &#1087;&#1086;&#1088;&#1072;&#1093;,
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1086;&#1081;&#1090;&#1080;&#1089;&#1100; &#1080;
&#1073;&#1077;&#1079; DDK. &#1045;&#1089;&#1083;&#1080;
&#1095;&#1091;&#1074;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;&#1077;,
&#1095;&#1090;&#1086; &#1095;&#1077;&#1075;&#1086;-&#1090;&#1086; &#1085;&#1077;
&#1093;&#1074;&#1072;&#1090;&#1072;&#1077;&#1090; -
&#1080;&#1097;&#1080;&#1090;&#1077; &#1074; &#1089;&#1077;&#1090;&#1080;.
&#1055;&#1088;&#1080; &#1078;&#1077;&#1083;&#1072;&#1085;&#1080;&#1080;
&#1085;&#1072;&#1081;&#1090;&#1080; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1084;&#1085;&#1086;&#1075;&#1086;&#1077;.<br>
<br>
<br>
<p>&#1042;&#1089;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1099; &#1103;
&#1090;&#1077;&#1089;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1083;
&#1087;&#1086;&#1076; Windows 2000 Pro &#1080; Windows XP Pro. &#1053;&#1086;
&#1074;&#1089;&#1077; &#1076;&#1086;&#1083;&#1078;&#1085;&#1086;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1080; &#1085;&#1072;
&#1073;&#1086;&#1083;&#1077;&#1077; &#1088;&#1072;&#1085;&#1085;&#1080;&#1093;
&#1074;&#1099;&#1087;&#1091;&#1089;&#1082;&#1072;&#1093; Windows NT.
&#1044;&#1086; &#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1080; &#1074;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;, &#1075;&#1076;&#1077; &#1084;&#1099;
&#1087;&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1084; &#1086;
&#1087;&#1086;&#1076;&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1086;&#1086;&#1073;&#1097;&#1077;, &#1080; &#1086;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1077;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074; &#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1089;&#1090;&#1080;.
<p>&nbsp; [C] Four-F</p>
<!--mstheme--></font>

</body>

</html>
