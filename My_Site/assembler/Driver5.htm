<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>New Page 1</title>
<meta name="Microsoft Theme" content="zero 011">
</head>

<body background="zertxtr.gif" bgcolor="#000000" text="#FFFFFF" link="#6699CC" vlink="#669966" alink="#999999">

<!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font>
<h3 align="center"><!--mstheme--><font face="Arial, Arial, Helvetica" color="#CCCCCC"><font size="5" color="#00FF00">&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1099;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;:
&#1063;&#1072;&#1089;&#1090;&#1100; 5:
&#1055;&#1086;&#1083;&#1085;&#1086;&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;</font><!--mstheme--></font></h3>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1055;&#1088;&#1080;&#1096;&#1083;&#1086;,
&#1085;&#1072;&#1082;&#1086;&#1085;&#1077;&#1094;,
&#1074;&#1088;&#1077;&#1084;&#1103;
&#1074;&#1079;&#1075;&#1083;&#1103;&#1085;&#1091;&#1090;&#1100; &#1085;&#1072;
&#1090;&#1086;, &#1082; &#1095;&#1077;&#1084;&#1091; &#1084;&#1099;
&#1090;&#1072;&#1082; &#1076;&#1086;&#1083;&#1075;&#1086;
&#1089;&#1090;&#1088;&#1077;&#1084;&#1080;&#1083;&#1080;&#1089;&#1100;.
&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1074;&#1089;&#1103; &#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1072;&#1103;
&#1090;&#1077;&#1086;&#1088;&#1080;&#1103; &#1091;&#1078;&#1077;
&#1087;&#1086;&#1079;&#1072;&#1076;&#1080;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1089;&#1088;&#1072;&#1079;&#1091;
&#1087;&#1088;&#1080;&#1089;&#1090;&#1091;&#1087;&#1072;&#1077;&#1084; &#1082;
&#1088;&#1072;&#1079;&#1073;&#1086;&#1088;&#1091;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;,
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084; &#1084;&#1099;
&#1087;&#1080;&#1089;&#1072;&#1083;&#1080; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;.
<p><code><!--mstheme--></font>
<pre><font size="2"> ;@echo off
 ;goto make

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;
 ; VirtToPhys - &#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
 ;
 ;  &#1055;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076;&#1080;&#1090; &#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081; &#1072;&#1076;&#1088;&#1077;&#1089; &#1074; &#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081;
 ;
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .386
 .model flat, stdcall
 option casemap:none

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                              &#1042; &#1050; &#1051; &#1070; &#1063; &#1040; &#1045; &#1052; &#1067; &#1045;    &#1060; &#1040; &#1049; &#1051; &#1067;                                     
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 include \masm32\include\w2k\ntstatus.inc
 include \masm32\include\w2k\ntddk.inc
 include \masm32\include\w2k\ntoskrnl.inc
 include \masm32\include\w2k\w2kundoc.inc

 includelib \masm32\lib\w2k\ntoskrnl.lib

 include \masm32\Macros\Strings.mac

 include <b>..</b>\common.inc

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                             &#1053; &#1045; &#1048; &#1047; &#1052; &#1045; &#1053; &#1071; &#1045; &#1052; &#1067; &#1045;    &#1044; &#1040; &#1053; &#1053; &#1067; &#1045;                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .const
 CCOUNTED_UNICODE_STRING    &quot;\\Device\\devVirtToPhys&quot;, g_usDeviceName, 4
 CCOUNTED_UNICODE_STRING    &quot;\\??\\slVirtToPhys&quot;, g_usSymbolicLinkName, 4

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                              &#1050; &#1054; &#1044;                                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                    GetPhysicalAddress                                             
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 GetPhysicalAddress proc dwAddress:DWORD

     mov eax, dwAddress
     mov ecx, eax

     shr eax, 22
     shl eax, 2

     mov eax, [0C0300000h][eax]

     .if ( eax &amp; (mask pde4kValid) )
         .if !( eax &amp; (mask pde4kLargePage) )
             mov eax, ecx
             shr eax, 10
             and eax, 1111111111111111111100y
             add eax, 0C0000000h
             mov eax, [eax]

             .if eax &amp; (mask pteValid)
                 and eax, mask ptePageFrameNumber

                 and ecx, 00000000000000000000111111111111y
                 add eax, ecx
             .else
                 xor eax, eax
             .endif
         .else
             and eax, mask pde4mPageFrameNumber
             and ecx, 00000000001111111111111111111111y
             add eax, ecx
         .endif
     .else
         xor eax, eax
     .endif

     ret

 GetPhysicalAddress endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                   DispatchCreateClose                                             
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DispatchCreateClose proc pDeviceObject:PDEVICE_OBJECT, pIrp:PIRP

     mov eax, pIrp
     assume eax:ptr _IRP
     mov [eax].IoStatus.Status, STATUS_SUCCESS
     and [eax].IoStatus.Information, 0
     assume eax:nothing

     fastcall IofCompleteRequest, pIrp, IO_NO_INCREMENT

     mov eax, STATUS_SUCCESS
     ret

 DispatchCreateClose endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                     DispatchControl                                               
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DispatchControl proc uses esi edi ebx pDeviceObject:PDEVICE_OBJECT, pIrp:PIRP

 local status:NTSTATUS
 local dwBytesReturned:DWORD

     and dwBytesReturned, 0

     mov esi, pIrp
     assume esi:ptr _IRP

     IoGetCurrentIrpStackLocation esi
     mov edi, eax
     assume edi:ptr IO_STACK_LOCATION

     .if [edi].Parameters.DeviceIoControl.IoControlCode == IOCTL_GET_PHYS_ADDRESS
         .if ( [edi].Parameters.DeviceIoControl.OutputBufferLength &gt;= DATA_SIZE ) &amp;&amp; ( [edi].Parameters.DeviceIoControl.InputBufferLength &gt;= DATA_SIZE )

             mov edi, [esi].AssociatedIrp.SystemBuffer
             assume edi:ptr DWORD

             xor ebx, ebx
             .while ebx &lt; NUM_DATA_ENTRY

                 invoke GetPhysicalAddress, [edi][ebx*(sizeof DWORD)]

                 mov [edi][ebx*(sizeof DWORD)], eax
                 inc ebx
             .endw

             mov dwBytesReturned, DATA_SIZE
             mov status, STATUS_SUCCESS
         .else
             mov status, STATUS_BUFFER_TOO_SMALL
         .endif
     .else
         mov status, STATUS_INVALID_DEVICE_REQUEST
     .endif

     assume edi:nothing

     m2m [esi].IoStatus.Status, status
     m2m [esi].IoStatus.Information, dwBytesReturned

     assume esi:nothing

     fastcall IofCompleteRequest, pIrp, IO_NO_INCREMENT

     mov eax, status
     ret

 DispatchControl endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                       DriverUnload                                                
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DriverUnload proc pDriverObject:PDRIVER_OBJECT

         invoke IoDeleteSymbolicLink, addr g_usSymbolicLinkName

         mov eax, pDriverObject
         invoke IoDeleteDevice, (DRIVER_OBJECT PTR [eax]).DeviceObject

     ret

 DriverUnload endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;               &#1042; &#1067; &#1043; &#1056; &#1059; &#1046; &#1040; &#1045; &#1052; &#1067; &#1049;   &#1055; &#1056; &#1048;   &#1053; &#1045; &#1054; &#1041; &#1061; &#1054; &#1044; &#1048; &#1052; &#1054; &#1057; &#1058; &#1048;   &#1050; &#1054; &#1044;                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 .code INIT

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                       DriverEntry                                                 
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 DriverEntry proc pDriverObject:PDRIVER_OBJECT, pusRegistryPath:PUNICODE_STRING

 local status:NTSTATUS
 local pDeviceObject:PVOID

     mov status, STATUS_DEVICE_CONFIGURATION_ERROR

     invoke IoCreateDevice, pDriverObject, 0, addr g_usDeviceName, FILE_DEVICE_UNKNOWN, \
                                              0, FALSE, addr pDeviceObject

     .if eax == STATUS_SUCCESS
         invoke IoCreateSymbolicLink, addr g_usSymbolicLinkName, addr g_usDeviceName
         .if eax == STATUS_SUCCESS
             mov eax, pDriverObject
             assume eax:PTR DRIVER_OBJECT
             mov [eax].MajorFunction[IRP_MJ_CREATE*(sizeof PVOID)],           offset DispatchCreateClose
             mov [eax].MajorFunction[IRP_MJ_CLOSE*(sizeof PVOID)],            offset DispatchCreateClose
             mov [eax].MajorFunction[IRP_MJ_DEVICE_CONTROL*(sizeof PVOID)],   offset DispatchControl
             mov [eax].DriverUnload,                                          offset DriverUnload
             assume eax:nothing
             mov status, STATUS_SUCCESS
         .else
             invoke IoDeleteDevice, pDeviceObject
         .endif
     .endif

     mov eax, status
     ret

 DriverEntry endp

 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 ;                                                                                                   
 ;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

 end DriverEntry

 :make

 set drv=VirtToPhys

 \masm32\bin\ml /nologo /c /coff %drv%.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:%drv%.sys /subsystem:native /ignore:4078 %drv%.obj rsrc.obj

 del %drv%.obj
 move %drv%.sys ..

 echo.
 pause

</font></pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code><br>
<br>
<br>
<p><strong>&#1048;&#1084;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072; &#1080;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080;</strong>
<p>&#1053;&#1072;&#1095;&#1085;&#1077;&#1084; &#1089;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088; UNICODE_STRING,
&#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1102;&#1097;&#1080;&#1093;
&#1080;&#1084;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072; &#1080;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080;. &#1050;&#1072;&#1082; &#1103;
&#1091;&#1078;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083; &#1074;
&#1090;&#1088;&#1077;&#1090;&#1100;&#1077;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1080;, &#1103;&#1076;&#1088;&#1086;
&#1083;&#1102;&#1073;&#1080;&#1090;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1089;&#1086;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086; &#1074; &#1101;&#1090;&#1086;&#1084;
&#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077;.
<p>&#1040;&#1073;&#1089;&#1086;&#1083;&#1102;&#1090;&#1085;&#1086;
&#1074;&#1086; &#1074;&#1089;&#1077;&#1093;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1093;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;,
&#1082;&#1072;&#1082; &#1085;&#1072;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;,
&#1090;&#1072;&#1082; &#1080; &#1085;&#1072; &#1089;&#1080;, &#1103;
&#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1102;
&#1086;&#1076;&#1085;&#1091; &#1080; &#1090;&#1091; &#1078;&#1077;
&#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1073;&#1077;&#1089;&#1089;&#1084;&#1099;&#1089;&#1083;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100;.
<p><code><!--mstheme--></font>
<pre> .const
 uszDeviceName          dw &quot;\&quot;, &quot;D&quot;, &quot;e&quot;, &quot;v&quot;, &quot;i&quot;, &quot;c&quot;, &quot;e&quot;, &quot;\&quot;, &quot;D&quot;, &quot;e&quot;, &quot;v&quot;, &quot;N&quot;, &quot;a&quot;, &quot;m&quot;, &quot;e&quot;, 0
 uszSymbolicLinkName    dw &quot;\&quot;, &quot;?&quot;, &quot;?&quot;, &quot;\&quot;, &quot;D&quot;, &quot;e&quot;, &quot;v&quot;, &quot;N&quot;, &quot;a&quot;, &quot;m&quot;, &quot;e&quot;, 0

 .code
 DriverEntry proc <b>. . .</b>
 <b>. . .</b>
 local usDeviceName:UNICODE_STRING
 local usSymbolicLinkName:UNICODE_STRING
 <b>. . .</b>
     invoke RtlInitUnicodeString, addr usDeviceName, offset uszDeviceName
     invoke RtlInitUnicodeString, addr usSymbolicLinkName, offset uszSymbolicLinkName

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1076;&#1072;&#1095;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; RtlInitUnicodeString
&#1080;&#1079;&#1084;&#1077;&#1088;&#1080;&#1090;&#1100; unicode-&#1089;&#1090;&#1088;&#1086;&#1082;&#1091;
&#1080; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; UNICODE_STRING (&#1089;&#1084;.
&#1063;&#1072;&#1089;&#1090;&#1100; 3). &#1058;.&#1082;.
&#1089;&#1072;&#1084;&#1080; unicode-&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;
&#1074; &#1101;&#1090;&#1086;&#1084; &#1082;&#1086;&#1076;&#1077;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099;
&#1089;&#1090;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;, &#1090;.&#1077;.
&#1085;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072; &#1085;&#1077;
&#1084;&#1077;&#1085;&#1103;&#1102;&#1090;&#1089;&#1103;, &#1090;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086;, &#1077;&#1097;&#1077; &#1085;&#1072;
&#1101;&#1090;&#1072;&#1087;&#1077;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1094;&#1080;&#1080;,
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; UNICODE_STRING.
&#1069;&#1090;&#1086; &#1087;&#1088;&#1086;&#1097;&#1077;,
&#1085;&#1072;&#1075;&#1083;&#1103;&#1076;&#1085;&#1077;&#1077; &#1080;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;
&#1084;&#1077;&#1085;&#1100;&#1096;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072;
&#1073;&#1072;&#1081;&#1090; (8 &#1073;&#1072;&#1081;&#1090; &#1085;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; UNICODE_STRING +
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1091;&#1084; 3
&#1073;&#1072;&#1081;&#1090;&#1072; &#1085;&#1072;
&#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;.
&#1055;&#1088;&#1086;&#1090;&#1080;&#1074;
&#1084;&#1080;&#1085;&#1080;&#1084;&#1091;&#1084; 14
&#1073;&#1072;&#1081;&#1090; &#1085;&#1072; &#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; RtlInitUnicodeString +
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1080;&#1079;&#1076;&#1077;&#1088;&#1078;&#1082;&#1080;).
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086; &#1090;&#1072;&#1082; &#1080;
&#1087;&#1086;&#1089;&#1090;&#1091;&#1087;&#1080;&#1084;, &#1072;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; CCOUNTED_UNICODE_STRING
&#1077;&#1097;&#1077; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077;
&#1086;&#1073;&#1083;&#1077;&#1075;&#1095;&#1080;&#1090; &#1085;&#1072;&#1084;
&#1078;&#1080;&#1079;&#1085;&#1100;, &#1080; &#1074;&#1077;&#1089;&#1100;
&#1074;&#1099;&#1096;&#1077;&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1082;&#1086;&#1076; (&#1084;&#1099;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1084; &#1077;&#1097;&#1077;
&#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;)
&#1087;&#1088;&#1077;&#1074;&#1088;&#1072;&#1090;&#1080;&#1090;&#1089;&#1103;
&#1074; &#1076;&#1074;&#1077;
&#1101;&#1083;&#1077;&#1075;&#1072;&#1085;&#1090;&#1085;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;.
<p><code><!--mstheme--></font>
<pre> CCOUNTED_UNICODE_STRING &quot;\\Device\\DevName&quot;, usDeviceName,       4
 CCOUNTED_UNICODE_STRING &quot;\\??\\DevName&quot;,     usSymbolicLinkName, 4

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1053;&#1077; &#1079;&#1085;&#1072;&#1102; &#1082;&#1072;&#1082;
&#1074;&#1072;&#1084;, &#1072; &#1084;&#1085;&#1077;
&#1101;&#1090;&#1086;&#1090; &#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;
&#1087;&#1088;&#1072;&#1074;&#1080;&#1090;&#1089;&#1103;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077;.
&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; &#1078;&#1077;
RtlInitUnicodeString
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1075;&#1076;&#1072; &#1076;&#1083;&#1080;&#1085;&#1072;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;
&#1079;&#1072;&#1088;&#1072;&#1085;&#1077;&#1077;
&#1085;&#1077;&#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1085;&#1072;. &#1042;
ntoskrnl.exe, &#1082;&#1089;&#1090;&#1072;&#1090;&#1080;,
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1094;&#1077;&#1083;&#1099;&#1081; &#1085;&#1072;&#1073;&#1086;&#1088;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;, &#1082;&#1072;&#1082;
&#1076;&#1083;&#1103;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088; *_STRING,
&#1090;&#1072;&#1082; &#1080; &#1076;&#1083;&#1103;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099; &#1089;&#1086;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080;
&#1074;&#1086;&#1086;&#1073;&#1097;&#1077;.
<p><code><!--mstheme--></font>
<pre> .const
 CCOUNTED_UNICODE_STRING    &quot;\\Device\\devVirtToPhys&quot;, g_usDeviceName, 4
 CCOUNTED_UNICODE_STRING    &quot;\\??\\slVirtToPhys&quot;, g_usSymbolicLinkName, 4

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1084;&#1099;
&#1080;&#1084;&#1077;&#1077;&#1084; &#1076;&#1074;&#1077;
&#1075;&#1083;&#1086;&#1073;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077; <i>g_usDeviceName</i>
&#1080; <i>g_usSymbolicLinkName</i> &#1090;&#1080;&#1087;&#1072; UNICODE_STRING
&#1089; &#1080;&#1084;&#1077;&#1085;&#1077;&#1084;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072; &#1080;
&#1080;&#1084;&#1077;&#1085;&#1077;&#1084;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;.
&#1050;&#1072;&#1082; &#1103; &#1091;&#1078;&#1077;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;,
&#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1099; &quot;dev&quot; &#1080;
&quot;sl&quot; &#1103; &#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1083;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1076;&#1083;&#1103;
&#1085;&#1072;&#1075;&#1083;&#1103;&#1076;&#1085;&#1086;&#1089;&#1090;&#1080;.
<p>&#1053;&#1072; &#1073;&#1086;&#1083;&#1077;&#1077;
&#1088;&#1072;&#1085;&#1085;&#1080;&#1093;
&#1074;&#1099;&#1087;&#1091;&#1089;&#1082;&#1072;&#1093; Windows NT &#1074;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1077;
&#1080;&#1084;&#1077;&#1085;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;
&#1086;&#1090;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075; &quot;\??&quot;. &#1042;
&#1101;&#1090;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1085;&#1072;&#1076;&#1086;
&#1079;&#1072;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100; &#1074;
&#1080;&#1084;&#1077;&#1085;&#1080;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080; &quot;\??&quot; &#1085;&#1072;
&quot;\DosDevices&quot;. &#1055;&#1088;&#1080;&#1095;&#1077;&#1084;, &#1074;
&#1073;&#1086;&#1083;&#1077;&#1077;
&#1087;&#1086;&#1079;&#1076;&#1085;&#1080;&#1093;
&#1074;&#1099;&#1087;&#1091;&#1089;&#1082;&#1072;&#1093; &#1101;&#1090;&#1086;
&#1090;&#1086;&#1078;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100;, &#1090;.&#1082;.
&#1076;&#1083;&#1103;
&#1089;&#1086;&#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;
&#1074; &#1082;&#1086;&#1088;&#1085;&#1077;&#1074;&#1086;&#1084;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1072;
&#1080;&#1084;&#1077;&#1085;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;
&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1072;&#1103;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1072; &quot;\DosDevices&quot;,
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1072; &quot;\??&quot;<br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;</strong>
<p>&#1050;&#1086;&#1077;-&#1095;&#1090;&#1086; &#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077; DriverEntry
&#1084;&#1099; &#1091;&#1078;&#1077; &#1091;&#1079;&#1085;&#1072;&#1083;&#1080;
&#1074; &#1090;&#1088;&#1077;&#1090;&#1100;&#1077;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1080; &#1089;&#1090;&#1072;&#1090;&#1100;&#1080;.
&#1055;&#1088;&#1077;&#1078;&#1076;&#1077; &#1095;&#1077;&#1084; &#1084;&#1099;
&#1087;&#1086;&#1081;&#1076;&#1077;&#1084;
&#1076;&#1072;&#1083;&#1100;&#1096;&#1077;,
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072;
&#1089;&#1090;&#1088;&#1086;&#1082;&#1091;:
<p><code><!--mstheme--></font>
<pre> .code INIT

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1077;&#1089;&#1100; &#1082;&#1086;&#1076;,
&#1087;&#1086;&#1084;&#1077;&#1095;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1090;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;,
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;&#1086;&#1084;
&#1074; &#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1091;&#1102;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1102; PE-&#1092;&#1072;&#1081;&#1083;&#1072;
&#1089; &#1072;&#1090;&#1088;&#1080;&#1073;&#1091;&#1090;&#1086;&#1084; <i>Discardable</i>.
&#1041;&#1083;&#1072;&#1075;&#1086;&#1076;&#1072;&#1088;&#1103;
&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1080;&#1090;
&#1090;&#1072;&#1082;&#1086;&#1081; &#1082;&#1086;&#1076; &#1087;&#1088;&#1080;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;.
&#1069;&#1090;&#1086;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1077;&#1090;
&#1101;&#1082;&#1086;&#1085;&#1086;&#1084;&#1085;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1099;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1081;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1042;&#1077;&#1089;&#1100;
&#1082;&#1086;&#1076; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077; DriverEntry
&#1085;&#1091;&#1078;&#1077;&#1085; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1086;&#1076;&#1080;&#1085; &#1088;&#1072;&#1079; - &#1074;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1103;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
&#1055;&#1086;&#1089;&#1083;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1086;&#1085; &#1073;&#1091;&#1076;&#1077;&#1090;
&#1073;&#1077;&#1089;&#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1086;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1090;&#1100;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;. &#1053;&#1086;,
&#1090;&#1072;&#1082; &#1082;&#1072;&#1082; &#1086;&#1085;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1077;&#1085; &#1074;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1102; &quot;INIT&quot;,
&#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1077;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090;.
&#1053;&#1086; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1074;
&#1090;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1077;&#1089;&#1083;&#1080; &#1082;&#1088;&#1086;&#1084;&#1077;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1080; INIT &#1085;&#1072;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; (&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1093;)
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;&#1090;, &#1090;.&#1082;.
&#1095;&#1072;&#1089;&#1090;&#1080;&#1095;&#1085;&#1086;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1078;&#1072;&#1090;&#1100;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1085;&#1077;
&#1091;&#1084;&#1077;&#1077;&#1090;.
<p>&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;,
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072; DriverEntry
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086;
&#1082;&#1088;&#1086;&#1096;&#1077;&#1095;&#1085;&#1072;&#1103;, &#1080;
&#1074;&#1077;&#1089;&#1100;
&#1086;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1082;&#1086;&#1076; &#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1090;&#1086;&#1078;&#1077;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1102;&#1090;
&#1086;&#1095;&#1077;&#1085;&#1100; &#1084;&#1072;&#1083;&#1086;
&#1084;&#1077;&#1089;&#1090;&#1072;, &#1072; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;&#1072;
/align:32 &#1084;&#1099;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1083;&#1080;
&#1074;&#1099;&#1088;&#1072;&#1074;&#1085;&#1080;&#1074;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1081; &#1087;&#1086;
&#1075;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; 32
&#1073;&#1072;&#1081;&#1090;&#1072;, &#1090;&#1086; &#1074;&#1077;&#1089;&#1100;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;, &#1089;&#1086;
&#1074;&#1089;&#1077;&#1084;&#1080; &#1089;&#1074;&#1086;&#1080;&#1084;&#1080;
&#1087;&#1086;&#1090;&#1088;&#1086;&#1093;&#1072;&#1084;&#1080;,
&#1091;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074;&#1089;&#1077;&#1075;&#1086; &#1085;&#1072;
&#1086;&#1076;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; (4&#1082;&#1041;). &#1040;
&#1082;&#1072;&#1082; &#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1085;&#1086;,
&#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1077;&#1076;&#1080;&#1085;&#1080;&#1094;&#1077;&#1081;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1085;&#1072;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;,
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1072;. &#1058;.&#1077;.
&#1084;&#1086;&#1078;&#1085;&#1086; &#1073;&#1099;&#1083;&#1086; &#1080;
&#1085;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1091;&#1102;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1102;, &#1090;.&#1082;. &#1074;
&#1076;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1101;&#1090;&#1086;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1076;&#1072;&#1077;&#1090;. &#1042;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;&#1093;
&#1076;&#1083;&#1103; &#1073;&#1086;&#1083;&#1077;&#1077;
&#1088;&#1072;&#1085;&#1085;&#1080;&#1093;
&#1074;&#1099;&#1087;&#1091;&#1089;&#1082;&#1086;&#1074; Windows NT
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072; DriverEntry
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1083;&#1072;
&#1076;&#1086;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;
&#1087;&#1088;&#1080;&#1083;&#1080;&#1095;&#1085;&#1086;&#1077;
&#1084;&#1077;&#1089;&#1090;&#1086;,
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;
&#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086; Microsoft
&#1090;&#1072;&#1082; &#1080;
&#1087;&#1086;&#1089;&#1090;&#1091;&#1087;&#1080;&#1083;&#1072;.
<p><code><!--mstheme--></font>
<pre>     mov status, STATUS_DEVICE_CONFIGURATION_ERROR

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1088;&#1077;&#1078;&#1087;&#1086;&#1083;&#1086;&#1078;&#1080;&#1084;,
&#1095;&#1090;&#1086; &#1074;&#1086; &#1074;&#1088;&#1077;&#1084;&#1103;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;. &#1045;&#1089;&#1083;&#1080;
&#1101;&#1090;&#1086; &#1089;&#1083;&#1091;&#1095;&#1080;&#1090;&#1089;&#1103;,
&#1090;&#1086; &#1101;&#1090;&#1086;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1080;
&#1074;&#1077;&#1088;&#1085;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;, &#1080; &#1085;&#1072;
&#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; StartService
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1090;&#1089;&#1103;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1086;&#1081;.
<p><code><!--mstheme--></font>
<pre>     invoke IoCreateDevice, pDriverObject, 0, addr g_usDeviceName, FILE_DEVICE_UNKNOWN, \
                                              0, FALSE, addr pDeviceObject

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;,
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1087;&#1088;&#1080;&#1079;&#1074;&#1072;&#1085;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&#1084;,
&#1090;&#1086; &#1087;&#1077;&#1088;&#1074;&#1099;&#1084;
&#1076;&#1077;&#1083;&#1086;&#1084; &#1084;&#1099; &#1080;
&#1087;&#1099;&#1090;&#1072;&#1077;&#1084;&#1089;&#1103; &#1101;&#1090;&#1086;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;.
&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; IoCreateDevice
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100; &#1087;&#1086;&#1076;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;, &#1074;
&#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1089;&#1090;&#1080; DEVICE_OBJECT,
&#1080;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1080;&#1093;. &#1045;&#1077;
&#1087;&#1088;&#1086;&#1090;&#1086;&#1090;&#1080;&#1087;
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1080;&#1090;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;:
<p><code><!--mstheme--></font>
<pre> IoCreateDevice proto std call DriverObject:PDRIVER_OBJECT, DeviceExtensionSize:DWORD, \
                               DeviceName:PUNICODE_STRING,  DeviceType:DEVICE_TYPE, \
                               DeviceCharacteristics:DWORD, Exclusive:BOOL, \
                               DeviceObject: PDEVICE_OBJECT

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DriverObject</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;
        (&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072;
        DRIVER_OBJECT),
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1086;&#1081;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DeviceExtensionSize</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
        &#1086;&#1073;&#1083;&#1072;&#1089;&#1090;&#1080;
        &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1081;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072; (device
        extension), &#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102;
        &#1084;&#1086;&#1078;&#1085;&#1086;
        &#1074;&#1099;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1074;
        &#1082;&#1072;&#1078;&#1076;&#1086;&#1084;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1077; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;.<br>
        <br>
        &#1069;&#1090;&#1086;&#1090;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
        &#1080;&#1084;&#1077;&#1077;&#1090; &#1089;&#1084;&#1099;&#1089;&#1083;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1077;&#1089;&#1083;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
        &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1084;&#1080;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;&#1084;&#1080;.
        &#1058;.&#1086;. &#1086;&#1085; &#1084;&#1086;&#1078;&#1077;&#1090;
        &#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
        &#1086;&#1090;&#1085;&#1086;&#1089;&#1103;&#1097;&#1091;&#1102;&#1089;&#1103;
        &#1082; &#1082;&#1072;&#1078;&#1076;&#1086;&#1084;&#1091;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;
        &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102;
        &#1074; &#1089;&#1072;&#1084;&#1086;&#1084;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1077; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;.
        &#1042; &#1085;&#1072;&#1096;&#1077;&#1084;
        &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;
        &#1086;&#1076;&#1085;&#1086;,
        &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1085;&#1077;&#1090;
        &#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1075;&#1086;
        &#1089;&#1084;&#1099;&#1089;&#1083;&#1072;
        &#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1090;&#1100; &#1074;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1077;
        &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1091;&#1102;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1100;, &#1093;&#1086;&#1090;&#1103;
        &#1085;&#1080;&#1095;&#1090;&#1086; &#1085;&#1077;
        &#1084;&#1077;&#1096;&#1072;&#1077;&#1090; &#1085;&#1072;&#1084;
        &#1101;&#1090;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DeviceName</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1085;&#1077;&#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1080;&#1084;&#1103;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;
        &#1074; &#1092;&#1086;&#1088;&#1084;&#1072;&#1090;&#1077; UNICODE_STRING.<br>
        <br>
        &#1044;&#1083;&#1103; &#1085;&#1072;&#1089; &#1101;&#1090;&#1086;&#1090;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
        &#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1077;&#1085;.
        &#1052;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;
        &#1080;&#1084;&#1077;&#1085;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1077;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;,
        &#1080;&#1085;&#1072;&#1095;&#1077; &#1084;&#1099; &#1085;&#1077;
        &#1089;&#1084;&#1086;&#1078;&#1077;&#1084;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;
        &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1091;&#1102;
        &#1089;&#1089;&#1099;&#1083;&#1082;&#1091;, &#1072;
        &#1079;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1082;&#1086;&#1076;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
        &#1085;&#1077; &#1089;&#1084;&#1086;&#1078;&#1077;&#1090;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DeviceType</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;
        &#1091;&#1085;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1080;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;
        &#1090;&#1080;&#1087;&#1072;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;.<br>
        <br>
        &#1069;&#1090;&#1086;&#1075;&#1086;
        &#1084;&#1086;&#1084;&#1077;&#1085;&#1090;&#1072; &#1084;&#1099;
        &#1082;&#1086;&#1089;&#1085;&#1091;&#1083;&#1080;&#1089;&#1100; &#1074;
        &#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;,
        &#1087;&#1088;&#1080;
        &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1080;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1082;&#1086;&#1076;&#1072; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
        &#1059; &#1085;&#1072;&#1089; &#1101;&#1090;&#1086;&#1090;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
        &#1074;&#1089;&#1077;&#1075;&#1076;&#1072;
        &#1073;&#1091;&#1076;&#1077;&#1090; FILE_DEVICE_UNKNOWN;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DeviceCharacteristics</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1072;&#1103;
        &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103;
        &#1086;&#1073;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1077;.<br>
        <br>
        &#1059; &#1085;&#1072;&#1089; &#1085;&#1080;&#1095;&#1077;&#1075;&#1086;
        &#1090;&#1072;&#1082;&#1086;&#1075;&#1086; &#1085;&#1077;&#1090;,
        &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;
        &#1089;&#1090;&#1072;&#1074;&#1080;&#1084; &#1074; 0;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>Exclusive</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;
        &#1084;&#1086;&#1085;&#1086;&#1087;&#1086;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;.<br>
        <br>
        &#1054;&#1087;&#1103;&#1090;&#1100; &#1078;&#1077; &#1074;
        &#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;,
        &#1087;&#1088;&#1080;
        &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1080;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CreateFile, &#1103;
        &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;, &#1095;&#1090;&#1086;
        &#1084;&#1085;&#1077; &#1085;&#1077;
        &#1091;&#1076;&#1072;&#1083;&#1086;&#1089;&#1100;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
        &#1084;&#1086;&#1085;&#1086;&#1087;&#1086;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; dwShareMode.
        &#1069;&#1090;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086;
        &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1089;
        &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; Exclusive.
        &#1058;&#1088;&#1091;&#1076;&#1085;&#1086;
        &#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;
        &#1085;&#1091;&#1078;&#1085;&#1086; &#1085;&#1072;&#1084;
        &#1101;&#1090;&#1086; &#1080;&#1083;&#1080; &#1085;&#1077;&#1090;,
        &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1084;&#1099;
        &#1088;&#1072;&#1079;&#1088;&#1077;&#1096;&#1072;&#1077;&#1084;
        &#1086;&#1076;&#1085;&#1086;&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1077;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;
        &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1084;&#1080;
        &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;&#1084;&#1080;
        &#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1103;
        &#1101;&#1090;&#1086;&#1090;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; &#1074; FALSE;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="150"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>DeviceObject</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1101;&#1090;&#1086;&#1090;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
        &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
        &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;&#1099;&#1084;
        &#1080; &#1073;&#1091;&#1076;&#1077;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;,
        &#1087;&#1088;&#1080;
        &#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;&#1084;
        &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; IoCreateDevice,
        &#1085;&#1072;
        &#1074;&#1099;&#1089;&#1086;&#1082;&#1086;&#1087;&#1072;&#1088;&#1085;&#1086;
        &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1084;&#1099;&#1081;
        Microsoft &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;,
        &#1103;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;&#1089;&#1103;
        &#1085;&#1072; &#1089;&#1072;&#1084;&#1086;&#1084;
        &#1076;&#1077;&#1083;&#1077;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1086;&#1081;
        DEVICE_OBJECT. &#1063;&#1077;&#1088;&#1077;&#1079; &#1101;&#1090;&#1091;
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1080;
        &#1073;&#1091;&#1076;&#1077;&#1090; &#1080;&#1084;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;.<br>
        <br>
        &#1045;&#1089;&#1083;&#1080;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;
        &#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1091;&#1102;
        &#1089;&#1089;&#1099;&#1083;&#1082;&#1091; &#1085;&#1077;
        &#1091;&#1076;&#1072;&#1089;&#1090;&#1089;&#1103;, &#1090;&#1086;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
        &#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1076;&#1083;&#1103; &#1077;&#1075;&#1086;
        &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;&#1080;&#1103;.
        &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1084;&#1099;
        &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1084; &#1074;
        &#1101;&#1090;&#1086;&#1084;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077;
        &#1072;&#1076;&#1088;&#1077;&#1089;
        &#1083;&#1086;&#1082;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081;
        &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; <i>pDeviceObject</i>.
        &#1052;&#1086;&#1078;&#1085;&#1086;
        &#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
        &#1080; &#1074;
        &#1075;&#1083;&#1086;&#1073;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081;
        &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;
        &#1080;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1077;&#1075;&#1086; &#1074;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
        &#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;, &#1085;&#1086;
        &#1103; &#1101;&#1090;&#1086;&#1075;&#1086;
        &#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077;
        &#1089;&#1090;&#1072;&#1083;, &#1095;&#1090;&#1086;&#1073;&#1099;
        &#1085;&#1077;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1074;&#1072;&#1090;&#1100;
        &#1083;&#1080;&#1096;&#1085;&#1102;&#1102;
        &#1089;&#1077;&#1082;&#1094;&#1080;&#1102; ?data. &#1040;
        &#1087;&#1088;&#1080;
        &#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1077;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1084;&#1099;
        &#1080;&#1079;&#1074;&#1083;&#1077;&#1095;&#1077;&#1084;
        &#1101;&#1090;&#1086;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1087;&#1088;&#1103;&#1084;&#1086; &#1080;&#1079;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p><code><!--mstheme--></font>
<pre>     .if eax == STATUS_SUCCESS
         invoke IoCreateSymbolicLink, addr g_usSymbolicLinkName, addr g_usDeviceName

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086; &#1073;&#1077;&#1079;
&#1086;&#1096;&#1080;&#1073;&#1086;&#1082;, &#1090;&#1086;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1085;&#1072;&#1096;&#1080;&#1084; &#1096;&#1072;&#1075;&#1086;&#1084;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080; (&#1095;&#1090;&#1086;
&#1101;&#1090;&#1086; &#1090;&#1072;&#1082;&#1086;&#1077; &#1080;
&#1079;&#1072;&#1095;&#1077;&#1084; &#1085;&#1091;&#1078;&#1085;&#1086;,
&#1084;&#1099;
&#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1086;&#1073;&#1089;&#1091;&#1076;&#1080;&#1083;&#1080; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;). &#1069;&#1090;&#1086;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1080;&#1090;
&#1082;&#1086;&#1076;&#1091; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;. &#1071;
&#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1076;&#1080;&#1090;&#1100;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; IoCreateSymbolicLink -
&#1090;&#1091;&#1090; &#1080; &#1090;&#1072;&#1082; &#1074;&#1089;&#1077;
&#1103;&#1089;&#1085;&#1086;.
<p><code><!--mstheme--></font>
<pre>         .if eax == STATUS_SUCCESS
             mov eax, pDriverObject
             assume eax:ptr DRIVER_OBJECT
             mov [eax].MajorFunction[IRP_MJ_CREATE*(sizeof PVOID)],           offset DispatchCreateClose
             mov [eax].MajorFunction[IRP_MJ_CLOSE*(sizeof PVOID)],            offset DispatchCreateClose
             mov [eax].MajorFunction[IRP_MJ_DEVICE_CONTROL*(sizeof PVOID)],   offset DispatchControl

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1080;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;,
&#1087;&#1077;&#1088;&#1077;&#1093;&#1086;&#1076;&#1080;&#1084; &#1082;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1084;&#1091;
&#1101;&#1090;&#1072;&#1087;&#1091;.
<p>&#1042; &#1089;&#1086;&#1089;&#1090;&#1072;&#1074;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; DRIVER_OBJECT
&#1074;&#1093;&#1086;&#1076;&#1080;&#1090;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074; <i>MajorFunction</i>. &#1042;
&#1101;&#1090;&#1086;&#1090; &#1084;&#1072;&#1089;&#1080;&#1074;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1080; &#1085;&#1072; <i>&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;</i>
(dispatch routines),
&#1087;&#1088;&#1077;&#1076;&#1085;&#1072;&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1076;&#1083;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1088;&#1072;&#1079;&#1085;&#1099;&#1093; &#1090;&#1080;&#1087;&#1086;&#1074;
&#1087;&#1072;&#1082;&#1077;&#1090;&#1086;&#1074;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072; (IRP).
&#1050;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1089;&#1074;&#1086;&#1077;&#1084;&#1091; &#1090;&#1080;&#1087;&#1091; IRP.
&#1045;&#1089;&#1083;&#1080;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089; &#1090;&#1080;&#1087;&#1072;
IRP_MJ_SHUTDOWN,
&#1091;&#1074;&#1077;&#1076;&#1086;&#1084;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1086; &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1099;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;, &#1090;&#1086; &#1086;&#1085;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100; &#1074;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1091;&#1102;
&#1087;&#1086;&#1079;&#1080;&#1094;&#1080;&#1102;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; <i>MajorFunction</i>
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1099;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1090;&#1080;&#1087;&#1072; &#1080;
&#1073;&#1091;&#1076;&#1091;&#1090;
&#1085;&#1072;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;&#1089;&#1103;.
&#1045;&#1089;&#1083;&#1080; &#1090;&#1072;&#1082;&#1072;&#1103;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091; &#1085;&#1077;
&#1085;&#1091;&#1078;&#1085;&#1072;, &#1082;&#1072;&#1082; &#1074;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1090;&#1086; &#1080;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; <i>MajorFunction</i>
&#1085;&#1077; &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;.
&#1058;.&#1086;. &#1084;&#1099; &#1089;&#1086;&#1074;&#1089;&#1077;&#1084;
&#1085;&#1077; &#1086;&#1073;&#1103;&#1079;&#1072;&#1085;&#1099;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1090;&#1100;
&#1074;&#1089;&#1077; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1099;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; <i>MajorFunction</i>,
&#1082;&#1086;&#1080;&#1093; &#1074; Windows 2000 DDK
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1086;
&#1072;&#1078; &#1094;&#1077;&#1083;&#1099;&#1093; 28
&#1096;&#1090;&#1091;&#1082; (IRP_MJ_MAXIMUM_FUNCTION+1). &#1042;&#1089;&#1077;
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1090; &#1086;&#1090;
&#1079;&#1072;&#1076;&#1072;&#1095;
&#1089;&#1090;&#1086;&#1103;&#1097;&#1080;&#1093;
&#1087;&#1077;&#1088;&#1077;&#1076;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; beeper.sys &#1080;
&#1090;&#1072;&#1082;
&#1087;&#1088;&#1077;&#1082;&#1088;&#1072;&#1089;&#1085;&#1086;
&#1089;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1083;&#1089;&#1103;
&#1089;&#1086; &#1089;&#1074;&#1086;&#1077;&#1081;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1086;&#1081;,
&#1074;&#1086;&#1086;&#1073;&#1097;&#1077; &#1085;&#1077;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1103;
&#1085;&#1080;&#1082;&#1072;&#1082;&#1080;&#1093;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;.
&#1042; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1099;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; <i>MajorFunction</i>
&#1085;&#1077;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1079;&#1072;&#1085;&#1086;&#1089;&#1080;&#1090;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1074;&#1085;&#1091;&#1090;&#1088;&#1077;&#1085;&#1085;&#1102;&#1102;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; IopInvalidDeviceRequest.
&#1069;&#1090;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
&#1091;&#1074;&#1077;&#1076;&#1086;&#1084;&#1083;&#1103;&#1077;&#1090; &#1086;
&#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1077;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1103; &#1082;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1081;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;.
<p>&#1044;&#1083;&#1103; &#1090;&#1086;&#1075;&#1086;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1089;&#1084;&#1086;&#1075; &#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CreateFile, DeviceIoControl
&#1080; CloseHandle, &#1084;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1082;&#1072;&#1082; &#1084;&#1080;&#1085;&#1080;&#1084;&#1091;&#1084;
&#1090;&#1088;&#1080; &#1090;&#1080;&#1087;&#1072;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1086;&#1074;:
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>IRP_MJ_CREATE</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1086;&#1084;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1088;&#1080; &#1074;&#1099;&#1079;&#1086;&#1074;&#1077;
        &#1082;&#1086;&#1076;&#1086;&#1084;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CreateFile;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>IRP_MJ_DEVICE_CONTROL</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1086;&#1084;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1088;&#1080; &#1074;&#1099;&#1079;&#1086;&#1074;&#1077;
        &#1082;&#1086;&#1076;&#1086;&#1084;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>IRP_MJ_CLOSE</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>-
        &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1086;&#1084;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1088;&#1080; &#1074;&#1099;&#1079;&#1086;&#1074;&#1077;
        &#1082;&#1086;&#1076;&#1086;&#1084;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CloseHandle.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1047;&#1072;&#1087;&#1088;&#1086;&#1089;&#1099;
&#1090;&#1080;&#1087;&#1086;&#1074; IRP_MJ_CREATE &#1080; IRP_MJ_CLOSE
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1086;&#1076;&#1085;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
DispatchCreateClose. &#1055;&#1086;&#1095;&#1077;&#1084;&#1091;
&#1091;&#1079;&#1085;&#1072;&#1077;&#1084; &#1087;&#1086;&#1079;&#1078;&#1077;.
<p>&#1042; ntddk.inc, &#1089;&#1088;&#1077;&#1076;&#1080;
&#1087;&#1088;&#1086;&#1095;&#1080;&#1093;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1099;
&#1084;&#1086;&#1075;&#1091;&#1097;&#1080;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1076;&#1083;&#1103; &#1085;&#1072;&#1089;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1077;&#1089;:
<p><code><!--mstheme--></font>
<pre> IRP_MJ_CREATE               equ 0
 . . .
 IRP_MJ_CLOSE                equ 2
 IRP_MJ_READ                 equ 3
 IRP_MJ_WRITE                equ 4
 . . .
 IRP_MJ_DEVICE_CONTROL       equ 0Eh
 . . .
 IRP_MJ_CLEANUP              equ 12h

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1069;&#1090;&#1086;
&#1087;&#1086;&#1088;&#1103;&#1076;&#1082;&#1086;&#1074;&#1099;&#1077;
&#1085;&#1086;&#1084;&#1077;&#1088;&#1072;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1102;&#1097;&#1080;&#1077;
&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1103; &#1085;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1074; &#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1077; <i>MajorFunction</i>.
&#1059;&#1084;&#1085;&#1086;&#1078;&#1080;&#1074;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1091;&#1102;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1091; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1088;&#1072;&#1074;&#1085;&#1099;&#1081; 4
&#1073;&#1072;&#1081;&#1090;&#1072;&#1084;, &#1084;&#1099;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084;
&#1089;&#1084;&#1077;&#1097;&#1077;&#1085;&#1080;&#1077; &#1074;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1077; <i>MajorFunction</i>,
&#1087;&#1086; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084;&#1091;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1073;&#1099;&#1090;&#1100;
&#1088;&#1072;&#1089;&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1091;&#1102;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;.
<p><code><!--mstheme--></font>
<pre>             mov [eax].DriverUnload,                                          offset DriverUnload

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1097;&#1077; &#1086;&#1076;&#1085;&#1086;
&#1082;&#1083;&#1102;&#1095;&#1077;&#1074;&#1086;&#1077;
&#1087;&#1086;&#1083;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; DRIVER_OBJECT <i>DriverUnload</i>.
&#1058;&#1091;&#1076;&#1072; &#1084;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100;,
&#1077;&#1089;&#1083;&#1080; &#1093;&#1086;&#1090;&#1080;&#1084;
&#1080;&#1084;&#1077;&#1090;&#1100;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1076;&#1080;&#1085;&#1072;&#1084;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1078;&#1072;&#1090;&#1100;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100; &#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1080;
&#1082;&#1086;&#1076;&#1072; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1082; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ControlService &#1089;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084;
SERVICE_CONTROL_STOP.
<p>&#1048;&#1084;&#1077;&#1085;&#1072;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;,
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1080; &#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1084;&#1086;&#1075;&#1091;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1086;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080;.
<p><code><!--mstheme--></font>
<pre>             assume eax:nothing
             mov status, STATUS_SUCCESS

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; &#1084;&#1099;
&#1073;&#1083;&#1072;&#1075;&#1086;&#1087;&#1086;&#1083;&#1091;&#1095;&#1085;&#1086;
&#1076;&#1086;&#1096;&#1083;&#1080; &#1076;&#1086; &#1101;&#1090;&#1086;&#1081;
&#1090;&#1086;&#1095;&#1082;&#1080;, &#1090;&#1086;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1072;
&#1091;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;, &#1086; &#1095;&#1077;&#1084;
&#1084;&#1099; &#1080; &#1089;&#1086;&#1086;&#1073;&#1097;&#1072;&#1077;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;,
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1103;
&#1082;&#1086;&#1076; &#1091;&#1089;&#1087;&#1077;&#1093;&#1072; STATUS_SUCCESS.
<p><code><!--mstheme--></font>
<pre>         .else
             invoke IoDeleteDevice, pDeviceObject
         .endif
     .endif

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; &#1078;&#1077;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1091;&#1102;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1091; &#1085;&#1077;
&#1091;&#1076;&#1072;&#1083;&#1086;&#1089;&#1100;, &#1090;&#1086; &#1084;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1091;&#1076;&#1072;&#1083;&#1080;&#1090;&#1100;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;,
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1085;&#1099;&#1081; &#1085;&#1072;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1084;
&#1101;&#1090;&#1072;&#1087;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1077;&#1081; IoCreateDevice,
&#1095;&#1090;&#1086;&#1073;&#1099;
&#1087;&#1088;&#1080;&#1074;&#1077;&#1089;&#1090;&#1080;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1091; &#1074;
&#1087;&#1088;&#1077;&#1078;&#1085;&#1077;&#1077;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077;.
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;! &#1069;&#1090;&#1086;
&#1074;&#1072;&#1084; &#1085;&#1077; &#1088;&#1077;&#1078;&#1080;&#1084;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1075;&#1076;&#1077; &#1087;&#1086;&#1089;&#1083;&#1077;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072; &#1074;&#1089;&#1077;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; &#1077;&#1084;&#1091;
&#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1072;&#1097;&#1080;&#1077;
&#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;
&#1091;&#1085;&#1080;&#1095;&#1090;&#1086;&#1078;&#1072;&#1102;&#1090;&#1089;&#1103;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1086;&#1081;. &#1042;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1077; &#1103;&#1076;&#1088;&#1072;
&#1085;&#1080;&#1082;&#1090;&#1086; &#1079;&#1072; &#1085;&#1072;&#1089;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;
&#1075;&#1088;&#1103;&#1079;&#1085;&#1091;&#1102;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1091; &#1085;&#1077;
&#1073;&#1091;&#1076;&#1077;&#1090;. &#1069;&#1090;&#1086;
&#1086;&#1073;&#1097;&#1077;&#1077;
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;.
&#1042;&#1099;&#1076;&#1077;&#1083;&#1080;&#1083;&#1080;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100; -
&#1086;&#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1080;&#1090;&#1077;.
&#1057;&#1086;&#1079;&#1076;&#1072;&#1083;&#1080;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; -
&#1091;&#1076;&#1072;&#1083;&#1080;&#1090;&#1077;.
&#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1083;&#1080;
&#1089;&#1089;&#1099;&#1083;&#1082;&#1091; &#1085;&#1072;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090; - &quot;&#1086;&#1090;&#1076;&#1072;&#1081;&#1090;&#1077;&quot;
&#1085;&#1072;&#1079;&#1072;&#1076;. &#1048; &#1090;.&#1076;. &#1080; &#1090;.&#1087;.
&#1047;&#1072;&#1087;&#1086;&#1084;&#1085;&#1080;&#1090;&#1077;
&#1101;&#1090;&#1086;.
<p><code><!--mstheme--></font>
<pre>     mov eax, status
     ret

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1081; &#1082;&#1086;&#1076;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1103;.
&#1045;&#1089;&#1083;&#1080; &#1101;&#1090;&#1086; STATUS_SUCCESS,
&#1090;&#1086; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1086;&#1089;&#1090;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1080;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1080; &#1085;&#1072;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1077;&#1075;&#1086;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;&#1084;
&#1087;&#1072;&#1082;&#1077;&#1090;&#1099;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1045;&#1089;&#1083;&#1080; &#1101;&#1090;&#1086;
&#1082;&#1072;&#1082;&#1086;&#1077;-&#1083;&#1080;&#1073;&#1086;
&#1076;&#1088;&#1091;&#1075;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;, &#1090;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1091;&#1076;&#1072;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;.
<p>&#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;,
&#1087;&#1086;&#1089;&#1083;&#1077;
&#1091;&#1076;&#1072;&#1095;&#1085;&#1086;&#1075;&#1086;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103;
DriverEntry &#1074; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1087;&#1086;&#1103;&#1074;&#1080;&#1090;&#1089;&#1103; &#1090;&#1088;&#1080;
&#1085;&#1086;&#1074;&#1099;&#1093;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;:
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="50"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&nbsp;<!--mstheme--></font>
        <!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
          <!--msthemelist--><tr>
            <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
            <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">&nbsp;<!--mstheme--></font><!--msthemelist--></td>
          </tr>
        <!--msthemelist--></table>
        <!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&#1054;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;,
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
        &#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1074;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;.<br>
        <br>
        &#1048;&#1079; &#1101;&#1090;&#1086;&#1075;&#1086;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; (&#1090;&#1086;&#1095;&#1085;&#1077;&#1077;
        &#1080;&#1079; &#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072; <i>MajorFunction</i>
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
        DRIVER_OBJECT)
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1090;
        &#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="50"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&nbsp;<!--mstheme--></font>
        <!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
          <!--msthemelist--><tr>
            <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
            <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">&nbsp;<!--mstheme--></font><!--msthemelist--></td>
          </tr>
        <!--msthemelist--></table>
        <!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&#1054;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;,
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
        &#1074; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;.<br>
        <br>
        &#1048;&#1079; &#1101;&#1090;&#1086;&#1075;&#1086;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; (&#1090;&#1086;&#1095;&#1085;&#1077;&#1077;
        &#1080;&#1079; &#1087;&#1086;&#1083;&#1103; <i>DriverObject</i>
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
        DEVICE_OBJECT)
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;
        &#1101;&#1090;&#1086;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;
        &#1086;&#1073;&#1089;&#1083;&#1091;&#1078;&#1080;&#1074;&#1072;&#1102;&#1097;&#1080;&#1081;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="50"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&nbsp;<!--mstheme--></font>
        <!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
          <!--msthemelist--><tr>
            <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
            <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">&nbsp;<!--mstheme--></font><!--msthemelist--></td>
          </tr>
        <!--msthemelist--></table>
        <!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&#1054;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1092;&#1072;&#1081;&#1083;&quot;,
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
        &#1076;&#1083;&#1103; &#1082;&#1086;&#1076;&#1072;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;.<br>
        <br>
        &#1048;&#1079; &#1101;&#1090;&#1086;&#1075;&#1086;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; (&#1090;&#1086;&#1095;&#1085;&#1077;&#1077;
        &#1080;&#1079; &#1087;&#1086;&#1083;&#1103; <i>DeviceObject</i>
        &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
        FILE_OBJECT)
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;;<br>
        <br>
        &#1069;&#1090;&#1086;&#1090; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;
        &#1087;&#1088;&#1086;&#1079;&#1088;&#1072;&#1095;&#1077;&#1085;
        &#1076;&#1083;&#1103; &#1085;&#1072;&#1089;. &#1054;
        &#1090;&#1086;&#1084;, &#1082;&#1072;&#1082;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1092;&#1072;&#1081;&#1083;&quot;
        &#1074;&#1086;&#1079;&#1085;&#1080;&#1082;&#1072;&#1077;&#1090;,
        &#1084;&#1099; &#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1080;
        &#1074; &#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081;
        &#1088;&#1072;&#1079;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="50"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&nbsp;<!--mstheme--></font>
        <!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
          <!--msthemelist--><tr>
            <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
            <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica">&nbsp;<!--mstheme--></font><!--msthemelist--></td>
          </tr>
        <!--msthemelist--></table>
        <!--mstheme--><font face="Arial, Arial, Helvetica"><!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>&#1057;&#1080;&#1084;&#1074;&#1086;&#1083;&#1100;&#1085;&#1072;&#1103;
        &#1089;&#1089;&#1099;&#1083;&#1082;&#1072;,
        &#1074;&#1080;&#1076;&#1080;&#1084;&#1072;&#1103;
        &#1082;&#1086;&#1076;&#1091; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;.<br>
        <br>
        &#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1086;&#1084;
        &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;
        &#1076;&#1083;&#1103;
        &#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1080;
        &#1074;&#1086;
        &#1074;&#1085;&#1091;&#1090;&#1088;&#1077;&#1085;&#1085;&#1077;&#1077;
        &#1080;&#1084;&#1103;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;.</p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1053;&#1072; &#1088;&#1080;&#1089;. 5-1
&#1087;&#1086;&#1082;&#1072;&#1079;&#1072;&#1085;&#1099;
&#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1099;&#1077;
&#1074;&#1079;&#1072;&#1080;&#1084;&#1086;&#1089;&#1074;&#1103;&#1079;&#1080;
&#1101;&#1090;&#1080;&#1093;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;. &#1069;&#1090;&#1072;
&#1089;&#1093;&#1077;&#1084;&#1072;
&#1087;&#1086;&#1084;&#1086;&#1078;&#1077;&#1090; &#1074;&#1072;&#1084;
&#1075;&#1083;&#1091;&#1073;&#1078;&#1077;
&#1087;&#1086;&#1085;&#1103;&#1090;&#1100;
&#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1080;&#1081;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1072;&#1083;.
<p align="center"><!-- &#1047;&#1076;&#1077;&#1089;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1082;&#1072;&#1088;&#1090;&#1080;&#1085;&#1082;&#1072; -->
<img src="kmd5-1.gif" width="607" height="796"><center>
<p><b>&#1056;&#1080;&#1089;. 5-1.</b>
&#1042;&#1079;&#1072;&#1080;&#1084;&#1086;&#1089;&#1074;&#1103;&#1079;&#1080;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074; &quot;&#1092;&#1072;&#1081;&#1083;&quot;,
&quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
&#1080; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot; &#1089;
&#1087;&#1072;&#1082;&#1077;&#1090;&#1086;&#1084;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1080; &#1082;&#1086;&#1076;&#1086;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;</center><br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1086;&#1074;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;</strong>
<p>&#1042;&#1089;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1080;&#1084;&#1077;&#1102;&#1090;
&#1086;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1099;&#1081;
&#1087;&#1088;&#1086;&#1090;&#1086;&#1090;&#1080;&#1087;.
<p><code><!--mstheme--></font>
<pre> DispatchRoutine proto stdcall pDeviceObject:PDEVICE_OBJECT, pIrp:PIRP

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="120"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pDeviceObject</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
        (&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072;
        DEVICE_OBJECT).<br>
        <br>
        &#1045;&#1089;&#1083;&#1080;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
        &#1086;&#1073;&#1089;&#1083;&#1091;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
        &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;,
        &#1090;&#1086; &#1087;&#1086;
        &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1102;
        &#1101;&#1090;&#1086;&#1075;&#1086;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;
        &#1084;&#1086;&#1078;&#1085;&#1086;
        &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;,
        &#1082; &#1082;&#1072;&#1082;&#1086;&#1084;&#1091;
        &#1080;&#1084;&#1077;&#1085;&#1085;&#1086;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;
        &#1087;&#1088;&#1080;&#1096;&#1077;&#1083;
        &#1079;&#1072;&#1087;&#1088;&#1086;&#1089;. &#1048;&#1083;&#1080;
        &#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1100;&#1089;&#1103;
        &#1082; &#1086;&#1073;&#1083;&#1072;&#1089;&#1090;&#1080;
        &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1081;
        &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
        &#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;.
        &#1042; &#1085;&#1072;&#1096;&#1077;&#1084;
        &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;, &#1074;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;&#1093;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;,
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
        &#1085;&#1077;
        &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="120"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><i>pIrp</i></p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; &#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1081;
        &#1087;&#1072;&#1082;&#1077;&#1090;
        &#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        (&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072; _IRP).<br>
        <br>
        &#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
        &#1089;&#1086;&#1079;&#1076;&#1072;&#1077;&#1090; IRP,
        &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
        &#1063;&#1077;&#1088;&#1077;&#1079;
        &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; <i>pIrp</i>
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
        &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;
        &#1085;&#1072; IRP. &#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1074;
        IRP, &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
        &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;
        &#1091;&#1082;&#1072;&#1079;&#1072;&#1085;&#1085;&#1091;&#1102; &#1074;
        &#1087;&#1072;&#1082;&#1077;&#1090;&#1077;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102; &#1080;
        &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
        &#1077;&#1075;&#1086;
        &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1091;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
        &#1095;&#1090;&#1086;&#1073;&#1099; &#1090;&#1086;&#1090;,
        &#1083;&#1080;&#1073;&#1086;
        &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1083;
        &#1101;&#1090;&#1091;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;,
        &#1083;&#1080;&#1073;&#1086;
        &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1083;
        &#1087;&#1072;&#1082;&#1077;&#1090;
        &#1076;&#1088;&#1091;&#1075;&#1086;&#1084;&#1091;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
        &#1076;&#1083;&#1103;
        &#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1077;&#1081;
        &#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;.
        &#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1072;&#1090;&#1100; IRP
        &#1080;&#1083;&#1080;
        &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1074;&#1072;&#1090;&#1100;
        &#1077;&#1075;&#1086; &#1076;&#1072;&#1083;&#1100;&#1096;&#1077;
        &#1088;&#1077;&#1096;&#1072;&#1077;&#1090; &#1089;&#1072;&#1084;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;. &#1053;&#1072;&#1096;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
        &#1086;&#1076;&#1085;&#1086;&#1091;&#1088;&#1086;&#1074;&#1085;&#1077;&#1074;&#1099;&#1081;,
        &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;
        &#1085;&#1080;&#1082;&#1072;&#1082;&#1086;&#1081;
        &#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1077;&#1081;
        &#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
        &#1085;&#1077;
        &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;.
        &#1055;&#1086;
        &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1080;
        &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;
        &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
        &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1099;
        &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1090;&#1103;&#1090;&#1089;&#1103;
        &#1082;&#1086;&#1076;&#1091; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
        &#1072; IRP &#1073;&#1091;&#1076;&#1077;&#1090;
        &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1058;&#1072;&#1082;&#1086;&#1081;
&#1091;&#1085;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1077;&#1090;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1091;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1083;&#1102;&#1073;&#1086;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;,
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1079;&#1085;&#1072;&#1103; &#1086; &#1077;&#1075;&#1086;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1077; &#1080;
&#1074;&#1085;&#1091;&#1090;&#1088;&#1077;&#1085;&#1085;&#1077;&#1084;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1077;, &#1072;
&#1090;&#1072;&#1082;&#1078;&#1077; &#1086;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1085;&#1080;&#1080;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.<br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080; IRP
&#1090;&#1080;&#1087;&#1086;&#1074; IRP_MJ_CREATE &#1080; IRP_MJ_CLOSE</strong>
<p>&#1044;&#1083;&#1103; &#1085;&#1072;&#1095;&#1072;&#1083;&#1072; &#1086;
&#1090;&#1086;&#1084;, &#1087;&#1086;&#1095;&#1077;&#1084;&#1091;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
DispatchCreateClose
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1091; &#1085;&#1072;&#1089; &#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1099;
&#1090;&#1072;&#1082;&#1086;&#1075;&#1086;
&#1088;&#1072;&#1079;&#1085;&#1086;&#1075;&#1086; &#1090;&#1080;&#1087;&#1072;.
&#1047;&#1072;&#1087;&#1088;&#1086;&#1089;&#1099;
&#1090;&#1080;&#1087;&#1086;&#1074; IRP_MJ_CREATE &#1080; IRP_MJ_CLOSE
&#1085;&#1072;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; CreateFile &#1080; CloseHandle,
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;.
&#1045;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1077;,
&#1095;&#1090;&#1086; &#1085;&#1072;&#1084; &#1085;&#1072;&#1076;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1076;&#1083;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1086;&#1073;&#1086;&#1080;&#1093;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1086;&#1074;, &#1101;&#1090;&#1086;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100; <i>&#1073;&#1083;&#1086;&#1082;
&#1089;&#1090;&#1072;&#1090;&#1091;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;</i>
(I/O status block) -
&#1074;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1091;&#1102; &#1074; _IRP
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091; IO_STATUS_BLOCK
- &#1080; &#1074;&#1077;&#1088;&#1085;&#1091;&#1090;&#1100;
&#1082;&#1086;&#1076; &#1091;&#1089;&#1087;&#1077;&#1093;&#1072;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1085;&#1077;
&#1087;&#1083;&#1086;&#1076;&#1080;&#1090;&#1100;
&#1083;&#1080;&#1096;&#1085;&#1080;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;-&#1073;&#1083;&#1080;&#1079;&#1085;&#1077;&#1094;&#1099;,
&#1103; &#1080;&#1093; &#1080;
&#1086;&#1073;&#1098;&#1077;&#1076;&#1080;&#1085;&#1080;&#1083;.
<p>&#1045;&#1089;&#1083;&#1080; &#1078;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1087;&#1086;&#1083;&#1072;&#1075;&#1072;&#1077;&#1090;&#1089;&#1103;,
&#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072; &#1090;&#1080;&#1087;&#1072;
IRP_MJ_CREATE, &#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1090;&#1100;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1091;&#1102;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;,
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1082;&#1072;&#1082;&#1080;&#1077;-&#1083;&#1080;&#1073;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077; &#1080; .&#1090;.&#1087;,
&#1090;&#1086; &#1087;&#1088;&#1080;
&#1079;&#1072;&#1082;&#1088;&#1099;&#1090;&#1080;&#1080;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;, &#1090;.&#1077;.
&#1087;&#1088;&#1080; &#1074;&#1099;&#1079;&#1086;&#1074;&#1077;
&#1082;&#1086;&#1076;&#1086;&#1084; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
CloseHandle, &#1101;&#1090;&#1080;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
&#1087;&#1088;&#1080;&#1076;&#1077;&#1090;&#1089;&#1103;
&#1091;&#1076;&#1072;&#1083;&#1103;&#1090;&#1100;. &#1058;.&#1077;.
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1087;&#1088;&#1080;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1080;&#1080;
&#1087;&#1072;&#1082;&#1077;&#1090;&#1086;&#1074; IRP_MJ_CREATE &#1080;
IRP_MJ_CLOSE &#1073;&#1091;&#1076;&#1091;&#1090;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1090;&#1100;&#1089;&#1103;. &#1042;
&#1101;&#1090;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100;.
<p><code><!--mstheme--></font>
<pre> DispatchCreateClose proc pDeviceObject:PDEVICE_OBJECT, pIrp:PIRP

     mov eax, pIrp
     assume eax:ptr _IRP
     mov [eax].IoStatus.Status, STATUS_SUCCESS
     and [eax].IoStatus.Information, 0
     assume eax:nothing

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1084;
&#1073;&#1083;&#1086;&#1082; &#1089;&#1090;&#1072;&#1090;&#1091;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
<p>&#1047;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1086;&#1083;&#1103; Status
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;,
&#1082;&#1072;&#1082;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1090;&#1089;&#1103;
&#1085;&#1072; &#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; CreateFile &#1080; CloseHandle.
&#1052;&#1099; &#1093;&#1086;&#1090;&#1080;&#1084;,
&#1095;&#1090;&#1086;&#1073;&#1099;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1074;&#1072;&#1083; &#1080;
&#1079;&#1072;&#1082;&#1088;&#1099;&#1074;&#1072;&#1083;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;
&#1073;&#1077;&#1079; &#1086;&#1096;&#1080;&#1073;&#1086;&#1082;.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1074;
&#1087;&#1086;&#1083;&#1077; Status &#1082;&#1086;&#1076;
&#1091;&#1089;&#1087;&#1077;&#1093;&#1072; STATUS_SUCCESS.
<p>&#1057;&#1084;&#1099;&#1089;&#1083; &#1087;&#1086;&#1083;&#1103; Information
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1090; &#1086;&#1090;
&#1090;&#1080;&#1087;&#1072; &#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;.
&#1069;&#1090;&#1086; &#1084;&#1086;&#1078;&#1077;&#1090;
&#1073;&#1099;&#1090;&#1100;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072;
&#1073;&#1072;&#1081;&#1090;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1086;&#1077;
&#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077;
&#1080;&#1083;&#1080;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;. &#1042;
&#1076;&#1072;&#1085;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1084;&#1099;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084; &#1074;
&#1101;&#1090;&#1086; &#1087;&#1086;&#1083;&#1077; 0. &#1055;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072; &#1090;&#1080;&#1087;&#1072;
IRP_MJ_DEVICE_CONTROL (&#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077; DispatchControl),
&#1084;&#1099; &#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1090;&#1091;&#1076;&#1072;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1073;&#1072;&#1081;&#1090;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;
&#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;.
<p><code><!--mstheme--></font>
<pre>     fastcall IofCompleteRequest, pIrp, IO_NO_INCREMENT

     mov eax, STATUS_SUCCESS
     ret

 DispatchCreateClose endp

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; IofCompleteRequest
&#1080;&#1085;&#1080;&#1094;&#1080;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072; (I/O
completion).
<p>&#1050;&#1072;&#1082; &#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1080;&#1079; &#1089;&#1072;&#1084;&#1086;&#1075;&#1086;
&#1085;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1103;, &#1101;&#1090;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;
&#1091;&#1074;&#1077;&#1076;&#1086;&#1084;&#1083;&#1103;&#1077;&#1090;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1086; &#1090;&#1086;&#1084;, &#1095;&#1090;&#1086;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1072; &#1080;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1090;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1077;&#1077;
&#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1099;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1090;&#1086;&#1088;&#1091;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072; (&#1074;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1082;&#1086;&#1076;&#1091; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;).
&#1054; &#1090;&#1086;&#1084;,
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1091;
&#1082;&#1072;&#1082;&#1086;&#1075;&#1086;
&#1080;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1090;&#1100;,
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1090;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;.
&#1042;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090;
&#1087;&#1086;&#1074;&#1099;&#1096;&#1077;&#1085;&#1080;&#1077;
&#1091;&#1088;&#1086;&#1074;&#1085;&#1103;
&#1087;&#1088;&#1080;&#1086;&#1088;&#1080;&#1090;&#1077;&#1090;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1080;&#1088;&#1086;&#1074;&#1072;&#1074;&#1096;&#1077;&#1075;&#1086;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;
&#1087;&#1086;&#1090;&#1086;&#1082;&#1072; &#1087;&#1086;&#1089;&#1083;&#1077;
&#1077;&#1077;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103;.
<p>&#1045;&#1089;&#1083;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1086;&#1073;&#1089;&#1083;&#1091;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;,
&#1090;&#1086; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1076;&#1083;&#1080;&#1090;&#1100;&#1089;&#1103;
&#1086;&#1097;&#1091;&#1090;&#1080;&#1084;&#1086;&#1077;
&#1074;&#1088;&#1077;&#1084;&#1103;. &#1055;&#1086;&#1082;&#1072;
&#1087;&#1086;&#1090;&#1086;&#1082; &#1078;&#1076;&#1077;&#1090;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;,
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1085;&#1077;
&#1087;&#1088;&#1077;&#1076;&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1077;&#1084;&#1091;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1086;&#1088;&#1085;&#1086;&#1077;
&#1074;&#1088;&#1077;&#1084;&#1103; (&#1087;&#1088;&#1080;
&#1089;&#1080;&#1085;&#1093;&#1088;&#1086;&#1085;&#1085;&#1099;&#1093;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103;&#1093;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1082;&#1072;&#1082; &#1074; &#1085;&#1072;&#1096;&#1077;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;). &#1055;&#1086;&#1089;&#1083;&#1077;
&#1086;&#1082;&#1086;&#1085;&#1095;&#1072;&#1085;&#1080;&#1103;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;
&#1086;&#1078;&#1080;&#1076;&#1072;&#1074;&#1096;&#1080;&#1081;
&#1087;&#1086;&#1090;&#1086;&#1082; &#1074;&#1087;&#1088;&#1072;&#1074;&#1077;
&#1085;&#1077;&#1084;&#1077;&#1076;&#1083;&#1077;&#1085;&#1085;&#1086;
&#1074;&#1086;&#1079;&#1086;&#1073;&#1085;&#1086;&#1074;&#1080;&#1090;&#1100;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077;.
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086; &#1095;&#1077;&#1088;&#1077;&#1079;
&#1074;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; IofCompleteRequest
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1080;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1072;&#1077;&#1090; &#1085;&#1072;
&#1082;&#1072;&#1082;&#1091;&#1102;
&#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1085;&#1091;
&#1087;&#1086;&#1074;&#1099;&#1089;&#1080;&#1090;&#1100;
&#1087;&#1088;&#1080;&#1086;&#1088;&#1080;&#1090;&#1077;&#1090;
&#1086;&#1078;&#1080;&#1076;&#1072;&#1074;&#1096;&#1077;&#1075;&#1086;
&#1087;&#1086;&#1090;&#1086;&#1082;&#1072;. &#1044;&#1083;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074; &quot;&#1090;&#1091;&#1075;&#1086;&#1076;&#1091;&#1084;&#1086;&#1074;&quot;
&#1087;&#1088;&#1077;&#1076;&#1091;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1099;
&#1073;&#1054;&#1083;&#1100;&#1096;&#1080;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1086;&#1074;&#1099;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1080;&#1086;&#1088;&#1080;&#1090;&#1077;&#1090;&#1072;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1076;&#1083;&#1103;
&#1079;&#1074;&#1091;&#1082;&#1086;&#1074;&#1099;&#1093;
&#1082;&#1072;&#1088;&#1090; DDK
&#1088;&#1077;&#1082;&#1086;&#1084;&#1077;&#1085;&#1076;&#1091;&#1077;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1091;
IO_SOUND_INCREMENT, &#1088;&#1072;&#1074;&#1085;&#1091;&#1102; 8.
<p>&#1042; &#1085;&#1072;&#1096;&#1077;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1087;&#1086;&#1074;&#1099;&#1096;&#1077;&#1085;&#1080;&#1103;
&#1087;&#1088;&#1080;&#1086;&#1088;&#1080;&#1090;&#1077;&#1090;&#1072;
&#1087;&#1086;&#1090;&#1086;&#1082;&#1072; &#1085;&#1077;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;, &#1080;
&#1084;&#1099; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1084;
IO_NO_INCREMENT &#1088;&#1072;&#1074;&#1085;&#1091;&#1102;
&#1085;&#1091;&#1083;&#1102;.
<p>&#1060;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; IofCompleteRequest
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; fastcall-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1077;&#1081;
(&#1089;&#1084;. &#1085;&#1080;&#1078;&#1077;). &#1042;
&#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1077;
&#1080;&#1084;&#1077;&#1085;&#1080;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1087;&#1088;&#1080;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083; 'f'.
&#1057;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;,
&#1082;&#1089;&#1090;&#1072;&#1090;&#1080;
&#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100;, &#1080; stdcall
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090; IoCompleteRequest.
&#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072;
&#1086;&#1090;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1080;&#1077;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072; 'f' &#1074;
&#1087;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1077;. &#1053;&#1086;,
&#1074;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1094;&#1077;&#1083;&#1103;&#1093;, &#1084;&#1099;
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1073;&#1099;&#1089;&#1090;&#1088;&#1091;&#1102;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1102;. &#1069;&#1090;&#1072; &#1085;&#1077;
&#1077;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1072;&#1103;
fastcall-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; -
&#1077;&#1089;&#1090;&#1100; &#1080; &#1076;&#1088;&#1091;&#1075;&#1080;&#1077;.
&#1048; &#1091; &#1085;&#1080;&#1093; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1077;&#1089;&#1090;&#1100; &#1089;&#1074;&#1086;&#1080; stdcall
&#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;, &#1082;&#1072;&#1082;
&#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;,
&#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103;
&#1086;&#1073;&#1086;&#1083;&#1086;&#1095;&#1082;&#1072;&#1084;&#1080;
&#1074;&#1086;&#1082;&#1088;&#1091;&#1075;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1093;
fastcall-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;.<br>
<br>
<br>
<p><strong>&#1057;&#1086;&#1075;&#1083;&#1072;&#1096;&#1077;&#1085;&#1080;&#1077;
&#1086; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1095;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1074;</strong>
<p>&#1042; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;&#1093; API
&#1103;&#1076;&#1088;&#1072; Windows NT
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1090;&#1088;&#1080; &#1090;&#1080;&#1087;&#1072;
&#1089;&#1086;&#1075;&#1083;&#1072;&#1096;&#1077;&#1085;&#1080;&#1081; &#1086;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1095;&#1077;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1074; (calling
convention): stdcall, cdecl &#1080; fastcall.
&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081;
&#1090;&#1080;&#1087; &#1085;&#1077;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1086;&#1084;
masm.
<p>&#1058;&#1072;&#1082;&#1080;&#1077;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1102;&#1090;
&#1087;&#1077;&#1088;&#1074;&#1099;&#1081;
&#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090; &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; ecx,
&#1074;&#1090;&#1086;&#1088;&#1086;&#1081; &#1074; edx,
&#1086;&#1089;&#1090;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;,
&#1087;&#1088;&#1080; &#1085;&#1072;&#1083;&#1080;&#1095;&#1080;&#1080;
&#1090;&#1072;&#1082;&#1086;&#1074;&#1099;&#1093;,
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1102;&#1090;&#1089;&#1103; &#1074;
&#1089;&#1090;&#1077;&#1082; &#1074;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1085;&#1086;&#1084;
&#1087;&#1086;&#1088;&#1103;&#1076;&#1082;&#1077; (&#1089;&#1087;&#1088;&#1072;&#1074;&#1072;
&#1085;&#1072;&#1083;&#1077;&#1074;&#1086;). &#1057;&#1090;&#1077;&#1082;
&#1086;&#1095;&#1080;&#1097;&#1072;&#1077;&#1090;
&#1074;&#1099;&#1079;&#1074;&#1072;&#1085;&#1085;&#1072;&#1103;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;.
<p>&#1044;&#1077;&#1082;&#1086;&#1088;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1080;&#1084;&#1077;&#1085;&#1072;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; fastcall
&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1102;&#1090;&#1089;&#1103; &#1089;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083;&#1072; &quot;@&quot;,
&#1087;&#1086;&#1089;&#1083;&#1077; &#1080;&#1084;&#1077;&#1085;&#1080;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1080;&#1084;&#1074;&#1086;&#1083; &quot;@&quot; &#1089;
&#1076;&#1077;&#1089;&#1103;&#1090;&#1080;&#1095;&#1085;&#1099;&#1084;
&#1095;&#1080;&#1089;&#1083;&#1086;&#1084;,
&#1086;&#1073;&#1086;&#1079;&#1085;&#1072;&#1095;&#1072;&#1102;&#1097;&#1080;&#1084;
&#1089;&#1091;&#1084;&#1084;&#1072;&#1088;&#1085;&#1099;&#1081;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074; &#1074;
&#1073;&#1072;&#1081;&#1090;&#1072;&#1093;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; IofCompleteRequest
&#1076;&#1077;&#1082;&#1086;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;:
<p><code><!--mstheme--></font>
<pre> @IofCompleteRequest@8

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1069;&#1090;&#1086; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090;,
&#1095;&#1090;&#1086; &#1101;&#1090;&#1086; fastcall-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;,
&#1101;&#1082;&#1089;&#1087;&#1086;&#1088;&#1090;&#1080;&#1088;&#1091;&#1077;&#1084;&#1086;&#1077;
&#1080;&#1084;&#1103; IofCompleteRequest,
&#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;
&#1076;&#1074;&#1072;
&#1072;&#1088;&#1075;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; DWORD
&#1082;&#1072;&#1078;&#1076;&#1099;&#1081;.
<p>&#1042; &#1092;&#1072;&#1081;&#1083;&#1077; \include\w2k\ntoskrnl.inc
&#1086;&#1085;&#1072;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; (&#1085;&#1072;
&#1082;&#1083;&#1102;&#1095;&#1077;&#1074;&#1086;&#1077;
&#1089;&#1083;&#1086;&#1074;&#1086; SYSCALL
&#1084;&#1086;&#1078;&#1077;&#1090;&#1077; &#1085;&#1077;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;
&#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077;):
<p><code><!--mstheme--></font>
<pre> EXTERNDEF SYSCALL @IofCompleteRequest@8:PROC
 IofCompleteRequest TEXTEQU &lt;@IofCompleteRequest@8&gt;

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1083;&#1103;
&#1091;&#1087;&#1088;&#1086;&#1097;&#1077;&#1085;&#1080;&#1103;
&#1074;&#1099;&#1079;&#1086;&#1074;&#1072; &#1090;&#1072;&#1082;&#1080;&#1093;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081; &#1103;
&#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; fastcall:
<p><code><!--mstheme--></font>
<pre> fastcall MACRO api:REQ, p1, p2, px:VARARG

 local arg

     ifnb &lt;px&gt;
         % for arg, @ArgRev( &lt;px&gt; )
             push arg
         endm
     endif

     ifnb &lt;p1&gt;

         ifdifi &lt;p1&gt;, &lt;ecx&gt;
             mov ecx, p1
         endif

         ifnb &lt;p2&gt;
             ifdifi &lt;p2&gt;, &lt;edx&gt;
                 mov edx, p2
             endif
         endif

     endif

     call api

 ENDM

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1076;&#1077;&#1089;&#1100;, &#1076;&#1083;&#1103;
&#1101;&#1082;&#1086;&#1085;&#1086;&#1084;&#1080;&#1080;
&#1084;&#1077;&#1089;&#1090;&#1072;, &#1103;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1078;&#1091;
&#1091;&#1087;&#1088;&#1086;&#1097;&#1077;&#1085;&#1085;&#1091;&#1102;
&#1074;&#1077;&#1088;&#1089;&#1080;&#1102; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1072;.
&#1063;&#1090;&#1086;&#1073;&#1099; &#1085;&#1077;
&#1087;&#1083;&#1086;&#1076;&#1080;&#1090;&#1100;
&#1083;&#1080;&#1096;&#1085;&#1080;&#1077; &#1092;&#1072;&#1081;&#1083;&#1099;
&#1089; &#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1072;&#1084;&#1080;,
&#1084;&#1085;&#1077; &#1087;&#1088;&#1080;&#1096;&#1083;&#1086;&#1089;&#1100;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1084;&#1072;&#1082;&#1088;&#1086;&#1089; &#1074;
\include\w2k\ntddk.inc, &#1075;&#1076;&#1077; &#1080;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1087;&#1086;&#1083;&#1085;&#1099;&#1081;
&#1074;&#1072;&#1088;&#1080;&#1072;&#1085;&#1090;. &#1042;
&#1086;&#1088;&#1080;&#1075;&#1080;&#1085;&#1072;&#1083;&#1100;&#1085;&#1086;&#1084;
ntddk.h &#1090;&#1072;&#1082;&#1086;&#1075;&#1086;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089;&#1072;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1085;&#1077;&#1090;.<br>
<br>
<br>
<p><strong>&#1042;&#1080;&#1076;&#1099;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080; &#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077; IRP</strong>
<p>&#1053;&#1072;&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1082;,
&#1093;&#1086;&#1095;&#1091; &#1077;&#1097;&#1077;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1078;&#1082;&#1086;
&#1087;&#1086;&#1084;&#1091;&#1095;&#1080;&#1090;&#1100; &#1074;&#1072;&#1089;
&#1090;&#1077;&#1086;&#1088;&#1080;&#1077;&#1081; ;-)
<p>&#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1090;&#1088;&#1080; &#1074;&#1080;&#1076;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080;:<!--mstheme--></font>
<!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica"><i>&#1073;&#1091;&#1092;&#1077;&#1088;&#1080;&#1079;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;
      &#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;</i> (buffered
      I/O);<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica"><i>&#1087;&#1088;&#1103;&#1084;&#1086;&#1081;
      &#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;</i> (direct
      I/O);<!--mstheme--></font><!--msthemelist--></td>
  </tr>
  <!--msthemelist--><tr>
    <!--msthemelist--><td valign="baseline" width="42"><img src="zerbul1a.gif" width="15" height="15" hspace="13"></td>
    <td valign="top" width="100%"><!--mstheme--><font face="Arial, Arial, Helvetica"><i>&#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;
      &#1073;&#1077;&#1079;
      &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;</i>
      (neither I/O).<!--mstheme--></font><!--msthemelist--></td>
  </tr>
<!--msthemelist--></table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&#1069;&#1090;&#1086;&#1075;&#1086;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;&#1072; &#1084;&#1099;
&#1095;&#1091;&#1090;&#1100;-&#1095;&#1091;&#1090;&#1100;
&#1082;&#1072;&#1089;&#1072;&#1083;&#1080;&#1089;&#1100; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1086;&#1081;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1077;.
&#1058;&#1077;&#1087;&#1077;&#1088;&#1100;
&#1087;&#1086;&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1084;
&#1073;&#1086;&#1083;&#1077;&#1077;
&#1086;&#1073;&#1089;&#1090;&#1086;&#1103;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;.
&#1047;&#1076;&#1077;&#1089;&#1100;, &#1084;&#1099;
&#1073;&#1091;&#1076;&#1077;&#1084;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1081;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl
&#1076;&#1083;&#1103;
&#1086;&#1088;&#1075;&#1072;&#1085;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
ReadFile &#1080; WriteFile &#1085;&#1077;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103;.
&#1055;&#1088;&#1080;&#1084;&#1077;&#1088;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
ReadFile &#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1090;&#1077; &#1074; \src\Article4-5\NtBuild.<br>
<br>
<br>
<p><strong><i>&#1073;&#1091;&#1092;&#1077;&#1088;&#1080;&#1079;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;</i></strong>
<p>&#1048;&#1084;&#1077;&#1085;&#1085;&#1086; &#1101;&#1090;&#1086;&#1090;
&#1074;&#1080;&#1076;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077; VirtToPhys.
<p>&#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1084;
&#1087;&#1091;&#1083;&#1077;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1081;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1073;&#1091;&#1092;&#1077;&#1088;,
&#1088;&#1072;&#1074;&#1085;&#1099;&#1081; &#1087;&#1086;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1091;
&#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1100;&#1096;&#1077;&#1084;&#1091; (&#1077;&#1089;&#1083;&#1080;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1099;,
&#1082;&#1072;&#1082; &#1074;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;,
&#1090;&#1072;&#1082; &#1080;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;) &#1080;&#1079;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1093;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;.
<p>&#1057;&#1086;&#1079;&#1076;&#1072;&#1074;&#1072;&#1103; IRP,
&#1087;&#1088;&#1080; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1080;,
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080;&#1079;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1086;&#1075;&#1086;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1074;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088; &#1080;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091; &#1077;&#1075;&#1086;
&#1072;&#1076;&#1088;&#1077;&#1089; &#1074; &#1087;&#1086;&#1083;&#1077;
AssociatedIrp.SystemBuffer
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP.
&#1056;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1086;&#1083;&#1077; Parameters.DeviceIoControl.InputBufferLength
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
IO_STACK_LOCATION (&#1085;&#1072; &#1101;&#1090;&#1091;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1091;
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1087;&#1086;&#1083;&#1077; Tail.Overlay.CurrentStackLocation
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP,
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1084;&#1072;&#1082;&#1088;&#1086;&#1089; IoGetCurrentIrpStackLocation).
<p>&#1044;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1077;&#1090;
IRP &#1080; &#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1099;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; (&#1087;&#1088;&#1080;
&#1085;&#1072;&#1083;&#1080;&#1095;&#1080;&#1080;
&#1090;&#1072;&#1082;&#1086;&#1074;&#1099;&#1093;) &#1074; &#1090;&#1086;&#1090;
&#1078;&#1077; &#1089;&#1072;&#1084;&#1099;&#1081;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;. &#1055;&#1088;&#1080;
&#1101;&#1090;&#1086;&#1084;,
&#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1097;&#1080;&#1077;&#1089;&#1103;
&#1090;&#1072;&#1084; &#1074;&#1093;&#1086;&#1076;&#1085;&#1099;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1087;&#1077;&#1088;&#1077;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103;.
&#1058;.&#1077;.
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1093;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074; &#1076;&#1074;&#1072;, &#1072;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1086;&#1076;&#1080;&#1085;. &#1045;&#1089;&#1083;&#1080;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1099;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1085;&#1091;&#1078;&#1085;&#1099;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;, &#1090;&#1086;
&#1086;&#1085; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1080;&#1093;
&#1075;&#1076;&#1077;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;.
<p>&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1072;&#1103; IRP,
&#1087;&#1088;&#1080; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;
&#1095;&#1090;&#1077;&#1085;&#1080;&#1103;,
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080;&#1079;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072; &#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;. &#1056;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1084;&#1099;&#1093;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1079; &#1087;&#1086;&#1083;&#1103; IoStatus.Information
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP.
&#1069;&#1090;&#1086; &#1087;&#1086;&#1083;&#1077;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1090; -
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1086;&#1085;
&#1079;&#1085;&#1072;&#1077;&#1090;
&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1073;&#1072;&#1081;&#1090;
&#1087;&#1086;&#1084;&#1077;&#1089;&#1090;&#1080;&#1083; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;.
<p>&#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;,
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1076;&#1074;&#1072;&#1078;&#1076;&#1099;
&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1099;.
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086;
&#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;, &#1101;&#1090;&#1086;&#1090;
&#1074;&#1080;&#1076;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1089;&#1072;&#1084;&#1099;&#1081;
&#1084;&#1077;&#1076;&#1083;&#1077;&#1085;&#1085;&#1099;&#1081;, &#1085;&#1086;
&#1087;&#1088;&#1080;
&#1089;&#1088;&#1072;&#1074;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1084;&#1072;&#1083;&#1099;&#1093;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1072;&#1093;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;
&#1080;&#1079;&#1076;&#1077;&#1088;&#1078;&#1082;&#1080;
&#1085;&#1077;&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;.
<p>&#1059; &#1101;&#1090;&#1086;&#1075;&#1086; &#1074;&#1080;&#1076;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1077;&#1089;&#1090;&#1100; &#1086;&#1076;&#1085;&#1086;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1077;
&#1087;&#1088;&#1077;&#1080;&#1084;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1086;
- &#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1089;&#1072;&#1084; &#1088;&#1077;&#1096;&#1072;&#1077;&#1090;
&#1074;&#1089;&#1077; &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1099;
&#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; &#1089;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1099;&#1084;&#1080;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;&#1084;&#1080;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;. &#1042;
&#1093;&#1091;&#1076;&#1096;&#1077;&#1084;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;, &#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl,
&#1085;&#1072; &#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1090;&#1089;&#1103;
&#1085;&#1077;&#1091;&#1076;&#1072;&#1095;&#1085;&#1086;.
<p>&#1055;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
&#1073;&#1091;&#1092;&#1077;&#1088;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1084;
&#1076;&#1080;&#1072;&#1087;&#1072;&#1079;&#1086;&#1085;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074;, &#1072;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1082; &#1085;&#1077;&#1084;&#1091;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1080;&#1079; &#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1083;&#1102;&#1073;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;. &#1053;&#1086;
&#1085;&#1072;&#1084; &#1101;&#1090;&#1086; &#1084;&#1072;&#1083;&#1086;
&#1095;&#1090;&#1086; &#1076;&#1072;&#1077;&#1090;, &#1090;.&#1082;.
&#1086;&#1076;&#1085;&#1086;&#1091;&#1088;&#1086;&#1074;&#1085;&#1077;&#1074;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1080; &#1090;&#1072;&#1082;,
&#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1081;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1073;&#1091;&#1076;&#1077;&#1090;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1074;
&#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1080;&#1088;&#1086;&#1074;&#1072;&#1074;&#1096;&#1077;&#1075;&#1086;
&#1101;&#1090;&#1091; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;.
<p>&#1055;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
&#1073;&#1091;&#1092;&#1077;&#1088;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1090;&#1089;&#1103; &#1074;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1081;
&#1086;&#1073;&#1083;&#1072;&#1089;&#1090;&#1080;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1072;
&#1079;&#1085;&#1072;&#1095;&#1080;&#1090;, &#1082; &#1085;&#1077;&#1084;&#1091;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1087;&#1088;&#1080; &#1083;&#1102;&#1073;&#1086;&#1084; IRQL. &#1053;&#1086;
&#1080; &#1101;&#1090;&#1086; &#1085;&#1072;&#1084; &#1090;&#1086;&#1078;&#1077;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1085;&#1077;
&#1076;&#1072;&#1077;&#1090;, &#1090;.&#1082;. &#1082;&#1086;&#1076;
&#1086;&#1076;&#1085;&#1086;&#1091;&#1088;&#1086;&#1074;&#1085;&#1077;&#1074;&#1086;&#1075;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;, &#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1081;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1087;&#1088;&#1080; IRQL = PASSIVE_LEVEL.
&#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091;,
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1076;&#1072;&#1078;&#1077; &#1082; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
&#1089;&#1073;&#1088;&#1086;&#1096;&#1077;&#1085;&#1085;&#1086;&#1081; &#1074;
&#1092;&#1072;&#1081;&#1083;
&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1082;&#1080; -
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1089;&#1072;&#1084;
&#1088;&#1077;&#1096;&#1080;&#1090; &#1074;&#1089;&#1077;
&#1074;&#1086;&#1087;&#1088;&#1086;&#1089;&#1099; &#1087;&#1086;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1102;
&#1077;&#1077; &#1074;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1091;&#1102;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;.
&#1055;&#1088;&#1072;&#1074;&#1076;&#1072;,
&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077;
&#1080;&#1079;&#1076;&#1077;&#1088;&#1078;&#1082;&#1080;
&#1073;&#1091;&#1076;&#1091;&#1090;.
<p>&#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1101;&#1090;&#1086;&#1090;
&#1074;&#1080;&#1076;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1088;&#1080;
&#1086;&#1090;&#1085;&#1086;&#1089;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1085;&#1077;&#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1093;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1072;&#1093;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;. &#1048;&#1083;&#1080;
&#1077;&#1089;&#1083;&#1080;
&#1086;&#1087;&#1077;&#1088;&#1077;&#1094;&#1080;&#1103;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1085;&#1077; &#1095;&#1072;&#1089;&#1090;&#1086;.
<p>&#1045;&#1089;&#1083;&#1080; &#1078;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
&#1087;&#1088;&#1080;&#1093;&#1086;&#1076;&#1080;&#1090;&#1100;&#1089;&#1103;
&#1087;&#1077;&#1088;&#1077;&#1075;&#1086;&#1085;&#1103;&#1090;&#1100;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1077;
&#1087;&#1086;&#1088;&#1094;&#1080;&#1080;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1087;&#1086;&#1090;&#1086;&#1082;&#1080; &#1072;&#1091;&#1076;&#1080;&#1086;
&#1080;&#1083;&#1080; &#1074;&#1080;&#1076;&#1077;&#1086;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093; (&#1101;&#1090;&#1072;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1103; &#1076;&#1072;&#1078;&#1077;
&#1074;&#1089;&#1082;&#1086;&#1083;&#1100;&#1079;&#1100; &#1085;&#1077;
&#1082;&#1072;&#1089;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1101;&#1090;&#1086;&#1081; &#1090;&#1077;&#1084;&#1099;), &#1090;&#1086;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1077;&#1090;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1073;&#1086;&#1083;&#1077;&#1077;
&#1101;&#1092;&#1092;&#1077;&#1082;&#1090;&#1080;&#1074;&#1085;&#1099;&#1081;
&#1084;&#1077;&#1090;&#1086;&#1076;.<br>
<br>
<br>
<p><strong><i>&#1087;&#1088;&#1103;&#1084;&#1086;&#1081;
&#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;</i></strong>
<p>&#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1076;&#1083;&#1103;
&#1086;&#1088;&#1075;&#1072;&#1085;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1087;&#1088;&#1103;&#1084;&#1086;&#1075;&#1086;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; (direct memory access, DMA).
<p>&#1071; &#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1074;&#1080;&#1076;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;, &#1090;.&#1082;.
&#1074; &#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1089;&#1090;&#1072;&#1090;&#1077;&#1081; &#1077;&#1084;&#1091;
&#1085;&#1077;&#1090;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1103;.
<p>&#1045;&#1089;&#1083;&#1080; &#1086;&#1095;&#1077;&#1085;&#1100;
&#1082;&#1086;&#1088;&#1086;&#1090;&#1082;&#1086;, &#1090;&#1086; &#1089;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1099;&#1084;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1084;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1084;
&#1089;&#1080;&#1090;&#1091;&#1072;&#1094;&#1080;&#1103;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102;
&#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1072;
&#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1084;&#1091;
&#1074;&#1080;&#1076;&#1091;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;.
&#1042;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081; &#1078;&#1077;
&#1073;&#1091;&#1092;&#1077;&#1088;, &#1085;&#1077;
&#1089;&#1084;&#1086;&#1090;&#1088;&#1103; &#1085;&#1072;
&#1089;&#1074;&#1086;&#1077;
&#1085;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1077;,
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;
&#1082;&#1072;&#1082; &#1080;&#1089;&#1090;&#1086;&#1095;&#1085;&#1080;&#1082; (METHOD_IN_DIRECT)
&#1080;&#1083;&#1080; &#1082;&#1072;&#1082;
&#1087;&#1088;&#1080;&#1077;&#1084;&#1085;&#1080;&#1082; (METHOD_OUT_DIRECT)
&#1076;&#1072;&#1085;&#1085;&#1099;&#1093;.
<p>&#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1073;&#1083;&#1086;&#1082;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;, &#1076;&#1077;&#1083;&#1072;&#1103;
&#1077;&#1075;&#1086;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1080;&#1074;&#1072;&#1077;&#1084;&#1099;&#1084;,
&#1080; &#1089;&#1086;&#1079;&#1076;&#1072;&#1077;&#1090; MDL (Memory Descriptor
List),
&#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1102;&#1097;&#1080;&#1081;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1077;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1077;&#1084;&#1099;&#1077;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1084;.
&#1059;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
MDL &#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1087;&#1086;&#1083;&#1077; MdlAddress
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP.
&#1055;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1077;&#1077; &#1089;&#1084;.
DDK.
<p>&#1042;&#1099; &#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;
&#1084;&#1086;&#1078;&#1077;&#1090;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1080; &#1101;&#1090;&#1086;&#1090; &#1084;&#1077;&#1090;&#1086;&#1076; &#1074;
&#1086;&#1076;&#1085;&#1086;&#1091;&#1088;&#1086;&#1074;&#1085;&#1077;&#1074;&#1086;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077;, &#1085;&#1086;
&#1077;&#1089;&#1083;&#1080; &#1091;&#1078; &#1074;&#1072;&#1084;
&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1086;&#1074;&#1072;&#1083;&#1086;&#1089;&#1100;
&#1087;&#1077;&#1088;&#1077;&#1089;&#1083;&#1072;&#1090;&#1100;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1081;
&#1086;&#1073;&#1098;&#1077;&#1084; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;,
&#1090;&#1086; &#1083;&#1091;&#1095;&#1096;&#1077;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1074;&#1080;&#1076;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;.<br>
<br>
<br>
<p><strong><i>&#1074;&#1074;&#1086;&#1076;-&#1074;&#1099;&#1074;&#1086;&#1076;
&#1073;&#1077;&#1079;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;</i></strong>
<p>&#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1090; &#1074;
&#1087;&#1086;&#1083;&#1077; DeviceIoControl.Type3InputBuffer
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
IO_STACK_LOCATION
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;, &#1072; &#1074;
&#1087;&#1086;&#1083;&#1077; UserBuffer
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088; &#1080;
&#1086;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;
&#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1090;&#1100;
&#1080;&#1084;&#1080;
&#1089;&#1072;&#1084;&#1086;&#1089;&#1090;&#1086;&#1103;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;.
&#1058;.&#1086;. &#1074;&#1089;&#1103;
&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1089;&#1090;&#1100;
&#1079;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1084;&#1080;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080;
&#1083;&#1086;&#1078;&#1080;&#1090;&#1089;&#1103; &#1085;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;. &#1054;&#1085;
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1073;&#1083;&#1086;&#1082;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1080;&#1093; &#1074; &#1087;&#1072;&#1084;&#1103;&#1090;&#1080;,
&#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1090;&#1100;
&#1085;&#1072; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086;
&#1080;&#1083;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103; &#1082;
&#1085;&#1080;&#1084; &#1085;&#1072;&#1087;&#1088;&#1103;&#1084;&#1091;&#1102;
&#1080; &#1090;.&#1076;.
<p>&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;,
&#1084;&#1099; &#1074;&#1089;&#1077;&#1075;&#1076;&#1072; (&#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1074;&#1080;&#1076;&#1091;
&#1086;&#1076;&#1085;&#1086;&#1091;&#1088;&#1086;&#1074;&#1085;&#1077;&#1074;&#1099;&#1081;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;), &#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1080;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1084;&#1089;&#1103; &#1074;
&#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1080;&#1088;&#1086;&#1074;&#1072;&#1083;
&#1101;&#1090;&#1091; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;,
&#1084;&#1099; &#1084;&#1086;&#1078;&#1077;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1090;&#1100;&#1089;&#1103; &#1082;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;
&#1085;&#1072;&#1087;&#1088;&#1103;&#1084;&#1091;&#1102;. &#1058;.&#1077;.
&#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1077;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086;
&#1085;&#1077; &#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;.
<p>&#1055;&#1086;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1091;,
&#1084;&#1099; &#1074;&#1089;&#1077;&#1075;&#1076;&#1072; (&#1074;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1085;&#1099;&#1093;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;&#1093;)
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1077;&#1084;&#1089;&#1103;
&#1087;&#1088;&#1080; IRQL = PASSIVE_LEVEL, &#1090;&#1086; &#1080;
&#1073;&#1083;&#1086;&#1082;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1077;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1099; &#1090;&#1086;&#1078;&#1077;
&#1085;&#1077;&#1090;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;.
<p>&#1054;&#1089;&#1090;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1086;&#1076;&#1085;&#1072;
&#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1072; -
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1087;&#1086;&#1090;&#1086;&#1082; &#1084;&#1086;&#1078;&#1077;&#1090;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1090;&#1100;
&#1079;&#1072;&#1074;&#1077;&#1076;&#1086;&#1084;&#1086;
&#1085;&#1077;&#1074;&#1077;&#1088;&#1085;&#1099;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089; &#1073;&#1091;&#1092;&#1077;&#1088;&#1072;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1087;&#1086;&#1087;&#1072;&#1076;&#1072;&#1102;&#1097;&#1080;&#1081; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086;
&#1080;&#1083;&#1080; &#1072;&#1076;&#1088;&#1077;&#1089;
&#1085;&#1077;&#1074;&#1099;&#1076;&#1077;&#1083;&#1077;&#1085;&#1085;&#1086;&#1081;
&#1086;&#1073;&#1083;&#1072;&#1089;&#1090;&#1080;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; &#1080; &#1090;.&#1087;.
&#1048;&#1083;&#1080;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1084;&#1085;&#1086;&#1075;&#1086;&#1087;&#1086;&#1090;&#1086;&#1095;&#1085;&#1099;&#1084;,
&#1080; &#1086;&#1076;&#1080;&#1085; &#1080;&#1079;
&#1087;&#1086;&#1090;&#1086;&#1082;&#1086;&#1074;
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1086;&#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1080;&#1090;&#1100;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1100;
&#1079;&#1072;&#1085;&#1080;&#1084;&#1072;&#1077;&#1084;&#1091;&#1102;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1084; &#1074;&#1086;
&#1074;&#1088;&#1077;&#1084;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1084;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;.
&#1058;&#1072;&#1082;&#1080;&#1077;
&#1089;&#1080;&#1090;&#1091;&#1072;&#1094;&#1080;&#1080;
&#1085;&#1072;&#1076;&#1086; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;
&#1087;&#1088;&#1077;&#1076;&#1074;&#1080;&#1076;&#1077;&#1090;&#1100; &#1080;
&#1082;&#1086;&#1088;&#1088;&#1077;&#1082;&#1090;&#1085;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1090;&#1100;.
&#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
<i>&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1085;&#1086;&#1081;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080;
&#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1081;</i> (Structured
Exception Handling, SEH) &#1087;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084;
&#1086;&#1073;&#1103;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086; (&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;
&#1089;&#1084;. \src\Article4-5\NtBuild).
&#1059;&#1095;&#1090;&#1080;&#1090;&#1077;
&#1090;&#1086;&#1083;&#1100;&#1082;&#1086;, &#1095;&#1090;&#1086;
&#1093;&#1086;&#1090;&#1103;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1085;&#1072;&#1103;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072;
&#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1081; &#1074;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1077; &#1103;&#1076;&#1088;&#1072;
&#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1080;&#1072;&#1083;&#1100;&#1085;&#1086;
&#1085;&#1080;&#1095;&#1077;&#1084; &#1085;&#1077;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1086;&#1090; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; &#1074;&#1089;&#1077;
&#1080;&#1089;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1085;&#1077; &#1091;&#1076;&#1072;&#1089;&#1090;&#1089;&#1103;.
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1072;
&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103; &#1085;&#1072;
&#1085;&#1086;&#1083;&#1100;
&#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1090; &#1082;
&#1087;&#1086;&#1103;&#1074;&#1083;&#1077;&#1085;&#1080;&#1102; BSOD
&#1076;&#1072;&#1078;&#1077; &#1087;&#1088;&#1080;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1085;&#1086;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1095;&#1080;&#1082;&#1077;
SEH.<br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1080; IRP
&#1090;&#1080;&#1087;&#1072; IRP_MJ_DEVICE_CONTROL</strong>
<p>&#1047;&#1072;&#1087;&#1088;&#1086;&#1089; &#1090;&#1080;&#1087;&#1072;
IRP_MJ_DEVICE_CONTROL
&#1085;&#1072;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091;,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; DeviceIoControl.
<p><code><!--mstheme--></font>
<pre>     and dwBytesReturned, 0

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1085;&#1077; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;.
<p><code><!--mstheme--></font>
<pre>     mov esi, pIrp
     assume esi:ptr _IRP

     IoGetCurrentIrpStackLocation esi
     mov edi, eax
     assume edi:ptr IO_STACK_LOCATION

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1052;&#1072;&#1082;&#1088;&#1086;&#1089; IoGetCurrentIrpStackLocation
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1090; &#1080;&#1079;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; _IRP
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1081; <i>&#1073;&#1083;&#1086;&#1082;
&#1089;&#1090;&#1077;&#1082;&#1072; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;</i>
(I/O stack). &#1069;&#1090;&#1086;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1072;
IO_STACK_LOCATION. &#1058;&#1072;&#1082;&#1080;&#1093;
&#1073;&#1083;&#1086;&#1082;&#1086;&#1074; &#1074;
&#1087;&#1072;&#1082;&#1077;&#1090;&#1077;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;, &#1074;
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;
&#1086;&#1090; &#1090;&#1086;&#1075;&#1086;,
&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;
&#1086;&#1073;&#1089;&#1083;&#1091;&#1078;&#1080;&#1074;&#1072;&#1102;&#1090;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;. &#1059; &#1085;&#1072;&#1089;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088; &#1086;&#1076;&#1080;&#1085;
&#1080; &#1073;&#1083;&#1086;&#1082; &#1089;&#1090;&#1077;&#1082;&#1072;
&#1073;&#1091;&#1076;&#1077;&#1090; &#1086;&#1076;&#1080;&#1085;.
<p><code><!--mstheme--></font>
<pre>     .if [edi].Parameters.DeviceIoControl.IoControlCode == IOCTL_GET_PHYS_ADDRESS

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;
&#1082;&#1086;&#1076; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1085;&#1077;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1086;&#1078;&#1080;&#1076;&#1072;&#1077;&#1084;&#1086;&#1084;&#1091;,
&#1085;&#1080;&#1095;&#1077;&#1075;&#1086;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1073;&#1091;&#1076;&#1077;&#1084;. &#1069;&#1090;&#1086;&#1090;
&#1082;&#1086;&#1076;, &#1085;&#1072;
&#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; DeviceIoControl &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077; <i>dwIoControlCode</i>.
&#1054; &#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1072;&#1093;
&#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1076;&#1072; &#1084;&#1099;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083;&#1080; &#1074;
&#1087;&#1088;&#1086;&#1096;&#1083;&#1099;&#1081; &#1088;&#1072;&#1079;.
<p>&#1054;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1076;&#1072; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
IOCTL_GET_PHYS_ADDRESS &#1080;
&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090; NUM_DATA_ENTRY &#1080;
DATA_SIZE &#1074;&#1099;&#1085;&#1077;&#1089;&#1077;&#1085;&#1086; &#1074;
&#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1092;&#1072;&#1081;&#1083; common.inc
<p><code><!--mstheme--></font>
<pre> NUM_DATA_ENTRY         equ 4
 DATA_SIZE              equ (sizeof DWORD) * NUM_DATA_ENTRY
 IOCTL_GET_PHYS_ADDRESS equ CTL_CODE(FILE_DEVICE_UNKNOWN, 800h, METHOD_BUFFERED, FILE_READ_ACCESS + FILE_WRITE_ACCESS)

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1069;&#1090;&#1080;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1102;&#1090;&#1089;&#1103;,
&#1082;&#1072;&#1082; &#1074;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1084;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;,
&#1090;&#1072;&#1082; &#1080; &#1074;
&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1086;&#1084;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.
<p><code><!--mstheme--></font>
<pre>         .if ( [edi].Parameters.DeviceIoControl.OutputBufferLength &gt;= DATA_SIZE ) &amp;&amp; ( [edi].Parameters.DeviceIoControl.InputBufferLength &gt;= DATA_SIZE )

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1077;&#1084;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086; &#1080;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;. &#1045;&#1089;&#1083;&#1080;
&#1093;&#1086;&#1090;&#1103; &#1073;&#1099; &#1086;&#1076;&#1080;&#1085;
&#1080;&#1079; &#1085;&#1080;&#1093; &#1084;&#1077;&#1085;&#1100;&#1096;&#1077;
&#1095;&#1077;&#1084;
&#1090;&#1088;&#1077;&#1073;&#1091;&#1077;&#1090;&#1089;&#1103;,
&#1087;&#1088;&#1077;&#1082;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1091;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;.
<p>&#1055;&#1086;&#1083;&#1103; <i>OutputBufferLength</i> &#1080; <i>InputBufferLength</i>
&#1074;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1086;&#1081; &#1074;
IO_STACK_LOCATION
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099; DeviceIoControl
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1090;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1084; <i>nOutBufferSize</i>
&#1080; <i>nInBufferSize</i> &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
DeviceIoControl.
<p><code><!--mstheme--></font>
<pre>             mov edi, [esi].AssociatedIrp.SystemBuffer

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1048;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;. &#1058;.&#1082;., &#1074;
&#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1080;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1103;&#1102;&#1097;&#1077;&#1075;&#1086;
&#1082;&#1086;&#1076;&#1072; &#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1084;&#1099; &#1091;&#1082;&#1072;&#1079;&#1072;&#1083;&#1080; &#1074;
&#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077;
&#1074;&#1080;&#1076;&#1072;
&#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; METHOD_BUFFERED,
&#1090;&#1086; &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1091;&#1103; IRP
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1090; &#1074;
&#1085;&#1077;&#1087;&#1086;&#1076;&#1082;&#1072;&#1095;&#1080;&#1074;&#1072;&#1077;&#1084;&#1086;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1084;
&#1087;&#1091;&#1083;&#1077; &#1073;&#1083;&#1086;&#1082;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;,
&#1088;&#1072;&#1074;&#1085;&#1099;&#1081; &#1087;&#1086;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1091;
&#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1100;&#1096;&#1077;&#1084;&#1091;
&#1080;&#1079; &#1073;&#1091;&#1092;&#1077;&#1088;&#1086;&#1074;.
&#1050;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090;
&#1090;&#1091;&#1076;&#1072;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1077;
&#1074;&#1093;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;, &#1072;&#1076;&#1088;&#1077;&#1089;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077; <i>lpInBuffer</i>
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl. &#1042;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1101;&#1090;&#1086;&#1090; &#1073;&#1091;&#1092;&#1077;&#1088;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1090;
&#1095;&#1077;&#1090;&#1099;&#1088;&#1077;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
&#1087;&#1086;&#1076;&#1083;&#1077;&#1078;&#1072;&#1097;&#1080;&#1093;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1080;.
<p><code><!--mstheme--></font>
<pre>             assume edi:ptr DWORD

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;.&#1082;. &#1072;&#1076;&#1088;&#1077;&#1089;
&#1080;&#1084;&#1077;&#1077;&#1090; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1076;&#1074;&#1086;&#1081;&#1085;&#1086;&#1075;&#1086;
&#1089;&#1083;&#1086;&#1074;&#1072;, &#1076;&#1072;&#1077;&#1084;
&#1087;&#1086;&#1085;&#1103;&#1090;&#1100;
&#1082;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1090;&#1086;&#1088;&#1091;,
&#1095;&#1090;&#1086; &#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088; edi
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090; &#1085;&#1072;
&#1103;&#1095;&#1077;&#1081;&#1082;&#1091;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1086;&#1084; DWORD.
<p><code><!--mstheme--></font>
<pre>             xor ebx, ebx
             .while ebx &lt; NUM_DATA_ENTRY

                 invoke GetPhysicalAddress, [edi][ebx*(sizeof DWORD)]

                 mov [edi][ebx*(sizeof DWORD)], eax
                 inc ebx
             .endw

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042; &#1094;&#1080;&#1082;&#1083;&#1077;,
&#1087;&#1086;&#1074;&#1090;&#1086;&#1088;&#1103;&#1102;&#1097;&#1077;&#1084;&#1089;&#1103;
NUM_DATA_ENTRY &#1088;&#1072;&#1079;,
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1084; &#1080;&#1079;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086;
&#1073;&#1091;&#1092;&#1077;&#1088;&#1072;
&#1087;&#1086;&#1076;&#1083;&#1077;&#1078;&#1072;&#1097;&#1080;&#1081;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1080;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089;, &#1080;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1084; &#1077;&#1075;&#1086;
&#1074; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; GetPhysicalAddress
&#1101;&#1090;&#1091; &#1089;&#1072;&#1084;&#1091;&#1102;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1102;
&#1086;&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1083;&#1103;&#1102;&#1097;&#1091;&#1102;.
<p>&#1055;&#1086;&#1083;&#1091;&#1095;&#1080;&#1074;
&#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;,
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1077;&#1075;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1085;&#1086; &#1074;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1099;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;, &#1085;&#1072; &#1090;&#1086;
&#1078;&#1077; &#1089;&#1072;&#1084;&#1086;&#1077;
&#1084;&#1077;&#1089;&#1090;&#1086;.
<p><code><!--mstheme--></font>
<pre>             mov dwBytesReturned, DATA_SIZE
             mov status, STATUS_SUCCESS

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; &#1084;&#1099;
&#1076;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;&#1089;&#1100; &#1076;&#1086;
&#1101;&#1090;&#1086;&#1081; &#1090;&#1086;&#1095;&#1082;&#1080;, &#1090;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1079;&#1072;&#1082;&#1086;&#1085;&#1095;&#1077;&#1085;&#1072;.
&#1055;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1074;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1077; <i>dwBytesReturned</i>
&#1080; <i>status</i>
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;.
<p><code><!--mstheme--></font>
<pre>         .else
             mov status, STATUS_BUFFER_TOO_SMALL
         .endif
     .else
         mov status, STATUS_INVALID_DEVICE_REQUEST
     .endif

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1089;&#1093;&#1086;&#1076;&#1080;&#1090;
&#1082;&#1072;&#1082;&#1072;&#1103;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103; <i>status</i>
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1090;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1082;&#1086;&#1076; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080;.
<p><code><!--mstheme--></font>
<pre>     assume edi:nothing

     push status
     pop [esi].IoStatus.Status

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1072;&#1103;
&#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1102;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084; &#1074;
&#1087;&#1086;&#1083;&#1077; <i>Status</i> &#1073;&#1083;&#1086;&#1082;&#1072;
&#1089;&#1090;&#1072;&#1090;&#1091;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; <i>status</i>.
&#1053;&#1072; &#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1101;&#1090;&#1086;&#1090; &#1082;&#1086;&#1076;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1082;&#1086;&#1076; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;,
&#1074;&#1099;&#1079;&#1074;&#1072;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; GetLastError.
&#1058;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1103;
&#1087;&#1088;&#1086;&#1080;&#1089;&#1093;&#1086;&#1076;&#1080;&#1090;,
&#1077;&#1089;&#1090;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;,
&#1085;&#1077; &#1086;&#1076;&#1080;&#1085; &#1082;
&#1086;&#1076;&#1085;&#1086;&#1084;&#1091;, &#1090;.&#1082;. &#1074;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;&#1093;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1080; &#1103;&#1076;&#1088;&#1072; &#1088;&#1072;&#1079;&#1085;&#1099;&#1077;
&#1085;&#1072;&#1073;&#1086;&#1088;&#1099; &#1082;&#1086;&#1076;&#1086;&#1074;
&#1086;&#1096;&#1080;&#1073;&#1086;&#1082;.
<p><code><!--mstheme--></font>
<pre>     push dwBytesReturned
     pop [esi].IoStatus.Information

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042; &#1087;&#1086;&#1083;&#1077; <i>Information</i>
&#1073;&#1083;&#1086;&#1082;&#1072;
&#1089;&#1090;&#1072;&#1090;&#1091;&#1089;&#1072;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1072;&#1077;&#1084;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1077;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; <i>dwBytesReturned</i>.
&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1072;&#1103; IRP,
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1090; &#1080;&#1079;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1087;&#1086;&#1083;&#1103;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072;
&#1073;&#1072;&#1081;&#1090;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
&#1086;&#1085; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1080;&#1079;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086; &#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;
&#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1077; <i>lpOutBuffer</i>
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl &#1085;&#1072;
&#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;.
&#1069;&#1090;&#1086; &#1078;&#1077;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;
&#1074;&#1077;&#1088;&#1085;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1086;&#1076;&#1091; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1074; &#1076;&#1074;&#1086;&#1081;&#1085;&#1086;&#1084;
&#1089;&#1083;&#1086;&#1074;&#1077;,
&#1091;&#1082;&#1072;&#1079;&#1072;&#1090;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077;
&#1087;&#1086;&#1084;&#1077;&#1097;&#1077;&#1085; &#1074;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088; <i>lpBytesReturned</i>
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; DeviceIoControl.
<p>&#1045;&#1089;&#1083;&#1080;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1086;&#1081;&#1076;&#1077;&#1090;
&#1082;&#1072;&#1082;&#1072;&#1103;-&#1083;&#1080;&#1073;&#1086;
&#1086;&#1096;&#1080;&#1073;&#1082;&#1072;, &#1090;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103; <i>dwBytesReturned</i>
&#1091; &#1085;&#1072;&#1089;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1072;
&#1085;&#1091;&#1083;&#1077;&#1074;&#1099;&#1084;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;.
&#1045;&#1089;&#1083;&#1080; &#1078;&#1077; &#1074;&#1089;&#1077;
&#1087;&#1086;&#1081;&#1076;&#1077;&#1090; &#1087;&#1086;
&#1087;&#1083;&#1072;&#1085;&#1091;, &#1090;&#1086; &#1074;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; <i>dwBytesReturned</i>
&#1086;&#1082;&#1072;&#1078;&#1077;&#1090;&#1089;&#1103;
&#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; DATA_SIZE.
&#1048;&#1084;&#1077;&#1085;&#1085;&#1086; &#1101;&#1090;&#1086;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1073;&#1072;&#1081;&#1090;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1080; &#1089;&#1082;&#1086;&#1087;&#1080;&#1088;&#1091;&#1077;&#1090; &#1074;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1081;
&#1073;&#1091;&#1092;&#1077;&#1088;.
<p><code><!--mstheme--></font>
<pre>     assume esi:nothing

     fastcall IofCompleteRequest, pIrp, IO_NO_INCREMENT

     mov eax, status
     ret

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1044;&#1072;&#1077;&#1084;
&#1091;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1077;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1091;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1080;&#1090;&#1100;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1091; IPR &#1080;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084;
&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1077;
&#1090;&#1077;&#1082;&#1091;&#1097;&#1080;&#1081; &#1082;&#1086;&#1076;
&#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1103;.<br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1080;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074;</strong>
<p>&#1050;&#1086;&#1076; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1103;&#1076;&#1088;&#1072;, &#1074;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1080;&#1077; &#1086;&#1090;
&#1082;&#1086;&#1076;&#1072; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;,
&#1084;&#1086;&#1078;&#1077;&#1090;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072; &#1074;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1077; &#1080;
&#1085;&#1072;&#1086;&#1073;&#1086;&#1088;&#1086;&#1090;. &#1044;&#1083;&#1103;
&#1101;&#1090;&#1086;&#1075;&#1086;
&#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;
&#1076;&#1086;&#1089;&#1090;&#1091;&#1087; &#1082; <i>&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1091;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page directory) &#1080;
&#1089;&#1072;&#1084;&#1080;&#1084; <i>&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page tables). &#1042;
Windows NT &#1076;&#1083;&#1103; x86-&#1089;&#1080;&#1089;&#1090;&#1077;&#1084;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
&#1088;&#1072;&#1089;&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;
&#1087;&#1086;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1086;&#1084;&#1091;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1091; 0C0300000h (&#1088;&#1077;&#1078;&#1080;&#1084;
&#1087;&#1088;&#1086;&#1077;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080; Physical Address Extension
&#1084;&#1099; &#1085;&#1077;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1077;&#1084;),
&#1072; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
&#1085;&#1072;&#1095;&#1080;&#1085;&#1072;&#1102;&#1090;&#1089;&#1103; &#1089;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072; 0C0000000h.
<p>&#1071; &#1085;&#1077; &#1073;&#1091;&#1076;&#1091;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1077;&#1086;&#1088;&#1080;&#1102;
&#1084;&#1077;&#1093;&#1072;&#1085;&#1080;&#1079;&#1084;&#1072;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1080;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074; -
&#1086;&#1095;&#1077;&#1085;&#1100;
&#1087;&#1086;&#1076;&#1088;&#1086;&#1073;&#1085;&#1086; &#1086;&#1073;
&#1101;&#1090;&#1086;&#1084; &#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1074;
&#1088;&#1077;&#1082;&#1086;&#1084;&#1077;&#1085;&#1076;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1081;
&#1074; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081;
&#1095;&#1072;&#1089;&#1090;&#1080; &#1089;&#1090;&#1072;&#1090;&#1100;&#1080;
&#1083;&#1080;&#1090;&#1077;&#1088;&#1072;&#1090;&#1091;&#1088;&#1077;
&#1080;&#1083;&#1080; &#1085;&#1072;&#1081;&#1090;&#1080; &#1074;
&#1089;&#1077;&#1090;&#1080;.
<p>&#1071;
&#1087;&#1088;&#1077;&#1076;&#1087;&#1086;&#1083;&#1072;&#1075;&#1072;&#1083;,
&#1095;&#1090;&#1086; &#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1072;&#1083;
&#1073;&#1091;&#1076;&#1091;&#1090; &#1095;&#1080;&#1090;&#1072;&#1090;&#1100;
&#1083;&#1102;&#1076;&#1080; &#1089; &#1088;&#1072;&#1079;&#1085;&#1086;&#1081;
&#1087;&#1086;&#1076;&#1075;&#1086;&#1090;&#1086;&#1074;&#1082;&#1086;&#1081;.
&#1045;&#1089;&#1083;&#1080; &#1074;&#1099;
&#1074;&#1087;&#1077;&#1088;&#1074;&#1099;&#1077;
&#1091;&#1089;&#1083;&#1099;&#1096;&#1072;&#1083;&#1080; &#1086;&#1073;
&#1101;&#1090;&#1080;&#1093;
&#1087;&#1086;&#1085;&#1103;&#1090;&#1080;&#1103;&#1093;,
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1088;&#1086;&#1087;&#1091;&#1089;&#1090;&#1080;&#1090;&#1100;
&#1101;&#1090;&#1086;&#1090; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;. &#1040;
&#1095;&#1090;&#1086;&#1073;&#1099; &#1074;&#1072;&#1084;
&#1073;&#1099;&#1083;&#1086; &#1085;&#1077; &#1090;&#1072;&#1082;
&#1086;&#1073;&#1080;&#1076;&#1085;&#1086;,
&#1091;&#1076;&#1072;&#1083;&#1080;&#1090;&#1077; &#1082;&#1086;&#1076;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
GetPhysicalAddress, &#1072; &#1077;&#1077; &#1074;&#1099;&#1079;&#1086;&#1074;
&#1079;&#1072;&#1084;&#1077;&#1085;&#1080;&#1090;&#1077; &#1085;&#1072;
&#1074;&#1099;&#1079;&#1086;&#1074;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1103;&#1076;&#1088;&#1072;
MmGetPhysicalAddress. &#1058;&#1072;&#1082;&#1080;&#1084;
&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; MmGetPhysicalAddress
&#1087;&#1088;&#1077;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074; &quot;&#1095;&#1077;&#1088;&#1085;&#1099;&#1081;
&#1103;&#1097;&#1080;&#1082;&quot;, &#1085;&#1072; &#1074;&#1093;&#1086;&#1076;
&#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1075;&#1086;
&#1087;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072;&#1077;&#1090;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089;, &#1072; &#1085;&#1072;
&#1074;&#1099;&#1093;&#1086;&#1076;&#1077; &#1074;&#1099;
&#1080;&#1084;&#1077;&#1077;&#1090;&#1077;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1081;
&#1077;&#1084;&#1091;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081;.
<p>&#1042;&#1099;&#1096;&#1077;&#1091;&#1087;&#1086;&#1084;&#1103;&#1085;&#1091;&#1090;&#1099;&#1077;
&#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;&#1099;
&#1080;&#1085;&#1076;&#1080;&#1074;&#1080;&#1076;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;
&#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;. &#1058;.&#1082;.
&#1087;&#1088;&#1080;
&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1077;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072; &#1090;&#1080;&#1087;&#1072;
IRP_MJ_DEVICE_CONTROL &#1084;&#1099;
&#1085;&#1072;&#1093;&#1086;&#1076;&#1080;&#1084;&#1089;&#1103; &#1074;
&#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1077;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1080;&#1088;&#1086;&#1074;&#1072;&#1074;&#1096;&#1077;&#1075;&#1086;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;, &#1090;&#1086;
&#1085;&#1080;&#1082;&#1072;&#1082;&#1080;&#1093;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1081; &#1087;&#1086;
&#1087;&#1077;&#1088;&#1077;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1102;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1085;&#1086;&#1075;&#1086;
&#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;
&#1085;&#1072;&#1084; &#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1085;&#1091;&#1078;&#1085;&#1086;.
<p><code><!--mstheme--></font>
<pre>     mov eax, dwAddress
     mov ecx, eax

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1077;&#1084;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089; &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; ecx
&#1076;&#1083;&#1103;
&#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1077;&#1075;&#1086;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;.
<p><code><!--mstheme--></font>
<pre>     shr eax, 22

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084;
&#1089;&#1090;&#1072;&#1088;&#1096;&#1080;&#1077; 10 &#1073;&#1080;&#1090;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; <i>&#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1086;&#1084;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1072;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page directory index).
<p><code><!--mstheme--></font>
<pre>     shl eax, 2

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1059;&#1084;&#1085;&#1086;&#1078;&#1072;&#1077;&#1084;
&#1080;&#1085;&#1076;&#1077;&#1082;&#1089; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; <i>&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1072;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page directory entry, PDE),
&#1088;&#1072;&#1074;&#1085;&#1099;&#1081; 4
&#1073;&#1072;&#1081;&#1090;&#1072;&#1084;. &#1058;.&#1086;. &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; eax
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1089;&#1084;&#1077;&#1097;&#1077;&#1085;&#1080;&#1077;
&#1085;&#1091;&#1078;&#1085;&#1086;&#1075;&#1086; PDE &#1086;&#1090;
&#1085;&#1072;&#1095;&#1072;&#1083;&#1072;
&#1082;&#1072;&#1090;&#1072;&#1083;&#1086;&#1075;&#1072;.
<p><code><!--mstheme--></font>
<pre>     mov eax, [0C0300000h][eax]

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1048;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1084;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1077; PDE.
<p><code><!--mstheme--></font>
<pre>     .if ( eax &amp; (mask pde4kValid) )

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>12 &#1084;&#1083;&#1072;&#1076;&#1096;&#1080;&#1093; &#1073;&#1080;&#1090;
PDE (&#1089;&#1084;. &#1079;&#1072;&#1087;&#1080;&#1089;&#1100;
HARDWARE_PDE4K_X86 &#1074; \include\w2k\w2kundoc.inc)
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090;
&#1072;&#1090;&#1088;&#1080;&#1073;&#1091;&#1090;&#1099; PDE.
&#1045;&#1089;&#1083;&#1080; &#1092;&#1083;&#1072;&#1075; <i>Valid</i> (&#1073;&#1080;&#1090;
0) &#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;,
&#1090;&#1086; PDE
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1077;&#1085;.
<p><code><!--mstheme--></font>
<pre>         .if !( eax &amp; (mask pde4kLargePage) )

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1060;&#1083;&#1072;&#1075; <i>Large Page</i> (&#1073;&#1080;&#1090; 7)
&#1091;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;,
&#1095;&#1090;&#1086; PDE
&#1086;&#1090;&#1085;&#1086;&#1089;&#1080;&#1090;&#1089;&#1103; &#1082; 4-&#1084;&#1077;&#1075;&#1072;&#1073;&#1072;&#1081;&#1090;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; (&#1085;&#1072;
&#1076;&#1072;&#1085;&#1085;&#1099;&#1081;
&#1084;&#1086;&#1084;&#1077;&#1085;&#1090;, &#1090;&#1072;&#1082;&#1080;&#1077;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090;&#1089;&#1103;
&#1103;&#1076;&#1088;&#1086;&#1084; (&#1087;&#1086;
&#1082;&#1088;&#1072;&#1081;&#1085;&#1077;&#1081; &#1084;&#1077;&#1088;&#1077;
&#1074; Windows 2000 &#1101;&#1090;&#1086; &#1090;&#1072;&#1082;)
&#1076;&#1083;&#1103;
&#1087;&#1088;&#1086;&#1077;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
ntoskrnl.exe &#1080; hal.dll &#1074;
&#1076;&#1080;&#1072;&#1087;&#1072;&#1079;&#1086;&#1085;
&#1074;&#1080;&#1088;&#1090;&#1091;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074; 80000000h - 9FFFFFFFh).
&#1044;&#1083;&#1103; PDE
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1093;
4-&#1082;&#1080;&#1083;&#1086;&#1073;&#1072;&#1081;&#1090;&#1085;&#1099;&#1084;
&#1080; 4-&#1084;&#1077;&#1075;&#1072;&#1073;&#1072;&#1081;&#1090;&#1085;&#1099;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1084;
&#1090;&#1088;&#1072;&#1085;&#1089;&#1083;&#1103;&#1094;&#1080;&#1103;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103;.
<p><code><!--mstheme--></font>
<pre>             mov eax, ecx
             shr eax, 10
             and eax, 1111111111111111111100y

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; PDE
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
4-&#1082;&#1080;&#1083;&#1086;&#1073;&#1072;&#1081;&#1090;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077;,
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084;
&#1073;&#1080;&#1090;&#1099; 12-21,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
&#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; <i>&#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1086;&#1084;
&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page table index),
&#1086;&#1076;&#1085;&#1086;&#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;
&quot;&#1091;&#1084;&#1085;&#1086;&#1078;&#1072;&#1103;&quot;
&#1080;&#1085;&#1076;&#1077;&#1082;&#1089; &#1085;&#1072;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; <i>&#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072;
&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;</i> (page table entry, PTE)
&#1088;&#1072;&#1074;&#1085;&#1099;&#1081; 4
&#1073;&#1072;&#1081;&#1090;&#1072;&#1084;. &#1058;.&#1086;. &#1074;
&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1088;&#1077; eax
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1089;&#1084;&#1077;&#1097;&#1077;&#1085;&#1080;&#1077;
&#1085;&#1091;&#1078;&#1085;&#1086;&#1075;&#1086; PTE &#1086;&#1090;
&#1085;&#1072;&#1095;&#1072;&#1083;&#1072; &#1074;&#1089;&#1077;&#1075;&#1086;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;
&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;.
<p><code><!--mstheme--></font>
<pre>         add eax, 0C0000000h
         mov eax, [eax]

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1055;&#1088;&#1080;&#1073;&#1072;&#1074;&#1080;&#1074;
&#1073;&#1072;&#1079;&#1086;&#1074;&#1099;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089;
&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;
&#1090;&#1072;&#1073;&#1083;&#1080;&#1094;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;,
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1084; PTE.
<p><code><!--mstheme--></font>
<pre>         .if eax &amp; (mask pteValid)

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>12 &#1084;&#1083;&#1072;&#1076;&#1096;&#1080;&#1093; &#1073;&#1080;&#1090; P&#1058;E
(&#1089;&#1084;. &#1079;&#1072;&#1087;&#1080;&#1089;&#1100; HARDWARE_PTE_X86
&#1074; \include\w2k\w2kundoc.inc)
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090;
&#1072;&#1090;&#1088;&#1080;&#1073;&#1091;&#1090;&#1099; PTE.
&#1045;&#1089;&#1083;&#1080; &#1092;&#1083;&#1072;&#1075; <i>Valid</i> (&#1073;&#1080;&#1090;
0) &#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;,
&#1090;&#1086; PTE
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; &#1074;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1081;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;.
<p><code><!--mstheme--></font>
<pre>             and eax, mask ptePageFrameNumber

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; PTE
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1077;&#1085;,
&#1090;&#1086; &#1077;&#1075;&#1086;
&#1089;&#1090;&#1072;&#1088;&#1096;&#1080;&#1077; 20 &#1073;&#1080;&#1090;
&#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090; <i>&#1085;&#1086;&#1084;&#1077;&#1088;
&#1092;&#1088;&#1077;&#1081;&#1084;&#1072;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;</i> (page frame number,
PFN) &#1103;&#1074;&#1083;&#1103;&#1102;&#1097;&#1080;&#1081;&#1089;&#1103;
&#1085;&#1086;&#1084;&#1077;&#1088;&#1086;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099; &#1074;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1077;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1093;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1074;. &#1069;&#1090;&#1086;&#1081;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1086;&#1081; &#1084;&#1099;
&#1086;&#1076;&#1085;&#1080;&#1084; &#1084;&#1072;&#1093;&#1086;&#1084;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084; PFN &#1080; &quot;&#1091;&#1084;&#1085;&#1086;&#1078;&#1072;&#1077;&#1084;&quot;
&#1077;&#1075;&#1086; &#1085;&#1072; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099; (4&#1082;&#1073;)
&#1080; &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081;
&#1072;&#1076;&#1088;&#1077;&#1089;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;.
<p><code><!--mstheme--></font>
<pre>                 and ecx, 00000000000000000000111111111111y
                 add eax, ecx
             .else
                 xor eax, eax
             .endif

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084; &#1080;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084;
&#1072;&#1076;&#1088;&#1077;&#1089; &#1073;&#1072;&#1081;&#1090;&#1072; &#1074;
&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1072;&#1093;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;. &#1042;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1101;&#1090;&#1086;&#1075;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; &#1080;
&#1085;&#1077; &#1076;&#1077;&#1083;&#1072;&#1090;&#1100;, &#1090;.&#1082;
&#1073;&#1072;&#1079;&#1086;&#1074;&#1099;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
&#1084;&#1086;&#1076;&#1091;&#1083;&#1077;&#1081;,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1099; &#1080;
&#1093;&#1086;&#1090;&#1080;&#1084;
&#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;,
&#1085;&#1077; &#1084;&#1086;&#1075;&#1091;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1085;&#1077; &#1082;&#1088;&#1072;&#1090;&#1085;&#1099;
&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1091;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;.
<p><code><!--mstheme--></font>
<pre>         .else
             and eax, mask pde4mPageFrameNumber

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1045;&#1089;&#1083;&#1080; PDE
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
4-&#1084;&#1077;&#1075;&#1072;&#1073;&#1072;&#1081;&#1090;&#1085;&#1086;&#1081;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; (&#1089;&#1084;.
&#1079;&#1072;&#1087;&#1080;&#1089;&#1100; HARDWARE_PDE4M_X86 &#1074; \include\w2k\w2kundoc.inc),
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084;
&#1073;&#1080;&#1090;&#1099; 22-31,
&#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1103; PFN,
&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081;, &#1074;
&#1089;&#1083;&#1091;&#1095;&#1072;&#1077;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1093;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;, &#1080;
&#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103;
&#1092;&#1080;&#1079;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1084;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1086;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;.
<p><code><!--mstheme--></font>
<pre>             and ecx, 00000000001111111111111111111111y
             add eax, ecx
         .endif
     .else
         xor eax, eax
     .endif

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1099;&#1076;&#1077;&#1083;&#1103;&#1077;&#1084; &#1080;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084;
&#1072;&#1076;&#1088;&#1077;&#1089; &#1073;&#1072;&#1081;&#1090;&#1072; &#1074;
&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1072;&#1093;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099;.
&#1054;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1091;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1093;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094; &#1103;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1083; &#1076;&#1083;&#1103;
&#1087;&#1086;&#1083;&#1085;&#1086;&#1090;&#1099;. &#1042;
&#1085;&#1072;&#1096;&#1077;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077;,
&#1074;&#1089;&#1077; &#1095;&#1077;&#1090;&#1099;&#1088;&#1077;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072;
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1090;
4-&#1082;&#1080;&#1083;&#1086;&#1073;&#1072;&#1081;&#1090;&#1085;&#1099;&#1084;
&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1072;&#1084;.
<p>&#1045;&#1089;&#1083;&#1080; &#1095;&#1090;&#1086;-&#1090;&#1086;
&#1085;&#1077; &#1090;&#1072;&#1082;
&#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1084; 0.
&#1053;&#1072; &#1089;&#1090;&#1086;&#1088;&#1086;&#1085;&#1077;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1085;&#1072;&#1076;&#1086; &#1073;&#1099; &#1077;&#1097;&#1077;
&#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1080;&#1090;&#1100;, &#1085;&#1077;
&#1074;&#1077;&#1088;&#1085;&#1091;&#1083; &#1083;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1074;&#1084;&#1077;&#1089;&#1090;&#1086;
&#1082;&#1072;&#1082;&#1086;&#1075;&#1086;-&#1085;&#1080;&#1073;&#1091;&#1076;&#1100;
&#1072;&#1076;&#1088;&#1077;&#1089;&#1072; 0. &#1053;&#1086;,
&#1076;&#1083;&#1103; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1090;&#1099;,
&#1103; &#1101;&#1090;&#1086;&#1075;&#1086;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1089;&#1090;&#1072;&#1083;.
<p>&#1056;&#1072;&#1073;&#1086;&#1090;&#1072; &#1089;
&#1079;&#1072;&#1087;&#1080;&#1089;&#1103;&#1084;&#1080; &#1085;&#1077;
&#1095;&#1072;&#1089;&#1090;&#1086;
&#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1074; &#1087;&#1088;&#1072;&#1082;&#1090;&#1080;&#1082;&#1077;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1085;&#1072;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1077;.
&#1045;&#1089;&#1083;&#1080; &#1085;&#1077;
&#1079;&#1085;&#1072;&#1082;&#1086;&#1084;&#1099; &#1089;
&#1076;&#1080;&#1088;&#1077;&#1082;&#1090;&#1080;&#1074;&#1086;&#1081; mask,
&#1090;&#1086; &#1074;&#1084;&#1077;&#1089;&#1090;&#1086;
<p><code><!--mstheme--></font>
<pre> mask pde4kValid
 mask pde4kLargePage
 mask pteValid
 mask ptePageFrameNumber
 mask pde4mPageFrameNumber

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1081;&#1090;&#1077;
<p><code><!--mstheme--></font>
<pre> 01y
 010000000y
 01y
 11111111111111111111000000000000y
 11111111110000000000000000000000y

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code><br>
<br>
<br>
<p><strong>&#1055;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;</strong>
<p>&#1044;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;
&#1074;&#1099;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091; DriverUnload,
&#1082;&#1086;&#1075;&#1076;&#1072; &#1082;&#1086;&#1076;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1079;&#1072;&#1082;&#1088;&#1099;&#1074;&#1072;&#1077;&#1090;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;,
&#1090;&#1086;&#1095;&#1085;&#1077;&#1077;,
&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1080;&#1081;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;, &#1090;.&#1082;.
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1086;&#1090;&#1082;&#1088;&#1099;&#1090;&#1086;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;,
&#1080;&#1083;&#1080;
&#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1080;&#1084;&#1080;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;&#1084;&#1080;.
&#1045;&#1089;&#1083;&#1080; &#1078;&#1077;
&#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;
&#1093;&#1086;&#1090;&#1103; &#1073;&#1099; &#1086;&#1076;&#1080;&#1085;
&#1086;&#1087;&#1080;&#1089;&#1072;&#1090;&#1077;&#1083;&#1100;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;,
&#1090;&#1086; &#1082; &#1085;&#1077;&#1084;&#1091; (&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1091;)
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1086;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1100;&#1089;&#1103;, &#1072;
&#1101;&#1090;&#1086; &#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1090;
&#1082; &#1087;&#1086;&#1089;&#1099;&#1083;&#1082;&#1077; &#1077;&#1075;&#1086;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1091; IRP, &#1090;.&#1077;.
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1073;&#1099;&#1090;&#1100;
&#1079;&#1099;&#1075;&#1088;&#1091;&#1078;&#1077;&#1085;.
<p><code><!--mstheme--></font>
<pre>     invoke IoDeleteSymbolicLink, addr g_usSymbolicLinkName

     mov eax, pDriverObject
     invoke IoDeleteDevice, (DRIVER_OBJECT PTR [eax]).DeviceObject

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1091;&#1090; &#1082;&#1086;&#1076;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1090; &#1089;&#1072;&#1084;
&#1079;&#1072; &#1089;&#1077;&#1073;&#1103;. &#1042;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
&#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1084;&#1099;
&#1076;&#1086;&#1083;&#1078;&#1085;&#1099;
&#1087;&#1088;&#1086;&#1080;&#1079;&#1074;&#1077;&#1089;&#1090;&#1080;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;
&#1087;&#1088;&#1103;&#1084;&#1086;
&#1087;&#1088;&#1086;&#1090;&#1080;&#1074;&#1086;&#1087;&#1086;&#1083;&#1086;&#1078;&#1085;&#1099;&#1077;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1103;&#1084; &#1074;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1077;
&#1080;&#1085;&#1080;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;,
&#1090;.&#1077;. &#1091;&#1076;&#1072;&#1083;&#1080;&#1090;&#1100;
&#1074;&#1089;&#1077;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1085;&#1072;&#1084;&#1080; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099;.
&#1050;&#1072;&#1082; &#1103; &#1091;&#1078;&#1077;
&#1075;&#1086;&#1074;&#1086;&#1088;&#1080;&#1083; &#1074;&#1099;&#1096;&#1077;,
&#1074; &#1088;&#1077;&#1078;&#1080;&#1084;&#1077; &#1103;&#1076;&#1088;&#1072;
&#1085;&#1080;&#1082;&#1090;&#1086; &#1079;&#1072; &#1085;&#1072;&#1089;
&#1087;&#1086;&#1076;&#1090;&#1080;&#1088;&#1072;&#1090;&#1100; &#1085;&#1077;
&#1073;&#1091;&#1076;&#1077;&#1090;.
<p>&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 5-1
&#1087;&#1086;&#1076;&#1099;&#1090;&#1086;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090;
&#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1085;&#1099;&#1081;
&#1084;&#1072;&#1090;&#1077;&#1088;&#1080;&#1072;&#1083;. &#1042;
&#1085;&#1077;&#1081; &#1087;&#1086;&#1082;&#1072;&#1079;&#1072;&#1085;&#1086;,
&#1082; &#1074;&#1099;&#1079;&#1086;&#1074;&#1091;
&#1082;&#1072;&#1082;&#1080;&#1093;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088; &#1074;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1077;
&#1087;&#1088;&#1080;&#1074;&#1086;&#1076;&#1080;&#1090;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1077;&#1085;&#1080;&#1077;
&#1082;&#1086;&#1076;&#1072; &#1088;&#1077;&#1078;&#1080;&#1084;&#1072;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1082; &#1090;&#1086;&#1081; &#1080;&#1083;&#1080; &#1080;&#1085;&#1086;&#1081;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;
&#1074;&#1074;&#1086;&#1076;&#1072;-&#1074;&#1099;&#1074;&#1086;&#1076;&#1072;,
&#1089; &#1091;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1077;&#1084;
&#1082;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;&#1072; &#1080;
&#1091;&#1088;&#1086;&#1074;&#1085;&#1103;
&#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103;.<center>
<p><b>&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 5-1.</b>
&#1057;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1080;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1089;&#1082;&#1080;&#1093;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;
&#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1072;&#1084;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;</center><br>
<!--mstheme--></font>
<table align="center" border="1" bordercolorlight="#CCCCCC" bordercolordark="#666666">
  <tbody>
    <tr align="middle" bgColor="#cccccc">
      <td vAlign="center"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><b><font size="-2">&#1056;&#1077;&#1078;&#1080;&#1084;
        &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;</font></b></p>
        <!--mstheme--></font></td>
      <td vAlign="center"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><b><font size="-2">&#1056;&#1077;&#1078;&#1080;&#1084;
        &#1103;&#1076;&#1088;&#1072;</font></b></p>
        <!--mstheme--></font></td>
      <td vAlign="center"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><b><font size="-2">&#1050;&#1086;&#1085;&#1090;&#1077;&#1082;&#1089;&#1090;</font></b></p>
        <!--mstheme--></font></td>
      <td vAlign="center"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><b><font size="-2">IRQL</font></b></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">StartService</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">DriverEntry</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1055;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
        System</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">CreateFile</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">IRP_MJ_CREATE</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">DeviceIoControl</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">IRP_MJ_DEVICE_CONTROL</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">ReadFile</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">IRP_MJ_READ</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">WriteFile</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">IRP_MJ_WRITE</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">CloseHandle</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">IRP_MJ_CLEANUP, IRP_MJ_CLOSE</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1042;&#1099;&#1079;&#1099;&#1074;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="240"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">ControlService,,SERVICE_CONTROL_STOP</font></p>
        <!--mstheme--></font></td>
      <td width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">DriverUnload</font></p>
        <!--mstheme--></font></td>
      <td width="140"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">&#1055;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1072;
        System</font></p>
        <!--mstheme--></font></td>
      <td width="90"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p><font size="-2">PASSIVE_LEVEL</font></p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica"><br>
<br>
<br>
<p><strong>&#1050;&#1086;&#1084;&#1087;&#1080;&#1083;&#1103;&#1094;&#1080;&#1103;</strong>
<p><code><!--mstheme--></font>
<pre> :make

 set drv=skeleton

 \masm32\bin\ml /nologo /c /coff %drv%.bat
 \masm32\bin\link /nologo /driver /base:0x10000 /align:32 /out:%drv%.sys /subsystem:native /ignore:4078 %drv%.obj rsrc.obj

 del %drv%.obj
 move %drv%.sys <b>..</b>

 echo.
 pause

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1042;&#1089;&#1077; &#1101;&#1090;&#1086; &#1084;&#1099; &#1089;
&#1074;&#1072;&#1084;&#1080; &#1091;&#1078;&#1077;
&#1088;&#1072;&#1079;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080; &#1074;
&#1095;&#1072;&#1089;&#1090;&#1080; 3. &#1071;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1083; &#1082;&#1083;&#1102;&#1095;
/ignore:4078, &#1090;.&#1082;. &#1080;&#1079;-&#1079;&#1072;
&#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086; &#1091;
&#1085;&#1072;&#1089;
&#1087;&#1086;&#1103;&#1074;&#1080;&#1083;&#1072;&#1089;&#1100;
&#1074;&#1090;&#1086;&#1088;&#1072;&#1103;
&#1089;&#1077;&#1082;&#1094;&#1080;&#1103; &#1082;&#1086;&#1076;&#1072; &quot;INIT&quot;
&#1089;
&#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1102;&#1097;&#1080;&#1084;&#1080;&#1089;&#1103;
&#1072;&#1090;&#1088;&#1080;&#1073;&#1091;&#1090;&#1072;&#1084;&#1080;
&#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1097;&#1080;&#1082;
&#1074;&#1099;&#1076;&#1072;&#1077;&#1090;
&#1087;&#1088;&#1077;&#1076;&#1091;&#1087;&#1088;&#1077;&#1078;&#1076;&#1077;&#1085;&#1080;&#1077;:
<p><code><!--mstheme--></font>
<pre> LINK : warning LNK4078: multiple &quot;INIT&quot; sections found with different attributes (E2000020)

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1072;&#1082;&#1078;&#1077; &#1103;
&#1076;&#1086;&#1073;&#1072;&#1074;&#1080;&#1083;
&#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1082;&#1091;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;
&#1086;&#1082;&#1088;&#1091;&#1078;&#1077;&#1085;&#1080;&#1103; <i>drv</i>,
&#1095;&#1090;&#1086;&#1073;&#1099; &#1085;&#1077;
&#1084;&#1077;&#1085;&#1103;&#1090;&#1100; &#1074;
&#1095;&#1077;&#1090;&#1099;&#1088;&#1077;&#1093;
&#1084;&#1077;&#1089;&#1090;&#1072;&#1093; &#1080;&#1084;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.<br>
<br>
<br>
<p><strong>&#1044;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1099;</strong>
<p>&#1050;&#1072;&#1078;&#1076;&#1099;&#1081;
&#1091;&#1074;&#1072;&#1078;&#1072;&#1102;&#1097;&#1080;&#1081;
&#1089;&#1074;&#1086;&#1077;&#1075;&#1086;
&#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1077;&#1083;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;
&#1076;&#1086;&#1083;&#1078;&#1077;&#1085;
&#1089;&#1086;&#1086;&#1073;&#1097;&#1072;&#1090;&#1100; &#1077;&#1075;&#1086;
&#1080;&#1084;&#1103;, &#1072; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1082;&#1086;&#1077;-&#1082;&#1072;&#1082;&#1080;&#1077;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1077;
&#1089;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1103; &#1086;
&#1089;&#1077;&#1073;&#1077;. &#1069;&#1090;&#1086;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;
&#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1092;&#1072;&#1081;&#1083;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1086;&#1074; (&#1089;&#1084;.
rsrc.rc).
<p><code><!--mstheme--></font>
<pre>VS_VERSION_INFO VERSIONINFO
 FILEVERSION 1,0,0,0
 PRODUCTVERSION 1,0,0,0
 FILEFLAGSMASK 0x3fL
 FILEFLAGS 0x0L
 FILEOS 0x40004L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK &quot;StringFileInfo&quot;
    BEGIN
        BLOCK &quot;040904E4&quot;
        BEGIN
            VALUE &quot;Comments&quot;, &quot;Written by Four-F\0&quot;
            VALUE &quot;CompanyName&quot;, &quot;Four-F Software\0&quot;
            VALUE &quot;FileDescription&quot;, &quot;Kernel-Mode Driver VirtToPhys v1.00\0&quot;
            VALUE &quot;FileVersion&quot;, &quot;1, 0, 0, 0\0&quot;
            VALUE &quot;InternalName&quot;, &quot;VirtualToPhysical\0&quot;
            VALUE &quot;LegalCopyright&quot;, &quot;Copyright  2003, Four-F\0&quot;
            VALUE &quot;OriginalFilename&quot;, &quot;VirtToPhys.sys\0&quot;
            VALUE &quot;ProductName&quot;, &quot;Kernel-Mode Driver Virtual To Physical Address Converter\0&quot;
            VALUE &quot;ProductVersion&quot;, &quot;1, 0, 0, 0\0&quot;
        END
    END
    BLOCK &quot;VarFileInfo&quot;
    BEGIN
        VALUE &quot;Translation&quot;, 0x409, 1200
    END
END

</pre>
<!--mstheme--><font face="Arial, Arial, Helvetica"></code>
<p>&#1058;&#1091;&#1090; &#1085;&#1080;&#1095;&#1077;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087;&#1080;&#1072;&#1083;&#1100;&#1085;&#1086;
&#1085;&#1086;&#1074;&#1086;&#1075;&#1086;.
&#1057;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1099;&#1081;
&#1088;&#1077;&#1089;&#1091;&#1088;&#1089;&#1085;&#1099;&#1081;
&#1089;&#1082;&#1088;&#1080;&#1087;&#1090;.
&#1050;&#1086;&#1084;&#1087;&#1080;&#1083;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1080; &#1083;&#1080;&#1085;&#1082;&#1091;&#1077;&#1090;&#1089;&#1103;
&#1082;&#1072;&#1082; &#1086;&#1073;&#1099;&#1095;&#1085;&#1086;. &#1042;
&#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;&#1093;
&#1092;&#1072;&#1081;&#1083;&#1072;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
&#1084;&#1086;&#1078;&#1085;&#1086;
&#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100;
&#1095;&#1090;&#1086;
&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1083;&#1086;&#1089;&#1100;.<br>
<br>
<br>
<p><strong>&#1045;&#1097;&#1077;
&#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086; &#1086;&#1073;
&#1086;&#1090;&#1083;&#1072;&#1076;&#1082;&#1077;</strong>
<p>&#1042;&#1099;&#1090;&#1072;&#1097;&#1080;&#1090;&#1100;
&#1074;&#1089;&#1102; (&#1080;&#1083;&#1080; &#1087;&#1086;&#1095;&#1090;&#1080;
&#1074;&#1089;&#1102;) &quot;&#1087;&#1086;&#1076;&#1085;&#1086;&#1075;&#1086;&#1090;&#1085;&#1091;&#1102;&quot;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074; &quot;&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&quot;
&#1080; &quot;&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1086;&quot;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076; <b>driver &lt;&#1080;&#1084;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;&gt;</b> &#1080; <b>device
&lt;&#1080;&#1084;&#1103;
&#1091;&#1089;&#1090;&#1088;&#1086;&#1081;&#1089;&#1090;&#1074;&#1072;&gt;</b>
&#1086;&#1090;&#1083;&#1072;&#1076;&#1095;&#1080;&#1082;&#1072; SoftICE.
&#1042;&#1086;&#1090; &#1082;&#1072;&#1082; &#1101;&#1090;&#1086;
&#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1080;&#1090; &#1085;&#1072;
&#1084;&#1086;&#1077;&#1081; &#1084;&#1072;&#1096;&#1080;&#1085;&#1077;:
<p align="center"><!-- &#1047;&#1076;&#1077;&#1089;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1082;&#1072;&#1088;&#1090;&#1080;&#1085;&#1082;&#1072; -->
<img src="kmd5-2.gif" width="652" height="228"><center>
<p><b>&#1056;&#1080;&#1089;. 5-2.</b>
&#1056;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; <i>driver VirtToPhys</i></center>
<p align="center"><!-- &#1047;&#1076;&#1077;&#1089;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1082;&#1072;&#1088;&#1090;&#1080;&#1085;&#1082;&#1072; -->
<img src="kmd5-3.gif" width="652" height="408"><center>
<p><b>&#1056;&#1080;&#1089;. 5-3.</b>
&#1056;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;
&#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1082;&#1086;&#1084;&#1072;&#1085;&#1076;&#1099; <i>device devVirtToPhys</i></center>
<p>&#1050;&#1072;&#1082; &#1074;&#1099;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;&#1077;,
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103;
&#1086;&#1090;&#1086;&#1073;&#1088;&#1072;&#1078;&#1072;&#1077;&#1084;&#1072;&#1103;
SoftICE, &#1074; &#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1086;&#1084;,
&#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1077;&#1090;&#1089;&#1103;
&#1080;&#1079; &#1089;&#1090;&#1088;&#1091;&#1082;&#1090;&#1091;&#1088;
DRIVER_OBJECT &#1080; DEVICE_OBJECT
&#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;.
&#1048;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1103;
&#1101;&#1090;&#1091;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102;
&#1084;&#1086;&#1078;&#1085;&#1086; &#1083;&#1077;&#1075;&#1082;&#1086;
&#1085;&#1072;&#1081;&#1090;&#1080; &#1101;&#1090;&#1080;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; &#1074;
&#1087;&#1072;&#1084;&#1103;&#1090;&#1080;,
&#1087;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100;
&#1090;&#1086;&#1095;&#1082;&#1080;
&#1087;&#1088;&#1077;&#1088;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1085;&#1072; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;
&#1076;&#1080;&#1089;&#1087;&#1077;&#1090;&#1095;&#1077;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;
&#1080; &#1074;&#1099;&#1075;&#1088;&#1091;&#1079;&#1082;&#1080;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072; &#1080; &#1090;.&#1087;.<br>
<br>
<br>
<p><strong>&#1047;&#1072;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1077;</strong>
<p>&#1042;&#1086;&#1090; &#1084;&#1099;,
&#1085;&#1072;&#1082;&#1086;&#1085;&#1077;&#1094;, &#1080;
&#1088;&#1072;&#1079;&#1086;&#1073;&#1088;&#1072;&#1083;&#1080;
&#1086;&#1089;&#1085;&#1086;&#1074;&#1099;
&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
&#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1086;&#1074;
&#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;
&#1085;&#1072; &#1103;&#1079;&#1099;&#1082;&#1077;
&#1072;&#1089;&#1089;&#1077;&#1084;&#1073;&#1083;&#1077;&#1088;&#1072;.
&#1053;&#1072;&#1076;&#1077;&#1102;&#1089;&#1100;, &#1101;&#1090;&#1080;
&#1089;&#1090;&#1072;&#1090;&#1100;&#1080;
&#1087;&#1086;&#1084;&#1086;&#1075;&#1083;&#1080; &#1074;&#1072;&#1084;
&#1083;&#1077;&#1075;&#1082;&#1086; &quot;&#1074;&#1098;&#1077;&#1093;&#1072;&#1090;&#1100;
&#1074; &#1090;&#1077;&#1084;&#1091;&quot;. &#1047;&#1072;
&#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1081;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1077;&#1081;
&#1086;&#1073;&#1088;&#1072;&#1097;&#1072;&#1081;&#1090;&#1077;&#1089;&#1100;,
&#1087;&#1088;&#1077;&#1078;&#1076;&#1077; &#1074;&#1089;&#1077;&#1075;&#1086;,
&#1082; DDK, &#1082;&#1085;&#1080;&#1075;&#1077; Walter Oney &quot; Programming
the Microsoft Windows Driver Model&quot; &#1080;
&#1078;&#1091;&#1088;&#1085;&#1072;&#1083;&#1091; &quot;The NT Insider&quot; <a href="http://www.osr.com/"><u>http://www.osr.com/</u></a>.
<p>&#1042; <a href="http://wasm.ru/pub/21/files/kmd5.zip"><u>&#1072;&#1088;&#1093;&#1080;&#1074;&#1077;</u></a>
&#1082; &#1101;&#1090;&#1086;&#1081; &#1089;&#1090;&#1072;&#1090;&#1100;&#1077;
&#1074;&#1099;
&#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1080;&#1090;&#1077;:
<p>&nbsp;<!--mstheme--></font>
<table border="0">
  <tbody>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\include\</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077;
        &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1085;&#1099;&#1077;
        &#1074;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1084;&#1099;&#1077;
        &#1092;&#1072;&#1081;&#1083;&#1099;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\src\Article4-5\NtBuild</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1082;&#1086;&#1076;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
        &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1102;&#1097;&#1077;&#1075;&#1086;
        &#1085;&#1086;&#1084;&#1077;&#1088;
        &#1089;&#1073;&#1086;&#1088;&#1082;&#1080; (build number) &#1080;
        &#1074;&#1099;&#1087;&#1091;&#1089;&#1082;
        &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;.
        &#1044;&#1077;&#1084;&#1086;&#1085;&#1089;&#1090;&#1088;&#1080;&#1088;&#1091;&#1077;&#1090;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
        &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; ReadFile,
        &#1074;&#1080;&#1076;&#1072;
        &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;
        &#1073;&#1091;&#1092;&#1077;&#1088;&#1072;&#1084;&#1080; neither &#1080;
        &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;
        SEH;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\src\Article4-5\Skeleton</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1082;&#1072;&#1088;&#1082;&#1072;&#1089;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;
        &#1088;&#1077;&#1078;&#1080;&#1084;&#1072; &#1103;&#1076;&#1088;&#1072;;<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
    <tr>
      <td vAlign="top" width="200"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>\src\Article4-5\VirtToPhys</p>
        <!--mstheme--></font></td>
      <td vAlign="top"><!--mstheme--><font face="Arial, Arial, Helvetica">
        <p>- &#1082;&#1086;&#1076;
        &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086;
        &#1074; &#1076;&#1072;&#1085;&#1085;&#1086;&#1081;
        &#1089;&#1090;&#1072;&#1090;&#1100;&#1077;
        &#1076;&#1088;&#1072;&#1081;&#1074;&#1077;&#1088;&#1072;.<br>
        <br>
        </p>
        <!--mstheme--></font></td>
    </tr>
  </tbody>
</table>
<!--mstheme--><font face="Arial, Arial, Helvetica">
<p>&nbsp; [C] Four-F</p>
<!--mstheme--></font>

</body>

</html>
